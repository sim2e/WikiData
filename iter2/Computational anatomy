Computational anatomy is an interdisciplinary field of biology focused on quantitative investigation and modelling of anatomical shapes variability. It involves the development and application of mathematical, statistical and data-analytical methods for modelling and simulation of biological structures.
The field is broadly defined and includes foundations in anatomy, applied mathematics and pure mathematics, machine learning, computational mechanics, computational science, biological imaging, neuroscience, physics, probability, and statistics; it also has strong connections with fluid mechanics and geometric mechanics. Additionally, it complements newer, interdisciplinary fields like bioinformatics and neuroinformatics in the sense that its interpretation uses metadata derived from the original sensor imaging modalities (of which magnetic resonance imaging is one example). It focuses on the anatomical structures being imaged, rather than the medical imaging devices. It is similar in spirit to the history of computational linguistics, a discipline that focuses on the linguistic structures rather than the sensor acting as the transmission and communication media.
In computational anatomy, the diffeomorphism group is used to study different coordinate systems via coordinate transformations as generated via the Lagrangian and Eulerian velocities of flow in 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  . The flows between coordinates in computational anatomy are constrained to be geodesic flows satisfying the principle of least action for the Kinetic energy of the flow. The kinetic energy is defined through a Sobolev smoothness norm with strictly more than two generalized, square-integrable derivatives for each component of the flow velocity, which guarantees that the flows in 
  
    
      
        
          
            R
          
          
            3
          
        
      
    
    {\displaystyle \mathbb {R} ^{3}}
   are diffeomorphisms. 
It also implies that the diffeomorphic shape momentum taken pointwise satisfying the Euler-Lagrange equation for geodesics is determined by its neighbors through spatial derivatives on the velocity field.  This separates the discipline from the case of incompressible fluids for which momentum is a pointwise function of velocity. Computational anatomy intersects the study of Riemannian manifolds and nonlinear global analysis, where groups of diffeomorphisms are the central focus. Emerging high-dimensional theories of shape are central to many studies in computational anatomy, as are questions emerging from the fledgling field of shape statistics.
The metric structures in computational anatomy are related in spirit to morphometrics, with the distinction that Computational anatomy focuses on an infinite-dimensional space of coordinate systems transformed by a diffeomorphism, hence the central use of the terminology diffeomorphometry, the metric space study of coordinate systems via diffeomorphisms.

Genesis
At computational anatomy's heart is the comparison of shape by recognizing in one shape the other. This connects it to D'Arcy Wentworth Thompson's developments On Growth and Form which has led to scientific explanations of morphogenesis, the process by which patterns are formed in biology. Albrecht Durer's Four Books on Human Proportion were arguably the earliest works on computational anatomy. The efforts of Noam Chomsky in his pioneering of computational linguistics inspired the original formulation of computational anatomy as a generative model of shape and form from exemplars acted upon via transformations.Due to the availability of dense 3D measurements via technologies such as magnetic resonance imaging (MRI), computational anatomy has emerged as a subfield of medical imaging and bioengineering for extracting anatomical coordinate systems at the morphome scale in 3D. The spirit of this discipline shares strong overlap with areas such as computer vision and kinematics of rigid bodies, where objects are studied by analysing the groups responsible for the movement in question. Computational anatomy departs from computer vision with its focus on rigid motions, as the infinite-dimensional diffeomorphism group is central to the analysis of Biological shapes. It is a branch of the image analysis and pattern theory school at Brown University pioneered by Ulf Grenander. In Grenander's general metric pattern theory, making spaces of patterns into a metric space is one of the fundamental operations since being able to cluster and recognize anatomical configurations often requires a metric of close and far between shapes. The diffeomorphometry metric of computational anatomy measures how far two diffeomorphic changes of coordinates are from each other, which in turn induces a metric on the shapes and images indexed to them. The models of metric pattern theory, in particular group action on the orbit of shapes and forms is a central tool to the formal definitions in computational anatomy.

History
Computational anatomy is the study of shape and form at the morphome or gross anatomy millimeter, or morphology scale, focusing on the study of sub-manifolds of 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
        ,
      
    
    {\displaystyle {\mathbb {R} }^{3},}
   points, curves surfaces and subvolumes of human anatomy.
An early modern computational neuro-anatomist was David Van Essen performing some of the early physical unfoldings of the human brain based on printing of a human cortex and cutting. Jean Talairach's  publication of Talairach coordinates is an important milestone at the morphome scale demonstrating the fundamental basis of local coordinate systems in studying neuroanatomy and therefore the clear link to charts of differential geometry. Concurrently, virtual mapping in computational anatomy across high resolution dense image coordinates was already happening in Ruzena Bajcy's and Fred Bookstein's  earliest developments based on computed axial tomography and magnetic resonance imagery.
The earliest introduction of the use of flows of diffeomorphisms for transformation of coordinate systems in image analysis and medical imaging was by Christensen, Joshi, Miller, and Rabbitt.The first formalization of computational anatomy as an orbit of exemplar templates under diffeomorphism group action was in the original lecture given by Grenander and Miller with that title in May 1997 at the 50th Anniversary of the Division of Applied Mathematics at Brown University, and subsequent publication. This was the basis for the strong departure from much of the previous work on advanced methods for spatial normalization and image registration which were historically built on notions of addition and basis expansion. The structure preserving transformations central to the modern field of Computational Anatomy, homeomorphisms and diffeomorphisms carry smooth submanifolds smoothly. They are generated via Lagrangian and Eulerian flows which satisfy a law of composition of functions forming the group property, but are not additive.
The original model of computational anatomy was as the triple, 
  
    
      
        (
        
          
            G
          
        
        ,
        
          
            M
          
        
        ,
        
          
            P
          
        
        )
         
        ,
      
    
    {\displaystyle ({\mathcal {G}},{\mathcal {M}},{\mathcal {P}})\ ,}
   the group  
  
    
      
        g
        ∈
        
          
            G
          
        
      
    
    {\displaystyle g\in {\mathcal {G}}}
  , the orbit of shapes and forms 
  
    
      
        m
        ∈
        
          
            M
          
        
      
    
    {\displaystyle m\in {\mathcal {M}}}
  , and the probability laws 
  
    
      
        P
      
    
    {\displaystyle P}
   which encode the variations of the objects in the orbit. The template or collection of templates are elements in the orbit 
  
    
      
        
          m
          
            
              t
              e
              m
              p
            
          
        
        ∈
        
          
            M
          
        
      
    
    {\displaystyle m_{\mathrm {temp} }\in {\mathcal {M}}}
   of shapes.
The Lagrangian and Hamiltonian formulations of the equations of motion of computational anatomy took off post 1997 with several pivotal meetings including the 1997 Luminy meeting organized by the Azencott school at Ecole-Normale Cachan on the "Mathematics of Shape Recognition" and the 1998 Trimestre at Institute Henri Poincaré organized by David Mumford "Questions Mathématiques en Traitement du Signal et de l'Image"  which catalyzed the Hopkins-Brown-ENS Cachan groups and subsequent developments and connections of computational anatomy to developments in global analysis.
The developments in computational anatomy included the establishment of the Sobolev smoothness conditions on the diffeomorphometry metric to insure existence of solutions of variational problems in the space of diffeomorphisms, the derivation of the Euler-Lagrange equations characterizing geodesics through the group and associated conservation laws, the demonstration of the metric properties of the right invariant metric, the demonstration that the Euler-Lagrange equations have a well-posed initial value problem with unique solutions for all time, and with the first results on sectional curvatures for the diffeomorphometry metric in landmarked spaces. Following the Los Alamos meeting in 2002, Joshi's original large deformation singular Landmark solutions in computational anatomy were connected to peaked solitons or peakons as solutions for the Camassa-Holm equation. Subsequently, connections were made between computational anatomy's Euler-Lagrange equations for momentum densities for the right-invariant metric satisfying Sobolev smoothness to Vladimir Arnold's characterization of the Euler equation for incompressible flows as describing geodesics in the group of volume preserving diffeomorphisms. The first algorithms, generally termed LDDMM for large deformation diffeomorphic mapping for computing connections between landmarks in volumes and spherical manifolds, curves, currents and surfaces, volumes, tensors, varifolds, and time-series have followed.
These contributions of computational anatomy to the global analysis associated to the infinite dimensional manifolds of subgroups of the diffeomorphism group is far from trivial. The original idea of doing differential geometry, curvature and geodesics on infinite dimensional manifolds goes back to Bernhard Riemann's Habilitation (Ueber die Hypothesen, welche der Geometrie zu Grunde liegen); the key modern book laying the foundations of such ideas in global analysis are from Michor.The applications within medical imaging of computational anatomy continued to flourish after two organized meetings at the Institute for Pure and Applied Mathematics conferences at University of California, Los Angeles. Computational anatomy has been useful in creating accurate models of the atrophy of the human brain at the morphome scale,  as well as Cardiac templates, as well as in modeling biological systems. Since the late 1990s, computational anatomy has become an important part of developing emerging technologies for the field of medical imaging. Digital atlases are a fundamental part of modern Medical-school education and in neuroimaging research at the morphome scale. Atlas based methods and virtual textbooks which accommodate variations as in deformable templates are at the center of many neuro-image analysis platforms including Freesurfer, FSL, MRIStudio, SPM. Diffeomorphic registration, introduced in the 1990s, is now an important player with existing codes bases organized around ANTS, DARTEL, DEMONS, LDDMM, StationaryLDDMM, FastLDDMM, are examples of actively used computational codes for constructing correspondences between coordinate systems based on sparse features and dense images. Voxel-based morphometry is an important technology built on many of these principles.

The deformable template orbit model of computational anatomy
The model of human anatomy is a deformable template, an orbit of exemplars under group action. Deformable template models have been central to Grenander's metric pattern theory, accounting for typicality via templates, and accounting for variability via transformation of the template. An orbit under group action as the representation of the deformable template is a classic formulation from differential geometry.  The space of shapes are denoted 
  
    
      
        m
        ∈
        
          
            M
          
        
      
    
    {\displaystyle m\in {\mathcal {M}}}
  , with the group  
  
    
      
        (
        
          
            G
          
        
        ,
        ∘
        )
      
    
    {\displaystyle ({\mathcal {G}},\circ )}
   with law of composition 
  
    
      
        ∘
      
    
    {\displaystyle \circ }
  ; the action of the group on shapes is denoted 
  
    
      
        g
        ⋅
        m
      
    
    {\displaystyle g\cdot m}
  , where the action of the group 
  
    
      
        g
        ⋅
        m
        ∈
        
          
            M
          
        
        ,
        m
        ∈
        
          
            M
          
        
      
    
    {\displaystyle g\cdot m\in {\mathcal {M}},m\in {\mathcal {M}}}
   is defined to satisfy 

  
    
      
        (
        g
        ∘
        
          g
          
            ′
          
        
        )
        ⋅
        m
        =
        g
        ⋅
        (
        
          g
          
            ′
          
        
        ⋅
        m
        )
        ∈
        
          
            M
          
        
        .
      
    
    {\displaystyle (g\circ g^{\prime })\cdot m=g\cdot (g^{\prime }\cdot m)\in {\mathcal {M}}.}
  The orbit 
  
    
      
        
          
            M
          
        
      
    
    {\displaystyle {\mathcal {M}}}
   of the template becomes the space of all shapes, 
  
    
      
        
          
            M
          
        
        ≐
        {
        m
        =
        g
        ⋅
        
          m
          
            
              t
              e
              m
              p
            
          
        
        ,
        g
        ∈
        
          
            G
          
        
        }
      
    
    {\displaystyle {\mathcal {M}}\doteq \{m=g\cdot m_{\mathrm {temp} },g\in {\mathcal {G}}\}}
  , being homogenous under the action of the elements of 
  
    
      
        
          
            G
          
        
      
    
    {\displaystyle {\mathcal {G}}}
  .

The orbit model of computational anatomy is an abstract algebra - to be compared to linear algebra - since the groups act nonlinearly on the shapes. This is a generalization of the classical models of linear algebra, in which the set of finite dimensional 
  
    
      
        
          
            
              R
            
          
          
            n
          
        
      
    
    {\displaystyle {\mathbb {R} }^{n}}
   vectors are replaced by the finite-dimensional anatomical submanifolds (points, curves, surfaces and volumes) and images of them, and the 
  
    
      
        n
        ×
        n
      
    
    {\displaystyle n\times n}
   matrices of linear algebra are replaced by coordinate transformations based on linear and affine groups and the more general high-dimensional diffeomorphism groups.

Shapes and forms
The central objects are shapes or forms in computational anatomy, one set of examples being the 0,1,2,3-dimensional submanifolds of 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  , a second set of examples being images generated via medical imaging such as via magnetic resonance imaging (MRI) and functional magnetic resonance imaging.  The 0-dimensional manifolds are landmarks or fiducial points; 1-dimensional manifolds are curves such as sulcal and gyral curves in the brain; 2-dimensional manifolds correspond to boundaries of substructures in anatomy such as the subcortical structures of the midbrain or the gyral surface of the neocortex;  subvolumes correspond to subregions of the human body, the heart, the thalamus, the kidney.
The landmarks 
  
    
      
        X
        ≐
        {
        
          x
          
            1
          
        
        ,
        …
        ,
        
          x
          
            n
          
        
        }
        ⊂
        
          
            
              R
            
          
          
            3
          
        
        ∈
        
          
            M
          
        
      
    
    {\displaystyle X\doteq \{x_{1},\dots ,x_{n}\}\subset {\mathbb {R} }^{3}\in {\mathcal {M}}}
   are a collections of points with no other structure, delineating important fiducials within human shape and form (see associated landmarked image).
The sub-manifold shapes such as surfaces 
  
    
      
        X
        ⊂
        
          
            
              R
            
          
          
            3
          
        
        ∈
        
          
            M
          
        
      
    
    {\displaystyle X\subset {\mathbb {R} }^{3}\in {\mathcal {M}}}
   are collections of points modeled as parametrized by a local chart or immersion 
  
    
      
        m
        :
        U
        ⊂
        
          
            
              R
            
          
          
            1
            ,
            2
          
        
        →
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle m:U\subset {\mathbb {R} }^{1,2}\rightarrow {\mathbb {R} }^{3}}
  , 
  
    
      
        m
        (
        u
        )
        ,
        u
        ∈
        U
      
    
    {\displaystyle m(u),u\in U}
   (see Figure showing shapes as mesh surfaces).
The images such as MR images or DTI images 
  
    
      
        I
        ∈
        
          
            M
          
        
      
    
    {\displaystyle I\in {\mathcal {M}}}
  , and are dense functions

  
    
      
        I
        (
        x
        )
        ,
        x
        ∈
        X
        ⊂
        
          
            
              R
            
          
          
            1
            ,
            2
            ,
            3
          
        
      
    
    {\displaystyle I(x),x\in X\subset {\mathbb {R} }^{1,2,3}}
   are scalars, vectors, and matrices (see Figure showing scalar image).

Groups and group actions
Groups and group actions are familiar to the Engineering community with the universal popularization and standardization of linear algebra as a basic model for analyzing signals and systems in mechanical engineering, electrical engineering and applied mathematics. In linear algebra the matrix groups (matrices with inverses) are the central structure, with group action defined by the usual definition of 
  
    
      
        A
      
    
    {\displaystyle A}
   as an 
  
    
      
        n
        ×
        n
      
    
    {\displaystyle n\times n}
   matrix, acting on 
  
    
      
        x
        ∈
        
          
            
              R
            
          
          
            n
          
        
      
    
    {\displaystyle x\in {\mathbb {R} }^{n}}
   as 
  
    
      
        n
        ×
        1
      
    
    {\displaystyle n\times 1}
    vectors; the orbit in linear-algebra is the set of 
  
    
      
        n
      
    
    {\displaystyle n}
  -vectors given by 
  
    
      
        y
        =
        A
        ⋅
        x
        ∈
        
          
            
              R
            
          
          
            n
          
        
      
    
    {\displaystyle y=A\cdot x\in {\mathbb {R} }^{n}}
  , which is a group action of the matrices through the orbit of 
  
    
      
        
          
            
              R
            
          
          
            n
          
        
      
    
    {\displaystyle {\mathbb {R} }^{n}}
  .
The central group in computational anatomy defined on volumes in  
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
   are the diffeomorphisms 
  
    
      
        
          
            G
          
        
        ≐
        D
        i
        f
        f
      
    
    {\displaystyle {\mathcal {G}}\doteq Diff}
   which are mappings with 3-components 
  
    
      
        ϕ
        (
        ⋅
        )
        =
        (
        
          ϕ
          
            1
          
        
        (
        ⋅
        )
        ,
        
          ϕ
          
            2
          
        
        (
        ⋅
        )
        ,
        
          ϕ
          
            3
          
        
        (
        ⋅
        )
        )
      
    
    {\displaystyle \phi (\cdot )=(\phi _{1}(\cdot ),\phi _{2}(\cdot ),\phi _{3}(\cdot ))}
  , law of composition of functions 
  
    
      
        ϕ
        ∘
        
          ϕ
          
            ′
          
        
        (
        ⋅
        )
        ≐
        ϕ
        (
        
          ϕ
          
            ′
          
        
        (
        ⋅
        )
        )
      
    
    {\displaystyle \phi \circ \phi ^{\prime }(\cdot )\doteq \phi (\phi ^{\prime }(\cdot ))}
  , with inverse 
  
    
      
        ϕ
        ∘
        
          ϕ
          
            −
            1
          
        
        (
        ⋅
        )
        =
        ϕ
        (
        
          ϕ
          
            −
            1
          
        
        (
        ⋅
        )
        )
        =
        i
        d
      
    
    {\displaystyle \phi \circ \phi ^{-1}(\cdot )=\phi (\phi ^{-1}(\cdot ))=id}
  .
Most popular are scalar images, 
  
    
      
        I
        (
        x
        )
        ,
        x
        ∈
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle I(x),x\in {\mathbb {R} }^{3}}
  , with action on the right via the inverse.

  
    
      
        ϕ
        ⋅
        I
        (
        x
        )
        =
        I
        ∘
        
          ϕ
          
            −
            1
          
        
        (
        x
        )
        ,
        x
        ∈
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle \phi \cdot I(x)=I\circ \phi ^{-1}(x),x\in {\mathbb {R} }^{3}}
  .For sub-manifolds 
  
    
      
        X
        ⊂
        
          
            
              R
            
          
          
            3
          
        
        ∈
        
          
            M
          
        
      
    
    {\displaystyle X\subset {\mathbb {R} }^{3}\in {\mathcal {M}}}
  , parametrized by a chart or immersion 
  
    
      
        m
        (
        u
        )
        ,
        u
        ∈
        U
      
    
    {\displaystyle m(u),u\in U}
  , the diffeomorphic action the flow of the position

  
    
      
        ϕ
        ⋅
        m
        (
        u
        )
        ≐
        ϕ
        ∘
        m
        (
        u
        )
        ,
        u
        ∈
        U
      
    
    {\displaystyle \phi \cdot m(u)\doteq \phi \circ m(u),u\in U}
  .Several group actions in computational anatomy have been defined.

Lagrangian and Eulerian flows for generating diffeomorphisms
For the study of rigid body kinematics, the low-dimensional matrix Lie groups have been the central focus. The matrix groups are low-dimensional mappings, which are diffeomorphisms that provide one-to-one correspondences between coordinate systems, with a smooth inverse. The matrix group of rotations and scales can be generated via a closed form finite-dimensional matrices which are solution of simple ordinary differential equations with solutions given by the matrix exponential.

For the study of deformable shape in computational anatomy, a more general diffeomorphism group has been the group of choice, which is the infinite dimensional analogue. The high-dimensional diffeomorphism groups used in Computational Anatomy are generated via smooth flows  
  
    
      
        
          ϕ
          
            t
          
        
        ,
        t
        ∈
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle \phi _{t},t\in [0,1]}
   which satisfy the Lagrangian and Eulerian specification of the flow fields as first introduced in., satisfying the ordinary differential equation:with 
  
    
      
        v
        ≐
        (
        
          v
          
            1
          
        
        ,
        
          v
          
            2
          
        
        ,
        
          v
          
            3
          
        
        )
      
    
    {\displaystyle v\doteq (v_{1},v_{2},v_{3})}
   the vector fields on 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
   termed the Eulerian velocity of the particles at position 
  
    
      
        ϕ
      
    
    {\displaystyle \phi }
   of the flow. The vector fields are functions in a function space, modelled as a smooth Hilbert space of high-dimension, with the Jacobian of the flow 
  
    
      
         
        D
        ϕ
        ≐
        (
        
          
            
              ∂
              
                ϕ
                
                  i
                
              
            
            
              ∂
              
                x
                
                  j
                
              
            
          
        
        )
      
    
    {\displaystyle \ D\phi \doteq ({\frac {\partial \phi _{i}}{\partial x_{j}}})}
   a high-dimensional field in a function space as well, rather than a low-dimensional matrix as in the matrix groups. Flows were first introduced for large deformations in image matching; 
  
    
      
        
          
            
              
                ϕ
                ˙
              
            
          
          
            t
          
        
        (
        x
        )
      
    
    {\displaystyle {\dot {\phi }}_{t}(x)}
   is the instantaneous velocity of particle 
  
    
      
        x
      
    
    {\displaystyle x}
   at time 
  
    
      
        t
      
    
    {\displaystyle t}
   .
The inverse  
  
    
      
        
          ϕ
          
            t
          
          
            −
            1
          
        
        ,
        t
        ∈
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle \phi _{t}^{-1},t\in [0,1]}
   required for the group is defined on the Eulerian vector-field with advective inverse flow

The diffeomorphism group of computational anatomy
The group of diffeomorphisms is very big. To ensure smooth flows of diffeomorphisms avoiding shock-like solutions for the inverse,  the vector fields must be at least 1-time continuously differentiable in space. For diffeomorphisms on 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  , vector fields are modelled as elements of the Hilbert space  
  
    
      
        (
        V
        ,
        ‖
        ⋅
        
          ‖
          
            V
          
        
        )
      
    
    {\displaystyle (V,\|\cdot \|_{V})}
   using the Sobolev embedding theorems so that each element  has strictly greater than 2 generalized square-integrable spatial derivatives (thus 
  
    
      
        
          v
          
            i
          
        
        ∈
        
          H
          
            0
          
          
            3
          
        
        ,
        i
        =
        1
        ,
        2
        ,
        3
        ,
      
    
    {\displaystyle v_{i}\in H_{0}^{3},i=1,2,3,}
   is sufficient), yielding 1-time continuously differentiable functions.
The diffeomorphism group are flows with vector fields absolutely integrable in Sobolev norm:
where

  
    
      
        ‖
        v
        
          ‖
          
            V
          
          
            2
          
        
        ≐
        
          ∫
          
            X
          
        
        A
        v
        ⋅
        v
        d
        x
        ,
         
        v
        ∈
        V
         
        ,
      
    
    {\displaystyle \|v\|_{V}^{2}\doteq \int _{X}Av\cdot vdx,\ v\in V\ ,}
   
with the linear operator 
  
    
      
        A
      
    
    {\displaystyle A}
   mapping to the dual space 
  
    
      
        A
        :
        V
        ↦
        
          V
          
            ∗
          
        
      
    
    {\displaystyle A:V\mapsto V^{*}}
  , with the integral calculated by integration by parts when 
  
    
      
        A
        v
        ∈
        
          V
          
            ∗
          
        
      
    
    {\displaystyle Av\in V^{*}}
   is a generalized function  in the dual space.

Diffeomorphometry: The metric space of shapes and forms
The study of metrics on groups of diffeomorphisms and the study of metrics between manifolds and surfaces has been an area of significant investigation. The diffeomorphometry metric measures how close and far two shapes or images are from each other; the metric length is the shortest length of the flow which carries one coordinate system into the other.
Oftentimes, the familiar Euclidean metric is not directly applicable because the patterns of shapes and images do not form a vector space. In the Riemannian orbit model of computational anatomy, diffeomorphisms acting on the forms 
  
    
      
        ϕ
        ⋅
        m
        ∈
        
          
            M
          
        
        ,
        ϕ
        ∈
        D
        i
        f
        
          f
          
            V
          
        
        ,
        m
        ∈
        
          
            M
          
        
      
    
    {\displaystyle \phi \cdot m\in {\mathcal {M}},\phi \in Diff_{V},m\in {\mathcal {M}}}
   do not act linearly. There are many ways to define metrics, and for the sets associated to shapes the Hausdorff metric is another. The method we use to induce the Riemannian metric is used to induce the metric on the orbit of shapes by defining it in terms of the metric length between diffeomorphic coordinate system transformations of the flows. Measuring the lengths of the geodesic flow between coordinates systems in the orbit of shapes is called diffeomorphometry.

The right-invariant metric on diffeomorphisms
Define the distance on the group of diffeomorphisms   

this is the right-invariant metric of diffeomorphometry, invariant to reparameterization of space since for all 
  
    
      
        ϕ
        ∈
        D
        i
        f
        
          f
          
            V
          
        
      
    
    {\displaystyle \phi \in Diff_{V}}
  , 

  
    
      
        
          d
          
            D
            i
            f
            
              f
              
                V
              
            
          
        
        (
        ψ
        ,
        φ
        )
        =
        
          d
          
            D
            i
            f
            
              f
              
                V
              
            
          
        
        (
        ψ
        ∘
        ϕ
        ,
        φ
        ∘
        ϕ
        )
      
    
    {\displaystyle d_{Diff_{V}}(\psi ,\varphi )=d_{Diff_{V}}(\psi \circ \phi ,\varphi \circ \phi )}
  .

The metric on shapes and forms
The distance on shapes and forms,
  
    
      
        
          d
          
            
              M
            
          
        
        :
        
          
            M
          
        
        ×
        
          
            M
          
        
        →
        
          
            R
          
          
            +
          
        
      
    
    {\displaystyle d_{\mathcal {M}}:{\mathcal {M}}\times {\mathcal {M}}\rightarrow \mathbb {R} ^{+}}
  , 

the images  are denoted with the orbit as  
  
    
      
        I
        ∈
        
          
            I
          
        
      
    
    {\displaystyle I\in {\mathcal {I}}}
   and metric 
  
    
      
        ,
        
          d
          
            
              I
            
          
        
      
    
    {\displaystyle ,d_{\mathcal {I}}}
  .

The action integral for Hamilton's principle on diffeomorphic flows
In classical mechanics the evolution of physical systems is described by solutions to the Euler–Lagrange equations associated to the Least-action principle of Hamilton. This is a standard way, for example of obtaining Newton's laws of motion of free particles. More generally, the Euler-Lagrange equations can be derived for systems of generalized coordinates. The Euler-Lagrange equation in computational anatomy describes the geodesic shortest path flows between coordinate systems of the diffeomorphism metric. In computational anatomy the generalized coordinates are the flow of the diffeomorphism and its Lagrangian velocity 
  
    
      
        ϕ
        ,
        
          
            
              ϕ
              ˙
            
          
        
      
    
    {\displaystyle \phi ,{\dot {\phi }}}
  , the two related via the Eulerian velocity 
  
    
      
        v
        ≐
        
          
            
              ϕ
              ˙
            
          
        
        ∘
        
          ϕ
          
            −
            1
          
        
      
    
    {\displaystyle v\doteq {\dot {\phi }}\circ \phi ^{-1}}
  . 
Hamilton's principle for generating the Euler-Lagrange equation requires the action integral on the Lagrangian given by 

the Lagrangian is given by the kinetic energy:

Diffeomorphic or Eulerian shape momentum
In computational anatomy, 
  
    
      
        A
        v
      
    
    {\displaystyle Av}
   was first called the Eulerian or diffeomorphic shape momentum  since when integrated against Eulerian velocity 
  
    
      
        v
      
    
    {\displaystyle v}
   gives energy density, and since there is a conservation of diffeomorphic shape momentum which holds. The operator 
  
    
      
        A
      
    
    {\displaystyle A}
   is the generalized moment of inertia or inertial operator.

The Euler–Lagrange equation on shape momentum for geodesics on the group of diffeomorphisms
Classical calculation of the Euler-Lagrange equation from Hamilton's principle requires the perturbation of the Lagrangian on the vector field in the kinetic energy with respect to first order perturbation of the flow. This requires adjustment by the Lie bracket of vector field, given by operator 
  
    
      
        a
        
          d
          
            v
          
        
        :
        w
        ∈
        V
        ↦
        V
      
    
    {\displaystyle ad_{v}:w\in V\mapsto V}
    which involves the Jacobian given by 

  
    
      
        a
        
          d
          
            v
          
        
        [
        w
        ]
        ≐
        [
        v
        ,
        w
        ]
        ≐
        (
        D
        v
        )
        w
        −
        (
        D
        w
        )
        v
        ∈
        V
      
    
    {\displaystyle ad_{v}[w]\doteq [v,w]\doteq (Dv)w-(Dw)v\in V}
  .Defining the adjoint 
  
    
      
        a
        
          d
          
            v
          
          
            ∗
          
        
        :
        
          V
          
            ∗
          
        
        →
        
          V
          
            ∗
          
        
        ,
      
    
    {\displaystyle ad_{v}^{*}:V^{*}\rightarrow V^{*},}
   then the first order variation gives the Eulerian shape momentum 
  
    
      
        A
        v
        ∈
        
          V
          
            ∗
          
        
      
    
    {\displaystyle Av\in V^{*}}
   satisfying the generalized equation:

meaning for all smooth 
  
    
      
        w
        ∈
        V
        ,
      
    
    {\displaystyle w\in V,}
  

  
    
      
        
          ∫
          
            X
          
        
        
          (
          
            
              
                d
                
                  d
                  t
                
              
            
            A
            
              v
              
                t
              
            
            +
            a
            
              d
              
                
                  v
                  
                    t
                  
                
              
              
                ∗
              
            
            (
            A
            
              v
              
                t
              
            
            )
          
          )
        
        ⋅
        w
        d
        x
        =
        
          ∫
          
            X
          
        
        
          
            d
            
              d
              t
            
          
        
        A
        
          v
          
            t
          
        
        ⋅
        w
        d
        x
        +
        
          ∫
          
            X
          
        
        A
        
          v
          
            t
          
        
        ⋅
        (
        (
        D
        
          v
          
            t
          
        
        )
        w
        −
        (
        D
        w
        )
        
          v
          
            t
          
        
        )
        d
        x
        =
        0.
      
    
    {\displaystyle \int _{X}\left({\frac {d}{dt}}Av_{t}+ad_{v_{t}}^{*}(Av_{t})\right)\cdot wdx=\int _{X}{\frac {d}{dt}}Av_{t}\cdot wdx+\int _{X}Av_{t}\cdot ((Dv_{t})w-(Dw)v_{t})dx=0.}
  Computational anatomy is the study of the motions of submanifolds, points, curves, surfaces and volumes.
Momentum associated to points, curves and surfaces are all singular, implying the momentum is concentrated on subsets of 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
   which are dimension 
  
    
      
        ≤
        2
      
    
    {\displaystyle \leq 2}
   in Lebesgue measure. In such cases, the energy is still well defined 
  
    
      
        (
        A
        
          v
          
            t
          
        
        ∣
        
          v
          
            t
          
        
        )
      
    
    {\displaystyle (Av_{t}\mid v_{t})}
   since although 
  
    
      
        A
        
          v
          
            t
          
        
      
    
    {\displaystyle Av_{t}}
   is a generalized function, the vector fields are smooth and the Eulerian momentum is understood via its action on smooth functions. The perfect illustration of this is even when it is a superposition of delta-diracs, the velocity of the coordinates in the entire volume move smoothly. The Euler-Lagrange equation (EL-General) on diffeomorphisms for generalized functions 
  
    
      
        A
        v
        ∈
        
          V
          
            ∗
          
        
      
    
    {\displaystyle Av\in V^{*}}
   was derived in. In Riemannian Metric and Lie-Bracket Interpretation of the Euler-Lagrange Equation on Geodesics derivations are provided in terms of the adjoint operator and the Lie bracket for the group of diffeomorphisms. It has come to be called EPDiff equation for diffeomorphisms connecting to the Euler-Poincare method having been studied in the context of the inertial operator 
  
    
      
        A
        =
        i
        d
        e
        n
        t
        i
        t
        y
      
    
    {\displaystyle A=identity}
    for incompressible, divergence free, fluids.

Diffeomorphic shape momentum: a classical vector function
For the momentum density case 
  
    
      
        (
        A
        
          v
          
            t
          
        
        ∣
        w
        )
        =
        
          ∫
          
            X
          
        
        
          μ
          
            t
          
        
        ⋅
        w
        
        d
        x
      
    
    {\displaystyle (Av_{t}\mid w)=\int _{X}\mu _{t}\cdot w\,dx}
  , then Euler–Lagrange equation has a classical solution:
The Euler-Lagrange equation on diffeomorphisms, classically defined for momentum densities first appeared in for medical image analysis.

Riemannian exponential (geodesic positioning) and Riemannian logarithm (geodesic coordinates)
In medical imaging and computational anatomy, positioning and coordinatizing shapes are fundamental operations; the system for positioning anatomical coordinates and shapes built on the metric and the Euler-Lagrange equation a geodesic positioning system as first explicated in Miller Trouve and Younes.
Solving the geodesic from the initial condition 
  
    
      
        
          v
          
            0
          
        
      
    
    {\displaystyle v_{0}}
   is termed the Riemannian-exponential, a mapping 
  
    
      
        E
        x
        
          p
          
            
              i
              d
            
          
        
        (
        ⋅
        )
        :
        V
        →
        D
        i
        f
        
          f
          
            V
          
        
      
    
    {\displaystyle Exp_{\rm {id}}(\cdot ):V\to Diff_{V}}
   at identity to the group.
The Riemannian exponential satisfies 
  
    
      
        E
        x
        
          p
          
            i
            d
          
        
        (
        
          v
          
            0
          
        
        )
        =
        
          ϕ
          
            1
          
        
      
    
    {\displaystyle Exp_{id}(v_{0})=\phi _{1}}
   for initial condition 
  
    
      
        
          
            
              
                ϕ
                ˙
              
            
          
          
            0
          
        
        =
        
          v
          
            0
          
        
      
    
    {\displaystyle {\dot {\phi }}_{0}=v_{0}}
  , vector field dynamics 
  
    
      
        
          
            
              
                ϕ
                ˙
              
            
          
          
            t
          
        
        =
        
          v
          
            t
          
        
        ∘
        
          ϕ
          
            t
          
        
        ,
        t
        ∈
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle {\dot {\phi }}_{t}=v_{t}\circ \phi _{t},t\in [0,1]}
  ,

for classical equation diffeomorphic shape momentum 
  
    
      
        
          ∫
          
            X
          
        
        A
        
          v
          
            t
          
        
        ⋅
        w
        
        d
        x
      
    
    {\displaystyle \int _{X}Av_{t}\cdot w\,dx}
  , 
  
    
      
        A
        v
        ∈
        V
      
    
    {\displaystyle Av\in V}
  , then
  
    
      
         
         
         
        
          
            d
            
              d
              t
            
          
        
        A
        
          v
          
            t
          
        
        +
        (
        D
        
          v
          
            t
          
        
        
          )
          
            T
          
        
        A
        
          v
          
            t
          
        
        +
        (
        D
        A
        
          v
          
            t
          
        
        )
        
          v
          
            t
          
        
        +
        (
        ∇
        ⋅
        v
        )
        A
        
          v
          
            t
          
        
        =
        0
         
        ;
      
    
    {\displaystyle \ \ \ {\frac {d}{dt}}Av_{t}+(Dv_{t})^{T}Av_{t}+(DAv_{t})v_{t}+(\nabla \cdot v)Av_{t}=0\ ;}
  for generalized equation, then 
  
    
      
        A
        v
        ∈
        
          V
          
            ∗
          
        
      
    
    {\displaystyle Av\in V^{*}}
  ,
  
    
      
        w
        ∈
        V
      
    
    {\displaystyle w\in V}
  ,
  
    
      
         
         
         
        
          ∫
          
            X
          
        
        
          
            d
            
              d
              t
            
          
        
        A
        
          v
          
            t
          
        
        ⋅
        w
        d
        x
        +
        
          ∫
          
            X
          
        
        A
        
          v
          
            t
          
        
        ⋅
        (
        (
        D
        
          v
          
            t
          
        
        )
        w
        −
        (
        D
        w
        )
        
          v
          
            t
          
        
        )
        d
        x
        =
        0.
      
    
    {\displaystyle \ \ \ \int _{X}{\frac {d}{dt}}Av_{t}\cdot wdx+\int _{X}Av_{t}\cdot ((Dv_{t})w-(Dw)v_{t})dx=0.}
  Computing the flow 
  
    
      
        
          v
          
            0
          
        
      
    
    {\displaystyle v_{0}}
    onto coordinates Riemannian logarithm, mapping 
  
    
      
        L
        o
        
          g
          
            
              i
              d
            
          
        
        (
        ⋅
        )
        :
        D
        i
        f
        
          f
          
            V
          
        
        →
        V
      
    
    {\displaystyle Log_{\rm {id}}(\cdot ):Diff_{V}\to V}
   at identity from 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
   to vector field 
  
    
      
        
          v
          
            0
          
        
        ∈
        V
      
    
    {\displaystyle v_{0}\in V}
  ;

  
    
      
        L
        o
        
          g
          
            i
            d
          
        
        (
        φ
        )
        =
        
          v
          
            0
          
        
         
        
          initial condition of EL geodesic 
        
        
          
            
              
                ϕ
                ˙
              
            
          
          
            0
          
        
        =
        
          v
          
            0
          
        
        ,
        
          ϕ
          
            0
          
        
        =
        i
        d
        ,
        
          ϕ
          
            1
          
        
        =
        φ
         
        .
      
    
    {\displaystyle Log_{id}(\varphi )=v_{0}\ {\text{initial condition of EL geodesic }}{\dot {\phi }}_{0}=v_{0},\phi _{0}=id,\phi _{1}=\varphi \ .}
  
Extended to the entire group they become

  
    
      
        ϕ
        =
        E
        x
        
          p
          
            φ
          
        
        (
        
          v
          
            0
          
        
        ∘
        φ
        )
        ≐
        E
        x
        
          p
          
            i
            d
          
        
        (
        
          v
          
            0
          
        
        )
        ∘
        φ
      
    
    {\displaystyle \phi =Exp_{\varphi }(v_{0}\circ \varphi )\doteq Exp_{id}(v_{0})\circ \varphi }
   ;   
  
    
      
        L
        o
        
          g
          
            φ
          
        
        (
        ϕ
        )
        ≐
        L
        o
        
          g
          
            i
            d
          
        
        (
        ϕ
        ∘
        
          φ
          
            −
            1
          
        
        )
        ∘
        φ
      
    
    {\displaystyle Log_{\varphi }(\phi )\doteq Log_{id}(\phi \circ \varphi ^{-1})\circ \varphi }
   .
These are inverses of each other for unique solutions of Logarithm; the first is called geodesic positioning, the latter geodesic coordinates (see exponential map, Riemannian geometry for the finite dimensional version).The geodesic metric is a local flattening of the Riemannian coordinate system (see figure).

Hamiltonian formulation of computational anatomy
In computational anatomy the diffeomorphisms are used to push the coordinate systems, and the vector fields are used
as the control within the
anatomical orbit or morphological space. The model is that of a dynamical system, the flow of coordinates 
  
    
      
        t
        ↦
        
          ϕ
          
            t
          
        
        ∈
        
          Diff
          
            V
          
        
      
    
    {\displaystyle t\mapsto \phi _{t}\in \operatorname {Diff} _{V}}
   and the control the vector field 
  
    
      
        t
        ↦
        
          v
          
            t
          
        
        ∈
        V
      
    
    {\displaystyle t\mapsto v_{t}\in V}
   related via 
  
    
      
        
          
            
              
                ϕ
                ˙
              
            
          
          
            t
          
        
        =
        
          v
          
            t
          
        
        ⋅
        
          ϕ
          
            t
          
        
        ,
        
          ϕ
          
            0
          
        
        =
        i
        d
        .
      
    
    {\displaystyle {\dot {\phi }}_{t}=v_{t}\cdot \phi _{t},\phi _{0}=id.}
    The Hamiltonian view
 reparameterizes the momentum distribution 
  
    
      
        A
        v
        ∈
        
          V
          
            ∗
          
        
      
    
    {\displaystyle Av\in V^{*}}
   in terms of the conjugate momentum or canonical momentum, introduced as a Lagrange multiplier 
  
    
      
        p
        :
        
          
            
              ϕ
              ˙
            
          
        
        ↦
        (
        p
        ∣
        
          
            
              ϕ
              ˙
            
          
        
        )
      
    
    {\displaystyle p:{\dot {\phi }}\mapsto (p\mid {\dot {\phi }})}
   constraining the Lagrangian velocity 
  
    
      
        
          
            
              
                ϕ
                ˙
              
            
          
          
            t
          
        
        =
        
          v
          
            t
          
        
        ∘
        
          ϕ
          
            t
          
        
      
    
    {\displaystyle {\dot {\phi }}_{t}=v_{t}\circ \phi _{t}}
  .accordingly:

  
    
      
        H
        (
        
          ϕ
          
            t
          
        
        ,
        
          p
          
            t
          
        
        ,
        
          v
          
            t
          
        
        )
        =
        
          ∫
          
            X
          
        
        
          p
          
            t
          
        
        ⋅
        (
        
          v
          
            t
          
        
        ∘
        
          ϕ
          
            t
          
        
        )
        d
        x
        −
        
          
            1
            2
          
        
        
          ∫
          
            X
          
        
        A
        
          v
          
            t
          
        
        ⋅
        
          v
          
            t
          
        
        d
        x
        .
      
    
    {\displaystyle H(\phi _{t},p_{t},v_{t})=\int _{X}p_{t}\cdot (v_{t}\circ \phi _{t})dx-{\frac {1}{2}}\int _{X}Av_{t}\cdot v_{t}dx.}
  This function is the extended Hamiltonian. The Pontryagin maximum principle gives the optimizing vector field which determines the geodesic flow satisfying 
  
    
      
        
          
            
              
                ϕ
                ˙
              
            
          
          
            t
          
        
        =
        
          v
          
            t
          
        
        ∘
        
          ϕ
          
            t
          
        
        ,
        
          ϕ
          
            0
          
        
        =
        i
        d
        ,
      
    
    {\displaystyle {\dot {\phi }}_{t}=v_{t}\circ \phi _{t},\phi _{0}=id,}
   as well as the reduced Hamiltonian 

  
    
      
        H
        (
        
          ϕ
          
            t
          
        
        ,
        
          p
          
            t
          
        
        )
        ≐
        
          max
          
            v
          
        
        H
        (
        
          ϕ
          
            t
          
        
        ,
        
          p
          
            t
          
        
        ,
        v
        )
         
        .
      
    
    {\displaystyle H(\phi _{t},p_{t})\doteq \max _{v}H(\phi _{t},p_{t},v)\ .}
  The Lagrange multiplier in its action as a linear form has its own inner product of the canonical momentum acting on the velocity of the flow which is dependent on the shape, e.g. for landmarks a sum, for surfaces a surface integral, and. for volumes it is a volume integral with respect to 
  
    
      
        d
        x
      
    
    {\displaystyle dx}
   on  
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  . In all cases the Greens kernels carry weights which are the canonical momentum evolving according to an ordinary differential equation which corresponds to EL but is the geodesic reparameterization in canonical momentum. The optimizing vector field is given by

  
    
      
        
          v
          
            t
          
        
        ≐
        arg
        ⁡
        m
        a
        
          x
          
            v
          
        
        H
        (
        
          ϕ
          
            t
          
        
        ,
        
          p
          
            t
          
        
        ,
        v
        )
      
    
    {\displaystyle v_{t}\doteq \arg max_{v}H(\phi _{t},p_{t},v)}
  with dynamics of canonical momentum reparameterizing the vector field along the geodesic

Stationarity of the Hamiltonian and kinetic energy along Euler–Lagrange
Whereas the vector fields are extended across the entire background space of 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  , the geodesic flows associated to the submanifolds has Eulerian shape momentum which evolves as a generalized function 
  
    
      
        A
        
          v
          
            t
          
        
        ∈
        
          V
          
            ∗
          
        
      
    
    {\displaystyle Av_{t}\in V^{*}}
   concentrated to the submanifolds. For landmarks  the geodesics have Eulerian shape momentum which are a superposition of delta distributions travelling with the finite numbers of particles; the diffeomorphic flow of coordinates have velocities in the range of weighted Green's Kernels. For surfaces, the momentum is a surface integral of delta distributions travelling with the surface.The geodesics connecting coordinate systems satisfying EL-General have stationarity of the Lagrangian. The Hamiltonian is given by the extremum along the path 
  
    
      
        t
        ∈
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle t\in [0,1]}
  , 
  
    
      
        H
        (
        ϕ
        ,
        p
        )
        =
        
          max
          
            v
          
        
        H
        (
        ϕ
        ,
        p
        ,
        v
        )
      
    
    {\displaystyle H(\phi ,p)=\max _{v}H(\phi ,p,v)}
  , equalling the Lagrangian-Kinetic-Energy  and is stationary along EL-General. Defining the geodesic velocity at the identity 
  
    
      
        
          v
          
            0
          
        
        =
        arg
        ⁡
        
          max
          
            v
          
        
        H
        (
        
          ϕ
          
            0
          
        
        ,
        
          p
          
            0
          
        
        ,
        v
        )
      
    
    {\displaystyle v_{0}=\arg \max _{v}H(\phi _{0},p_{0},v)}
  , then along the geodesic

The stationarity of the Hamiltonian demonstrates the interpretation of the Lagrange multiplier as momentum; integrated against velocity 
  
    
      
        
          
            
              ϕ
              ˙
            
          
        
      
    
    {\displaystyle {\dot {\phi }}}
   gives energy density. The canonical momentum has many names. In optimal control, the flows 
  
    
      
        ϕ
      
    
    {\displaystyle \phi }
   is interpreted as the state, and 
  
    
      
        p
      
    
    {\displaystyle p}
   is interpreted as conjugate state, or conjugate momentum. The geodesi of EL implies specification of the vector fields 
  
    
      
        
          v
          
            0
          
        
      
    
    {\displaystyle v_{0}}
   or Eulerian momentum 
  
    
      
        A
        
          v
          
            0
          
        
      
    
    {\displaystyle Av_{0}}
   at 
  
    
      
        t
        =
        0
      
    
    {\displaystyle t=0}
  , or specification of canonical momentum 
  
    
      
        
          p
          
            0
          
        
      
    
    {\displaystyle p_{0}}
   determines the flow.

The metric on geodesic flows of landmarks, surfaces, and volumes within the orbit
In computational anatomy the submanifolds are pointsets, curves, surfaces and subvolumes which are the basic primitives. The geodesic flows between the submanifolds determine the distance, and form the basic measuring and transporting tools of diffeomorphometry. At  
  
    
      
        t
        =
        0
      
    
    {\displaystyle t=0}
   the geodesic has vector field 
  
    
      
        
          v
          
            0
          
        
        =
        K
        
          p
          
            0
          
        
      
    
    {\displaystyle v_{0}=Kp_{0}}
   determined by the conjugate momentum and the Green's kernel of the inertial operator defining the Eulerian momentum 
  
    
      
        K
        =
        
          A
          
            −
            1
          
        
      
    
    {\displaystyle K=A^{-1}}
  . The metric distance between coordinate systems connected via the geodesic determined by the induced distance between identity and group element:

  
    
      
        
          d
          
            D
            i
            f
            
              f
              
                V
              
            
          
        
        (
        i
        d
        ,
        φ
        )
        =
        ‖
        L
        o
        
          g
          
            i
            d
          
        
        (
        φ
        )
        
          ‖
          
            V
          
        
        =
        ‖
        
          v
          
            0
          
        
        
          ‖
          
            V
          
        
        =
        
          
            2
            H
            (
            i
            d
            ,
            
              p
              
                0
              
            
            )
          
        
      
    
    {\displaystyle d_{Diff_{V}}(id,\varphi )=\|Log_{id}(\varphi )\|_{V}=\|v_{0}\|_{V}={\sqrt {2H(id,p_{0})}}}

Conservation laws on diffeomorphic shape momentum for computational anatomy
Given the least-action there is a natural definition of momentum associated to generalized coordinates; the quantity acting against velocity gives energy. The field has studied two forms, the momentum associated to the Eulerian vector field termed Eulerian diffeomorphic shape momentum, and the momentum associated to the initial coordinates or canonical coordinates termed canonical diffeomorphic shape momentum. Each has a conservation law. The conservation of momentum goes hand in hand with the EL-General. In computational anatomy, 
  
    
      
        A
        v
      
    
    {\displaystyle Av}
   is the Eulerian Momentum since when integrated against Eulerian velocity 
  
    
      
        v
      
    
    {\displaystyle v}
   gives energy density; operator 
  
    
      
        A
      
    
    {\displaystyle A}
   the generalized moment of inertia or inertial operator which acting on the Eulerian velocity gives momentum which is conserved along the geodesic: 
Conservation of Eulerian shape momentum was shown in and follows from EL-General; conservation of canonical momentum was shown in

Geodesic interpolation of information between coordinate systems via variational problems
Construction of diffeomorphic correspondences between shapes calculates the initial vector field coordinates 
  
    
      
        
          v
          
            0
          
        
        ∈
        V
      
    
    {\displaystyle v_{0}\in V}
   and associated weights on the Greens kernels 
  
    
      
        
          p
          
            0
          
        
      
    
    {\displaystyle p_{0}}
  . These initial coordinates are determined by matching of shapes, called Large Deformation Diffeomorphic Metric Mapping (LDDMM). LDDMM has been solved for landmarks with and without correspondence and for dense image matchings. curves, surfaces, dense vector and tensor imagery, and varifolds removing orientation. LDDMM calculates geodesic flows of the EL-General onto target coordinates, adding to the action integral 
  
    
      
        
          
            1
            2
          
        
        
          ∫
          
            0
          
          
            1
          
        
        
          ∫
          
            X
          
        
        A
        
          v
          
            t
          
        
        ⋅
        
          v
          
            t
          
        
        d
        x
        d
        t
      
    
    {\displaystyle {\frac {1}{2}}\int _{0}^{1}\int _{X}Av_{t}\cdot v_{t}dxdt}
   an endpoint matching condition 
  
    
      
        E
        :
        
          ϕ
          
            1
          
        
        →
        
          R
          
            +
          
        
      
    
    {\displaystyle E:\phi _{1}\rightarrow R^{+}}
   measuring the correspondence of elements in the orbit under coordinate system transformation. Existence of solutions were examined for image matching. The solution of the variational problem satisfies the EL-General for 
  
    
      
        t
        ∈
        [
        0
        ,
        1
        )
      
    
    {\displaystyle t\in [0,1)}
   with boundary condition.

Matching based on minimizing kinetic energy action with endpoint condition
min
          
          
            ϕ
            :
            v
            =
            
              
                
                  ϕ
                  ˙
                
              
            
            ∘
            
              ϕ
              
                −
                1
              
            
            ,
            
              ϕ
              
                0
              
            
            =
            i
            d
          
        
        C
        (
        ϕ
        )
        ≐
        
          
            1
            2
          
        
        
          ∫
          
            0
          
          
            1
          
        
        
          ∫
          
            X
          
        
        A
        
          v
          
            t
          
        
        ⋅
        
          v
          
            t
          
        
        d
        x
        d
        t
        +
        E
        (
        
          ϕ
          
            1
          
        
        )
      
    
    {\displaystyle {\text{min}}_{\phi :v={\dot {\phi }}\circ \phi ^{-1},\phi _{0}=id}C(\phi )\doteq {\frac {1}{2}}\int _{0}^{1}\int _{X}Av_{t}\cdot v_{t}dxdt+E(\phi _{1})}
  

  
    
      
        
          
            {
            
              
                
                  
                    Euler Conservation
                  
                   
                   
                   
                   
                   
                   
                   
                   
                
                
                   
                   
                   
                  
                    
                      d
                      
                        d
                        t
                      
                    
                  
                  A
                  
                    v
                    
                      t
                    
                  
                  +
                  a
                  
                    d
                    
                      
                        v
                        
                          t
                        
                      
                    
                    
                      ∗
                    
                  
                  (
                  A
                  
                    v
                    
                      t
                    
                  
                  )
                  =
                  0
                  ,
                   
                  t
                  ∈
                  [
                  0
                  ,
                  1
                  )
                   
                  ,
                
              
              
                
                  
                    Boundary Condition
                  
                
                
                   
                   
                   
                  
                    ϕ
                    
                      0
                    
                  
                  =
                  i
                  d
                  ,
                  A
                  
                    v
                    
                      1
                    
                  
                  =
                  −
                  
                    
                      
                        ∂
                        E
                        (
                        ϕ
                        )
                      
                      
                        ∂
                        ϕ
                      
                    
                  
                  
                    
                      |
                    
                    
                      ϕ
                      =
                      
                        ϕ
                        
                          1
                        
                      
                    
                  
                   
                  .
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}{\text{Euler Conservation}}\ \ \ \ \ \ \ \ &\ \ \ {\frac {d}{dt}}Av_{t}+ad_{v_{t}}^{*}(Av_{t})=0,\ t\in [0,1)\ ,\\{\text{Boundary Condition}}&\ \ \ \phi _{0}=id,Av_{1}=-{\frac {\partial E(\phi )}{\partial \phi }}|_{\phi =\phi _{1}}\ .\end{cases}}}
  
Conservation from EL-General extends the B.C. at 
  
    
      
        t
        =
        1
      
    
    {\displaystyle t=1}
   to the rest of the path 
  
    
      
        t
        ∈
        [
        0
        ,
        1
        )
      
    
    {\displaystyle t\in [0,1)}
  . The inexact matching problem with the endpoint matching term 
  
    
      
        E
        (
        
          ϕ
          
            1
          
        
        )
      
    
    {\displaystyle E(\phi _{1})}
   has several alternative forms. One of the key ideas of the stationarity of the Hamiltonian along the geodesic solution is the integrated running cost reduces to initial cost at t=0, geodesics of the EL-General are determined by their initial condition 
  
    
      
        
          v
          
            0
          
        
      
    
    {\displaystyle v_{0}}
  .
The running cost is reduced to the initial cost determined by 
  
    
      
        
          v
          
            0
          
        
        =
        K
        
          p
          
            0
          
        
      
    
    {\displaystyle v_{0}=Kp_{0}}
   of  Kernel-Surf.-Land.-Geodesics.

Matching based on geodesic shooting
min
          
            
              v
              
                0
              
            
          
        
        C
        (
        
          v
          
            0
          
        
        )
        ≐
        
          
            1
            2
          
        
        
          ∫
          
            X
          
        
        A
        
          v
          
            0
          
        
        ⋅
        
          v
          
            0
          
        
        d
        x
        +
        E
        (
        
          
            E
            x
            p
          
          
            
              i
              d
            
          
        
        (
        
          v
          
            0
          
        
        )
        ⋅
        
          I
          
            0
          
        
        )
         
        ;
      
    
    {\displaystyle \min _{v_{0}}C(v_{0})\doteq {\frac {1}{2}}\int _{X}Av_{0}\cdot v_{0}dx+E(\mathrm {Exp} _{\mathrm {id} }(v_{0})\cdot I_{0})\ ;}
  

  
    
      
        
          min
          
            
              p
              
                0
              
            
          
        
        C
        (
        
          p
          
            0
          
        
        )
        =
        
          
            1
            2
          
        
        
          ∫
          
            X
          
        
        
          p
          
            0
          
        
        ⋅
        K
        
          p
          
            0
          
        
        d
        x
        +
        E
        (
        
          
            E
            x
            p
          
          
            id
          
        
        (
        K
        
          p
          
            0
          
        
        )
        ⋅
        
          I
          
            0
          
        
        )
      
    
    {\displaystyle \min _{p_{0}}C(p_{0})={\frac {1}{2}}\int _{X}p_{0}\cdot Kp_{0}dx+E(\mathrm {Exp} _{\text{id}}(Kp_{0})\cdot I_{0})}
  The matching problem explicitly indexed to initial condition 
  
    
      
        
          v
          
            0
          
        
      
    
    {\displaystyle v_{0}}
   is called shooting, which can also be reparamerized via the conjugate momentum 
  
    
      
        
          p
          
            0
          
        
      
    
    {\displaystyle p_{0}}
  .

Dense image matching in computational anatomy
Dense image matching has a long history now with the earliest efforts exploiting a small deformation framework. Large deformations began in the early 1990s, with the first existence to solutions to the variational problem for flows of diffeomorphisms for dense image matching established in. Beg solved via one of the earliest LDDMM algorithms based on solving the variational matching with endpoint defined by the dense imagery with respect to the vector fields, taking variations with respect to the vector fields. Another solution for dense image matching reparameterizes the optimization problem in terms of the state 
  
    
      
        
          q
          
            t
          
        
        ≐
        I
        ∘
        
          ϕ
          
            t
          
          
            −
            1
          
        
        ,
        
          q
          
            0
          
        
        =
        I
      
    
    {\displaystyle q_{t}\doteq I\circ \phi _{t}^{-1},q_{0}=I}
   giving the solution in terms of the infinitesimal action defined by the advection equation.

LDDMM dense image matching
For Beg's LDDMM, denote the Image 
  
    
      
        I
        (
        x
        )
        ,
        x
        ∈
        X
      
    
    {\displaystyle I(x),x\in X}
   with group action 
  
    
      
        ϕ
        ⋅
        I
        ≐
        I
        ∘
        
          ϕ
          
            −
            1
          
        
      
    
    {\displaystyle \phi \cdot I\doteq I\circ \phi ^{-1}}
  . 
Viewing this as an optimal control problem, the state of the system is the diffeomorphic flow of coordinates 
  
    
      
        
          ϕ
          
            t
          
        
        ,
        t
        ∈
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle \phi _{t},t\in [0,1]}
  , with the dynamics relating the control 
  
    
      
        
          v
          
            t
          
        
        ,
        t
        ∈
        [
        0
        ,
        1
        ]
      
    
    {\displaystyle v_{t},t\in [0,1]}
   to the state given by 
  
    
      
        
          
            
              ϕ
              ˙
            
          
        
        =
        v
        ∘
        ϕ
      
    
    {\displaystyle {\dot {\phi }}=v\circ \phi }
  . The endpoint matching condition 
  
    
      
        E
        (
        
          ϕ
          
            1
          
        
        )
        ≐
        ‖
        I
        ∘
        
          ϕ
          
            1
          
          
            −
            1
          
        
        −
        
          I
          
            ′
          
        
        
          ‖
          
            2
          
        
      
    
    {\displaystyle E(\phi _{1})\doteq \|I\circ \phi _{1}^{-1}-I^{\prime }\|^{2}}
   gives the variational problem

  
    
      
        
          
            {
            
              
                
                
                  
                    Endpoint Condition:
                  
                   
                   
                   
                   
                   
                   
                  A
                  
                    v
                    
                      1
                    
                  
                  =
                  
                    μ
                    
                      1
                    
                  
                  d
                  x
                  ,
                  
                    μ
                    
                      1
                    
                  
                  =
                  (
                  I
                  ∘
                  
                    ϕ
                    
                      1
                    
                    
                      −
                      1
                    
                  
                  −
                  
                    I
                    
                      ′
                    
                  
                  )
                  ∇
                  (
                  I
                  ∘
                  
                    ϕ
                    
                      1
                    
                    
                      −
                      1
                    
                  
                  )
                   
                  ,
                
              
              
                
                
                  
                    Conservation:
                  
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                  A
                  
                    v
                    
                      t
                    
                  
                  =
                  
                    μ
                    
                      t
                    
                  
                  
                  d
                  x
                  ,
                   
                  
                    μ
                    
                      t
                    
                  
                  =
                  (
                  D
                  
                    ϕ
                    
                      t
                    
                    
                      −
                      1
                    
                  
                  
                    )
                    
                      T
                    
                  
                  
                    μ
                    
                      0
                    
                  
                  ∘
                  
                    ϕ
                    
                      t
                    
                    
                      −
                      1
                    
                  
                  
                    |
                  
                  D
                  
                    ϕ
                    
                      t
                    
                    
                      −
                      1
                    
                  
                  
                    |
                  
                   
                  .
                
              
              
                
                
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                  
                    μ
                    
                      0
                    
                  
                  =
                  (
                  I
                  −
                  
                    I
                    
                      ′
                    
                  
                  ∘
                  
                    ϕ
                    
                      1
                    
                  
                  )
                  ∇
                  I
                  
                    |
                  
                  D
                  
                    ϕ
                    
                      1
                    
                  
                  
                    |
                  
                   
                  .
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}&{\text{Endpoint Condition:}}\ \ \ \ \ \ Av_{1}=\mu _{1}dx,\mu _{1}=(I\circ \phi _{1}^{-1}-I^{\prime })\nabla (I\circ \phi _{1}^{-1})\ ,\\&{\text{Conservation:}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Av_{t}=\mu _{t}\,dx,\ \mu _{t}=(D\phi _{t}^{-1})^{T}\mu _{0}\circ \phi _{t}^{-1}|D\phi _{t}^{-1}|\ .\\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mu _{0}=(I-I^{\prime }\circ \phi _{1})\nabla I|D\phi _{1}|\ .\\\end{cases}}}
  Beg's iterative LDDMM algorithm has fixed points which satisfy the necessary optimizer conditions. The iterative algorithm is given in Beg's LDDMM algorithm for dense image matching.

Hamiltonian LDDMM in the reduced advected state
Denote the Image 
  
    
      
        I
        (
        x
        )
        ,
        x
        ∈
        X
      
    
    {\displaystyle I(x),x\in X}
  , with state 
  
    
      
        
          q
          
            t
          
        
        ≐
        I
        ∘
        
          ϕ
          
            t
          
          
            −
            1
          
        
      
    
    {\displaystyle q_{t}\doteq I\circ \phi _{t}^{-1}}
   and the dynamics related state and control given by the advective term 
  
    
      
        
          
            
              
                q
                ˙
              
            
          
          
            t
          
        
        =
        −
        ∇
        
          q
          
            t
          
        
        ⋅
        
          v
          
            t
          
        
      
    
    {\displaystyle {\dot {q}}_{t}=-\nabla q_{t}\cdot v_{t}}
  . The endpoint 
  
    
      
        E
        (
        
          q
          
            1
          
        
        )
        ≐
        ‖
        
          q
          
            1
          
        
        −
        
          I
          
            ′
          
        
        
          ‖
          
            2
          
        
      
    
    {\displaystyle E(q_{1})\doteq \|q_{1}-I^{\prime }\|^{2}}
   gives the variational problem

Viallard's iterative Hamiltonian LDDMM has fixed points which satisfy the necessary optimizer conditions.

Diffusion tensor image matching in computational anatomy
Dense LDDMM tensor matching takes the images as 3x1 vectors and 3x3 tensors solving the variational problem matching between coordinate system based on the principle eigenvectors of the diffusion tensor MRI image (DTI) denoted 
  
    
      
        M
        (
        x
        )
        ,
        x
        ∈
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle M(x),x\in {\mathbb {R} }^{3}}
   consisting of the 
  
    
      
        3
        ×
        3
      
    
    {\displaystyle 3\times 3}
  -tensor at every voxel. Several of the group actions defined based on the Frobenius matrix norm between square matrices 
  
    
      
        ‖
        A
        
          ‖
          
            F
          
          
            2
          
        
        ≐
        t
        r
        a
        c
        e
        
          A
          
            T
          
        
        A
      
    
    {\displaystyle \|A\|_{F}^{2}\doteq traceA^{T}A}
  . Shown in the accompanying figure is a DTI image illustrated via its color map depicting the eigenvector orientations of the DTI matrix at each voxel with color determined by the orientation of the directions.
Denote the 
  
    
      
        3
        ×
        3
      
    
    {\displaystyle 3\times 3}
   tensor image 
  
    
      
        M
        (
        x
        )
        ,
        x
        ∈
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle M(x),x\in {\mathbb {R} }^{3}}
   with eigen-elements 
  
    
      
        {
        
          λ
          
            i
          
        
        (
        x
        )
        ,
        
          e
          
            i
          
        
        (
        x
        )
        ,
        i
        =
        1
        ,
        2
        ,
        3
        }
      
    
    {\displaystyle \{\lambda _{i}(x),e_{i}(x),i=1,2,3\}}
  , 
  
    
      
        
          λ
          
            1
          
        
        ≥
        
          λ
          
            2
          
        
        ≥
        
          λ
          
            3
          
        
      
    
    {\displaystyle \lambda _{1}\geq \lambda _{2}\geq \lambda _{3}}
  .
Coordinate system transformation based on DTI imaging has exploited two actions 
one based on the principle eigen-vector or entire matrix.
LDDMM matching based on the principal eigenvector of the diffusion tensor matrix
takes the image 
  
    
      
        I
        (
        x
        )
        ,
        x
        ∈
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle I(x),x\in {\mathbb {R} }^{3}}
   as a unit vector field defined by the first eigenvector. The group action becomes

  
    
      
        φ
        ⋅
        I
        =
        
          
            {
            
              
                
                  
                    
                      
                        
                          D
                          
                            
                              φ
                              
                                −
                                1
                              
                            
                          
                        
                        φ
                        I
                        ∘
                        
                          φ
                          
                            −
                            1
                          
                        
                        ‖
                        I
                        ∘
                        
                          φ
                          
                            −
                            1
                          
                        
                        ‖
                      
                      
                        ‖
                        
                          D
                          
                            
                              φ
                              
                                −
                                1
                              
                            
                          
                        
                        φ
                        I
                        ∘
                        
                          φ
                          
                            −
                            1
                          
                        
                        ‖
                      
                    
                  
                
                
                  I
                  ∘
                  φ
                  ≠
                  0
                  ;
                
              
              
                
                  0
                
                
                  
                    otherwise.
                  
                
              
            
            
          
        
      
    
    {\displaystyle \varphi \cdot I={\begin{cases}{\frac {D_{\varphi ^{-1}}\varphi I\circ \varphi ^{-1}\|I\circ \varphi ^{-1}\|}{\|D_{\varphi ^{-1}}\varphi I\circ \varphi ^{-1}\|}}&I\circ \varphi \neq 0;\\0&{\text{otherwise.}}\end{cases}}}
  LDDMM matching based on the entire tensor matrix
has group action becomes 
  
    
      
        φ
        ⋅
        M
        =
        (
        
          λ
          
            1
          
        
        
          
            
              
                e
                ^
              
            
          
          
            1
          
        
        
          
            
              
                e
                ^
              
            
          
          
            1
          
          
            T
          
        
        +
        
          λ
          
            2
          
        
        
          
            
              
                e
                ^
              
            
          
          
            2
          
        
        
          
            
              
                e
                ^
              
            
          
          
            2
          
          
            T
          
        
        +
        
          λ
          
            3
          
        
        
          
            
              
                e
                ^
              
            
          
          
            3
          
        
        
          
            
              
                e
                ^
              
            
          
          
            3
          
          
            T
          
        
        )
        ∘
        
          φ
          
            −
            1
          
        
        ,
      
    
    {\displaystyle \varphi \cdot M=(\lambda _{1}{\hat {e}}_{1}{\hat {e}}_{1}^{T}+\lambda _{2}{\hat {e}}_{2}{\hat {e}}_{2}^{T}+\lambda _{3}{\hat {e}}_{3}{\hat {e}}_{3}^{T})\circ \varphi ^{-1},}
   transformed eigenvectors

  
    
      
        
          
            
              
                
                  
                    
                      
                        e
                        ^
                      
                    
                  
                  
                    1
                  
                
              
              
                
                =
                
                  
                    
                      D
                      φ
                      
                        e
                        
                          1
                        
                      
                    
                    
                      ‖
                      D
                      φ
                      
                        e
                        
                          1
                        
                      
                      ‖
                    
                  
                
                 
                ,
                 
                 
                 
                
                  
                    
                      
                        e
                        ^
                      
                    
                  
                  
                    2
                  
                
                =
                
                  
                    
                      D
                      φ
                      
                        e
                        
                          2
                        
                      
                      −
                      ⟨
                      
                        
                          
                            
                              e
                              ^
                            
                          
                        
                        
                          1
                        
                      
                      ,
                      D
                      φ
                      
                        e
                        
                          2
                        
                      
                      ⟩
                      
                        
                          
                            
                              e
                              ^
                            
                          
                        
                        
                          1
                        
                      
                    
                    
                      ‖
                      D
                      φ
                      
                        e
                        
                          2
                        
                      
                      
                        ‖
                        
                          2
                        
                      
                      −
                      ⟨
                      
                        
                          
                            
                              e
                              ^
                            
                          
                        
                        
                          1
                        
                      
                      ,
                      D
                      φ
                      
                        e
                        
                          2
                        
                      
                      
                        ⟩
                        
                          2
                        
                      
                    
                  
                
                 
                ,
                 
                 
                 
                
                  
                    
                      
                        e
                        ^
                      
                    
                  
                  
                    3
                  
                
                =
                
                  
                    
                      
                        e
                        ^
                      
                    
                  
                  
                    1
                  
                
                ×
                
                  
                    
                      
                        e
                        ^
                      
                    
                  
                  
                    2
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\hat {e}}_{1}&={\frac {D\varphi e_{1}}{\|D\varphi e_{1}\|}}\ ,\ \ \ {\hat {e}}_{2}={\frac {D\varphi e_{2}-\langle {\hat {e}}_{1},D\varphi e_{2}\rangle {\hat {e}}_{1}}{\sqrt {\|D\varphi e_{2}\|^{2}-\langle {\hat {e}}_{1},D\varphi e_{2}\rangle ^{2}}}}\ ,\ \ \ {\hat {e}}_{3}={\hat {e}}_{1}\times {\hat {e}}_{2}\end{aligned}}}
  .The variational problem matching onto the principal eigenvector or the matrix is described
LDDMM Tensor Image Matching.

High Angular Resolution Diffusion Image (HARDI) matching in computational anatomy
High angular resolution diffusion imaging (HARDI) addresses the well-known limitation of DTI, that is, DTI can only reveal one dominant fiber orientation at each location. HARDI measures diffusion along 
  
    
      
        n
      
    
    {\displaystyle n}
   uniformly distributed directions on the sphere and can characterize more complex fiber geometries. HARDI can be used to reconstruct an orientation distribution function (ODF) that characterizes the angular profile of the diffusion probability density function of water molecules. The ODF is a function defined on a unit sphere, 
  
    
      
        
          
            
              S
            
          
          
            2
          
        
      
    
    {\displaystyle {\mathbb {S} }^{2}}
  .
Dense LDDMM ODF matching  takes the HARDI data as ODF at each voxel and solves the LDDMM variational problem in the space of ODF. In the field of information geometry, the space of ODF forms a Riemannian manifold with the Fisher-Rao metric. For the purpose of LDDMM ODF mapping, the square-root representation is chosen because it is one of the most efficient representations found to date as the various Riemannian operations, such as geodesics, exponential maps, and logarithm maps, are available in closed form. In the following, denote square-root ODF (
  
    
      
        
          
            ODF
          
        
      
    
    {\displaystyle {\sqrt {\text{ODF}}}}
  ) as 
  
    
      
        ψ
        (
        
          
            s
          
        
        )
      
    
    {\displaystyle \psi ({\bf {s}})}
  , where 
  
    
      
        ψ
        (
        
          
            s
          
        
        )
      
    
    {\displaystyle \psi ({\bf {s}})}
   is non-negative to ensure uniqueness and 
  
    
      
        
          ∫
          
            
              
                s
              
            
            ∈
            
              
                
                  S
                
              
              
                2
              
            
          
        
        
          ψ
          
            2
          
        
        (
        
          
            s
          
        
        )
        d
        
          
            s
          
        
        =
        1
      
    
    {\displaystyle \int _{{\bf {s}}\in {\mathbb {S} }^{2}}\psi ^{2}({\bf {s}})d{\bf {s}}=1}
  . The variational problem for matching assumes that two ODF volumes can be generated from one to another via flows of diffeomorphisms 
  
    
      
        
          ϕ
          
            t
          
        
      
    
    {\displaystyle \phi _{t}}
  , which are solutions of ordinary differential equations 
  
    
      
        
          
            
              
                ϕ
                ˙
              
            
          
          
            t
          
        
        =
        
          v
          
            t
          
        
        (
        
          ϕ
          
            t
          
        
        )
        ,
        t
        ∈
        [
        0
        ,
        1
        ]
        ,
      
    
    {\displaystyle {\dot {\phi }}_{t}=v_{t}(\phi _{t}),t\in [0,1],}
   starting from the identity map 
  
    
      
        
          ϕ
          
            0
          
        
        =
        
          i
          d
        
      
    
    {\displaystyle \phi _{0}={id}}
  . Denote the action of the diffeomorphism on template  as 
  
    
      
        
          ϕ
          
            1
          
        
        ⋅
        
          ψ
          
            
              t
              e
              m
              p
            
          
        
        (
        
          
            s
          
        
        ,
        x
        )
      
    
    {\displaystyle \phi _{1}\cdot \psi _{\mathrm {temp} }({\bf {s}},x)}
  , 
  
    
      
        
          
            s
          
        
        ∈
        
          
            
              
                S
              
            
            
              2
            
          
        
      
    
    {\displaystyle {\bf {s}}\in {{\mathbb {S} }^{2}}}
  , 
  
    
      
        x
        ∈
        X
      
    
    {\displaystyle x\in X}
   are respectively the coordinates of the unit sphere, 
  
    
      
        
          
            
              
                S
              
            
            
              2
            
          
        
      
    
    {\displaystyle {{\mathbb {S} }^{2}}}
   and the image domain, with the target indexed similarly, 
  
    
      
        
          ψ
          
            
              t
              a
              r
              g
            
          
        
        (
        
          
            s
          
        
        ,
        x
        )
      
    
    {\displaystyle \psi _{\mathrm {targ} }({\bf {s}},x)}
  ,
  
    
      
        
          
            s
          
        
        ∈
        
          
            
              
                S
              
            
            
              2
            
          
        
      
    
    {\displaystyle {\bf {s}}\in {{\mathbb {S} }^{2}}}
  ,
  
    
      
        x
        ∈
        X
      
    
    {\displaystyle x\in X}
  .
The group action of the diffeomorphism on the template is given according to

  
    
      
        
          ϕ
          
            1
          
        
        ⋅
        ψ
        (
        x
        )
        ≐
        (
        D
        
          ϕ
          
            1
          
        
        )
        ψ
        ∘
        
          ϕ
          
            1
          
          
            −
            1
          
        
        (
        x
        )
        ,
        x
        ∈
        X
      
    
    {\displaystyle \phi _{1}\cdot \psi (x)\doteq (D\phi _{1})\psi \circ \phi _{1}^{-1}(x),x\in X}
  ,where 
  
    
      
        (
        D
        
          ϕ
          
            1
          
        
        )
      
    
    {\displaystyle (D\phi _{1})}
   is the Jacobian of the affined transformed ODF and is defined as

  
    
      
        
          
            
              
                (
                D
                
                  ϕ
                  
                    1
                  
                
                )
                ψ
                ∘
                
                  ϕ
                  
                    1
                  
                  
                    −
                    1
                  
                
                (
                x
                )
                =
                
                  
                    
                      
                        det
                        
                          
                            
                              (
                            
                          
                          
                            D
                            
                              
                                ϕ
                                
                                  1
                                
                                
                                  −
                                  1
                                
                              
                            
                          
                          
                            ϕ
                            
                              1
                            
                          
                          
                            
                              
                                )
                              
                            
                            
                              −
                              1
                            
                          
                        
                      
                      
                        
                          ‖
                          
                            
                              
                                
                                  (
                                
                              
                              
                                D
                                
                                  
                                    ϕ
                                    
                                      1
                                    
                                    
                                      −
                                      1
                                    
                                  
                                
                              
                              
                                ϕ
                                
                                  1
                                
                              
                              
                                
                                  
                                    )
                                  
                                
                                
                                  −
                                  1
                                
                              
                            
                            
                              
                                s
                              
                            
                          
                          ‖
                        
                        
                          3
                        
                      
                    
                  
                
                
                ψ
                
                  (
                  
                    
                      
                        
                          (
                          
                            D
                            
                              
                                ϕ
                                
                                  1
                                
                                
                                  −
                                  1
                                
                              
                            
                          
                          
                            ϕ
                            
                              1
                            
                          
                          
                            
                              
                                )
                              
                            
                            
                              −
                              1
                            
                          
                          
                            
                              s
                            
                          
                        
                        
                          ‖
                          (
                          
                            D
                            
                              
                                ϕ
                                
                                  1
                                
                                
                                  −
                                  1
                                
                              
                            
                          
                          
                            ϕ
                            
                              1
                            
                          
                          
                            
                              
                                )
                              
                            
                            
                              −
                              1
                            
                          
                          
                            
                              s
                            
                          
                          ‖
                        
                      
                    
                    ,
                    
                      ϕ
                      
                        1
                      
                      
                        −
                        1
                      
                    
                    (
                    x
                    )
                  
                  )
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}(D\phi _{1})\psi \circ \phi _{1}^{-1}(x)={\sqrt {\frac {\det {{\bigl (}D_{\phi _{1}^{-1}}\phi _{1}{\bigr )}^{-1}}}{\left\|{{\bigl (}D_{\phi _{1}^{-1}}\phi _{1}{\bigr )}^{-1}}{\bf {s}}\right\|^{3}}}}\quad \psi \left({\frac {(D_{\phi _{1}^{-1}}\phi _{1}{\bigr )}^{-1}{\bf {s}}}{\|(D_{\phi _{1}^{-1}}\phi _{1}{\bigr )}^{-1}{\bf {s}}\|}},\phi _{1}^{-1}(x)\right).\end{aligned}}}
  
This group action of diffeomorphisms on ODF reorients the ODF and reflects changes in both the magnitude of 
  
    
      
        ψ
      
    
    {\displaystyle \psi }
   and the sampling directions of 
  
    
      
        
          
            s
          
        
      
    
    {\displaystyle {\bf {s}}}
   due to affine transformation. It guarantees that the volume fraction of fibers oriented toward a small patch must remain the same after the patch is transformed.
The LDDMM variational problem is defined as

  
    
      
        
          
            
              
                C
                (
                v
                )
                =
                
                  inf
                  
                    v
                    :
                    
                      
                        
                          
                            ϕ
                            ˙
                          
                        
                      
                      
                        t
                      
                    
                    =
                    
                      v
                      
                        t
                      
                    
                    ∘
                    
                      ϕ
                      
                        t
                      
                    
                    ,
                    
                      ϕ
                      
                        0
                      
                    
                    =
                    
                      i
                      d
                    
                  
                
                
                  ∫
                  
                    0
                  
                  
                    1
                  
                
                
                  ∫
                  
                    X
                  
                
                A
                
                  v
                  
                    t
                  
                
                ⋅
                
                  v
                  
                    t
                  
                
                d
                x
                 
                d
                t
                +
                λ
                
                  ∫
                  
                    x
                    ∈
                    Ω
                  
                
                ‖
                
                  log
                  
                    (
                    D
                    
                      ϕ
                      
                        1
                      
                    
                    )
                    
                      ψ
                      
                        
                          t
                          e
                          m
                          p
                        
                      
                    
                    ∘
                    
                      ϕ
                      
                        1
                      
                      
                        −
                        1
                      
                    
                    (
                    x
                    )
                  
                
                ⁡
                (
                
                  ψ
                  
                    
                      t
                      a
                      r
                      g
                    
                  
                
                (
                x
                )
                )
                
                  ‖
                  
                    (
                    D
                    
                      ϕ
                      
                        1
                      
                    
                    )
                    
                      ψ
                      
                        
                          t
                          e
                          m
                          p
                        
                      
                    
                    ∘
                    
                      ϕ
                      
                        1
                      
                      
                        −
                        1
                      
                    
                    (
                    x
                    )
                  
                  
                    2
                  
                
                d
                x
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}C(v)=\inf _{v:{\dot {\phi }}_{t}=v_{t}\circ \phi _{t},\phi _{0}={id}}\int _{0}^{1}\int _{X}Av_{t}\cdot v_{t}dx\ dt+\lambda \int _{x\in \Omega }\|\log _{(D\phi _{1})\psi _{\mathrm {temp} }\circ \phi _{1}^{-1}(x)}(\psi _{\mathrm {targ} }(x))\|_{(D\phi _{1})\psi _{\mathrm {temp} }\circ \phi _{1}^{-1}(x)}^{2}dx\end{aligned}}}
  .where the logarithm of 
  
    
      
        
          ψ
          
            1
          
        
        ,
        
          ψ
          
            2
          
        
        ∈
        Ψ
      
    
    {\displaystyle \psi _{1},\psi _{2}\in \Psi }
   is defined as

  
    
      
        
          
            
              
                ‖
                
                  log
                  
                    
                      ψ
                      
                        1
                      
                    
                  
                
                ⁡
                (
                
                  ψ
                  
                    2
                  
                
                )
                
                  ‖
                  
                    
                      ψ
                      
                        1
                      
                    
                  
                
                =
                
                  cos
                  
                    −
                    1
                  
                
                ⁡
                ⟨
                
                  ψ
                  
                    1
                  
                
                ,
                
                  ψ
                  
                    2
                  
                
                ⟩
                =
                
                  cos
                  
                    −
                    1
                  
                
                ⁡
                
                  (
                  
                    
                      ∫
                      
                        
                          
                            s
                          
                        
                        ∈
                        
                          
                            
                              S
                            
                          
                          
                            2
                          
                        
                      
                    
                    
                      ψ
                      
                        1
                      
                    
                    (
                    
                      
                        s
                      
                    
                    )
                    
                      ψ
                      
                        2
                      
                    
                    (
                    
                      
                        s
                      
                    
                    )
                    d
                    
                      
                        s
                      
                    
                  
                  )
                
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\|\log _{\psi _{1}}(\psi _{2})\|_{\psi _{1}}=\cos ^{-1}\langle \psi _{1},\psi _{2}\rangle =\cos ^{-1}\left(\int _{{\bf {s}}\in {\mathbb {S} }^{2}}\psi _{1}({\bf {s}})\psi _{2}({\bf {s}})d{\bf {s}}\right),\end{aligned}}}
  where 
  
    
      
        ⟨
        ⋅
        ,
        ⋅
        ⟩
      
    
    {\displaystyle \langle \cdot ,\cdot \rangle }
   is the normal dot product between points in the sphere under the 
  
    
      
        
          
            L
          
          
            2
          
        
      
    
    {\displaystyle \mathrm {L} ^{2}}
   metric.
This LDDMM-ODF mapping algorithm has been widely used to study brain white matter degeneration in aging, Alzheimer's disease, and vascular dementia. The brain white matter atlas generated based on ODF is constructed via Bayesian estimation. Regression analysis on ODF is developed in the ODF manifold space in.

Metamorphosis
The principle mode of variation represented by the orbit model is change of coordinates. For setting in which pairs of images are not related by diffeomorphisms but have photometric variation or image variation not represented by the template, active appearance modelling has been introduced, originally by Edwards-Cootes-Taylor and in 3D medical imaging in. In the context of computational anatomy in which metrics on the anatomical orbit has been studied, metamorphosis for modelling structures such as tumors and photometric changes which are not resident in the template was introduced in for Magnetic Resonance image models, with many subsequent developments extending the metamorphosis framework.For image matching the image metamorphosis framework enlarges the action so that 
  
    
      
        t
        ↦
        (
        
          ϕ
          
            t
          
        
        ,
        
          I
          
            t
          
        
        )
      
    
    {\displaystyle t\mapsto (\phi _{t},I_{t})}
   with action 
  
    
      
        
          ϕ
          
            t
          
        
        ⋅
        
          I
          
            t
          
        
        ≐
        
          I
          
            t
          
        
        ∘
        
          ϕ
          
            t
          
          
            −
            1
          
        
      
    
    {\displaystyle \phi _{t}\cdot I_{t}\doteq I_{t}\circ \phi _{t}^{-1}}
  . In this setting metamorphosis combines both the diffeomorphic coordinate system transformation of computational anatomy as well as the early morphing technologies which only faded or modified the photometric or image intensity alone.
Then the matching problem takes a form with equality boundary conditions:

  
    
      
        
          min
          
            (
            v
            ,
            I
            )
          
        
        
          
            1
            2
          
        
        
          ∫
          
            0
          
          
            1
          
        
        
          (
          
            
              ∫
              
                X
              
            
            A
            
              v
              
                t
              
            
            ⋅
            
              v
              
                t
              
            
            d
            x
            +
            ‖
            
              
                
                  
                    I
                    ˙
                  
                
              
              
                t
              
            
            ∘
            
              ϕ
              
                t
              
              
                −
                1
              
            
            
              ‖
              
                2
              
            
            
              /
            
            
              σ
              
                2
              
            
          
          )
        
        
        d
        t
        
           subject to
        
         
        
          ϕ
          
            0
          
        
        =
        i
        d
        ,
        
          I
          
            0
          
        
        =
        
          fixed
        
        ,
        
          I
          
            1
          
        
        =
        
          fixed
        
      
    
    {\displaystyle \min _{(v,I)}{\frac {1}{2}}\int _{0}^{1}\left(\int _{X}Av_{t}\cdot v_{t}dx+\|{\dot {I}}_{t}\circ \phi _{t}^{-1}\|^{2}/\sigma ^{2}\right)\,dt{\text{ subject to}}\ \phi _{0}=id,I_{0}={\text{fixed}},I_{1}={\text{fixed}}}

Matching landmarks, curves, surfaces
Transforming coordinate systems based on Landmark point or fiducial marker features dates back to Bookstein's early work on small deformation spline methods for interpolating correspondences defined by fiducial points to the two-dimensional or three-dimensional background space in which the fiducials are defined. Large deformation landmark methods came on in the late 1990s. The above Figure depicts a series of landmarks associated three brain structures, the amygdala, entorhinal cortex, and hippocampus.
Matching geometrical objects like unlabelled point distributions, curves or surfaces is another common problem in computational anatomy. Even in the discrete setting where these are commonly given as vertices with meshes, there are no predetermined correspondences between points as opposed to the situation of landmarks described above. From the theoretical point of view, while any submanifold 
  
    
      
        X
      
    
    {\displaystyle X}
   in 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  , 
  
    
      
        d
        =
        1
        ,
        2
        ,
        3
      
    
    {\displaystyle d=1,2,3}
   can be parameterized in local charts 
  
    
      
        m
        :
        u
        ∈
        U
        ⊂
        
          
            
              R
            
          
          
            0
            ,
            1
            ,
            2
            ,
            3
          
        
        →
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle m:u\in U\subset {\mathbb {R} }^{0,1,2,3}\rightarrow {\mathbb {R} }^{3}}
  , all reparametrizations of these charts give geometrically the same manifold. Therefore, early on in computational anatomy, investigators have identified the necessity of parametrization invariant representations. One indispensable requirement is that the end-point matching term between two submanifolds is itself independent of their parametrizations. This can be achieved via concepts and methods borrowed from Geometric measure theory, in particular currents and varifolds which have been used extensively for curve and surface matching.

Landmark or point matching with correspondence
Denoted the landmarked shape 
  
    
      
        X
        ≐
        {
        
          x
          
            1
          
        
        ,
        …
        ,
        
          x
          
            n
          
        
        }
        ⊂
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle X\doteq \{x_{1},\dots ,x_{n}\}\subset {\mathbb {R} }^{3}}
   with endpoint 
  
    
      
        E
        (
        
          ϕ
          
            1
          
        
        )
        ≐
        
          
            ∑
            
              i
            
          
          
            ‖
            
              ϕ
              
                1
              
            
            (
            
              x
              
                i
              
            
            )
            −
            
              x
              
                i
              
              
                ′
              
            
            
              ‖
              
                2
              
            
          
        
      
    
    {\displaystyle E(\phi _{1})\doteq \textstyle \sum _{i}\displaystyle \|\phi _{1}(x_{i})-x_{i}^{\prime }\|^{2}}
  , the variational problem becomes

The geodesic Eulerian momentum is a generalized function  
  
    
      
        
          A
          
            v
            
              t
            
          
          ∈
          
            V
            
              ∗
            
          
          
            ,
            t
            ∈
            [
            0
            ,
            1
            ]
          
        
      
    
    {\displaystyle \displaystyle Av_{t}\in V^{*}\textstyle ,t\in [0,1]}
  , supported on the landmarked set in the variational problem. The endpoint condition with conservation implies the initial momentum at the identity of the group:

  
    
      
        
          
            {
            
              
                
                
                  
                    Endpoint Condition:
                  
                   
                   
                   
                   
                   
                  A
                  
                    v
                    
                      1
                    
                  
                  =
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    p
                    
                      1
                    
                  
                  (
                  i
                  )
                  
                    δ
                    
                      
                        ϕ
                        
                          1
                        
                      
                      (
                      
                        x
                        
                          i
                        
                      
                      )
                    
                  
                  ,
                  
                    p
                    
                      1
                    
                  
                  (
                  i
                  )
                  =
                  (
                  
                    x
                    
                      i
                    
                    
                      ′
                    
                  
                  −
                  
                    ϕ
                    
                      1
                    
                  
                  (
                  
                    x
                    
                      i
                    
                  
                  )
                  )
                   
                  ,
                
              
              
                
                
                  
                    Conservation:
                  
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                  A
                  
                    v
                    
                      t
                    
                  
                  =
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    p
                    
                      t
                    
                  
                  (
                  i
                  )
                  
                    δ
                    
                      
                        ϕ
                        
                          t
                        
                      
                      (
                      
                        x
                        
                          i
                        
                      
                      )
                    
                  
                  ,
                   
                  
                    p
                    
                      t
                    
                  
                  (
                  i
                  )
                  =
                  (
                  D
                  
                    ϕ
                    
                      t
                      1
                    
                  
                  
                    )
                    
                      
                        |
                      
                      
                        ϕ
                        
                          t
                        
                      
                      (
                      
                        x
                        
                          i
                        
                      
                      )
                    
                    
                      T
                    
                  
                  
                    p
                    
                      1
                    
                  
                  (
                  i
                  )
                   
                  ,
                   
                  
                    ϕ
                    
                      t
                      1
                    
                  
                  ≐
                  
                    ϕ
                    
                      1
                    
                  
                  ∘
                  
                    ϕ
                    
                      t
                    
                    
                      −
                      1
                    
                  
                   
                  ,
                
              
              
                
                
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                   
                  A
                  
                    v
                    
                      0
                    
                  
                  =
                  
                    ∑
                    
                      i
                    
                  
                  
                    δ
                    
                      
                        x
                        
                          i
                        
                      
                    
                  
                  (
                  ⋅
                  )
                  
                    p
                    
                      0
                    
                  
                  (
                  i
                  )
                   
                  
                    with
                  
                   
                   
                  
                    p
                    
                      0
                    
                  
                  (
                  i
                  )
                  =
                  (
                  D
                  
                    ϕ
                    
                      1
                    
                  
                  
                    )
                    
                      
                        |
                      
                      
                        x
                        
                          i
                        
                      
                    
                    
                      T
                    
                  
                  (
                  
                    x
                    
                      i
                    
                    
                      ′
                    
                  
                  −
                  
                    ϕ
                    
                      1
                    
                  
                  (
                  
                    x
                    
                      i
                    
                  
                  )
                  )
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}&{\text{Endpoint Condition:}}\ \ \ \ \ Av_{1}=\sum _{i=1}^{n}p_{1}(i)\delta _{\phi _{1}(x_{i})},p_{1}(i)=(x_{i}^{\prime }-\phi _{1}(x_{i}))\ ,\\&{\text{Conservation:}}\ \ \ \ \ \ \ \ \ \ \ \ \ \ Av_{t}=\sum _{i=1}^{n}p_{t}(i)\delta _{\phi _{t}(x_{i})},\ p_{t}(i)=(D\phi _{t1})_{|\phi _{t}(x_{i})}^{T}p_{1}(i)\ ,\ \phi _{t1}\doteq \phi _{1}\circ \phi _{t}^{-1}\ ,\\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Av_{0}=\sum _{i}\delta _{x_{i}}(\cdot )p_{0}(i)\ {\text{with}}\ \ p_{0}(i)=(D\phi _{1})_{|x_{i}}^{T}(x_{i}^{\prime }-\phi _{1}(x_{i}))\end{cases}}}
  The iterative algorithm 
for large deformation diffeomorphic metric mapping for landmarks is given.

Measure matching: unregistered landmarks
Glaunes and co-workers first introduced diffeomorphic matching of pointsets in the general setting of matching distributions. As opposed to landmarks, this includes in particular the situation of weighted point clouds with no predefined correspondences and possibly different cardinalities. The template and target discrete point clouds are represented as two weighted sums of Diracs 
  
    
      
        
          μ
          
            m
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          ρ
          
            i
          
        
        
          δ
          
            
              x
              
                i
              
            
          
        
      
    
    {\displaystyle \mu _{m}=\sum _{i=1}^{n}\rho _{i}\delta _{x_{i}}}
   and 
  
    
      
        
          μ
          
            
              m
              
                ′
              
            
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            
              n
              
                ′
              
            
          
        
        
          ρ
          
            i
          
          
            ′
          
        
        
          δ
          
            
              x
              
                i
              
              
                ′
              
            
          
        
      
    
    {\displaystyle \mu _{m^{\prime }}=\sum _{i=1}^{n^{\prime }}\rho _{i}^{\prime }\delta _{x_{i}^{\prime }}}
   living in the space of signed measures of 
  
    
      
        
          
            R
          
          
            3
          
        
      
    
    {\displaystyle \mathbb {R} ^{3}}
  . The space is equipped with a Hilbert metric obtained from a real positive kernel 
  
    
      
        k
        (
        x
        ,
        y
        )
      
    
    {\displaystyle k(x,y)}
   on 
  
    
      
        
          
            R
          
          
            3
          
        
      
    
    {\displaystyle \mathbb {R} ^{3}}
  , giving the following norm:

  
    
      
        ‖
        
          μ
          
            m
          
        
        
          ‖
          
            
              m
              e
              a
            
          
          
            2
          
        
        =
        
          ∑
          
            i
            ,
            j
            =
            1
          
          
            n
          
        
        
          ρ
          
            i
          
        
        
          ρ
          
            j
          
        
        k
        (
        
          x
          
            i
          
        
        ,
        
          x
          
            j
          
        
        )
      
    
    {\displaystyle \|\mu _{m}\|_{\mathrm {mea} }^{2}=\sum _{i,j=1}^{n}\rho _{i}\rho _{j}k(x_{i},x_{j})}
  The matching problem between a template and target point cloud may be then formulated using this kernel metric for the endpoint matching term:

  
    
      
        
          min
          
            ϕ
            :
            v
            =
            
              
                
                  ϕ
                  ˙
                
              
            
            ∘
            
              ϕ
              
                −
                1
              
            
          
        
        C
        (
        ϕ
        )
        ≐
        
          
            1
            2
          
        
        ∫
        (
        A
        
          v
          
            t
          
        
        ∣
        
          v
          
            t
          
        
        )
        
        d
        t
        +
        
          
            1
            2
          
        
        ‖
        
          μ
          
            
              ϕ
              
                1
              
            
            ⋅
            m
          
        
        −
        
          μ
          
            
              m
              
                ′
              
            
          
        
        
          ‖
          
            
              m
              e
              a
            
          
          
            2
          
        
      
    
    {\displaystyle \min _{\phi :v={\dot {\phi }}\circ \phi ^{-1}}C(\phi )\doteq {\frac {1}{2}}\int (Av_{t}\mid v_{t})\,dt+{\frac {1}{2}}\|\mu _{\phi _{1}\cdot m}-\mu _{m^{\prime }}\|_{\mathrm {mea} }^{2}}
  where 
  
    
      
        
          μ
          
            
              ϕ
              
                1
              
            
            ⋅
            m
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          ρ
          
            i
          
        
        
          δ
          
            
              ϕ
              
                1
              
            
            (
            
              x
              
                i
              
            
            )
          
        
      
    
    {\displaystyle \mu _{\phi _{1}\cdot m}=\sum _{i=1}^{n}\rho _{i}\delta _{\phi _{1}(x_{i})}}
   is the distribution transported by the deformation.

Curve matching
In the one dimensional case, a curve in 3D can be represented by an embedding 
  
    
      
        m
        :
        u
        ∈
        [
        0
        ,
        1
        ]
        →
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle m:u\in [0,1]\rightarrow {\mathbb {R} }^{3}}
  , and the group action of Diff becomes 
  
    
      
        ϕ
        ⋅
        m
        =
        ϕ
        ∘
        m
      
    
    {\displaystyle \phi \cdot m=\phi \circ m}
  . However, the correspondence between curves and embeddings is not one to one as the any reparametrization 
  
    
      
        m
        ∘
        γ
      
    
    {\displaystyle m\circ \gamma }
  , for 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   a diffeomorphism of the interval [0,1], represents geometrically the same curve. In order to preserve this invariance in the end-point matching term, several extensions of the previous 0-dimensional measure matching approach can be considered.

Curve matching with currentsIn the situation of oriented curves, currents give an efficient setting to construct invariant matching terms. In such representation, curves are interpreted as elements of a functional space dual to the space vector fields, and compared through kernel norms on these spaces. Matching of two curves 
  
    
      
        m
      
    
    {\displaystyle m}
   and 
  
    
      
        
          m
          
            ′
          
        
      
    
    {\displaystyle m^{\prime }}
   writes eventually as the variational problem

  
    
      
        
          min
          
            ϕ
            :
            v
            =
            
              
                
                  ϕ
                  ˙
                
              
            
            ∘
            
              ϕ
              
                −
                1
              
            
          
        
        C
        (
        ϕ
        )
        ≐
        
          
            1
            2
          
        
        ∫
        (
        A
        
          v
          
            t
          
        
        ∣
        
          v
          
            t
          
        
        )
        
        d
        t
        +
        
          
            1
            2
          
        
        ‖
        
          
            
              C
            
          
          
            
              ϕ
              
                1
              
            
            ⋅
            m
          
        
        −
        
          
            
              C
            
          
          
            
              m
              
                ′
              
            
          
        
        
          ‖
          
            
              c
              u
              r
            
          
          
            2
          
        
      
    
    {\displaystyle \min _{\phi :v={\dot {\phi }}\circ \phi ^{-1}}C(\phi )\doteq {\frac {1}{2}}\int (Av_{t}\mid v_{t})\,dt+{\frac {1}{2}}\|{\mathcal {C}}_{\phi _{1}\cdot m}-{\mathcal {C}}_{m^{\prime }}\|_{\mathrm {cur} }^{2}}
  with the endpoint term 
  
    
      
        E
        (
        
          ϕ
          
            1
          
        
        )
        =
        ‖
        
          
            
              C
            
          
          
            
              ϕ
              
                1
              
            
            ⋅
            m
          
        
        −
        
          
            
              C
            
          
          
            
              m
              
                ′
              
            
          
        
        
          ‖
          
            
              c
              u
              r
            
          
          
            2
          
        
        
          /
        
        2
      
    
    {\displaystyle E(\phi _{1})=\|{\mathcal {C}}_{\phi _{1}\cdot m}-{\mathcal {C}}_{m^{\prime }}\|_{\mathrm {cur} }^{2}/2}
   is obtained from the norm

  
    
      
        ‖
        
          
            
              C
            
          
          
            m
          
        
        
          ‖
          
            
              c
              u
              r
            
          
          
            2
          
        
        =
        
          ∫
          
            0
          
          
            1
          
        
        
          ∫
          
            0
          
          
            1
          
        
        
          K
          
            C
          
        
        (
        m
        (
        u
        )
        ,
        m
        (
        v
        )
        )
        ∂
        m
        (
        u
        )
        ⋅
        ∂
        m
        (
        v
        )
        
        d
        u
        
        d
        v
      
    
    {\displaystyle \|{\mathcal {C}}_{m}\|_{\mathrm {cur} }^{2}=\int _{0}^{1}\int _{0}^{1}K_{C}(m(u),m(v))\partial m(u)\cdot \partial m(v)\,du\,dv}
  the derivative 
  
    
      
        ∂
        m
        (
        u
        )
      
    
    {\displaystyle \partial m(u)}
   being the tangent vector to the curve and 
  
    
      
        
          K
          
            
              C
            
          
        
      
    
    {\displaystyle K_{\mathcal {C}}}
   a given matrix kernel of 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  . Such expressions are invariant to any positive reparametrizations of 
  
    
      
        m
      
    
    {\displaystyle m}
   and 
  
    
      
        
          m
          ′
        
      
    
    {\displaystyle m'}
  , and thus still depend on the orientation of the two curves.

Curve matching with varifoldsVarifold is an alternative to currents when orientation becomes an issue as for instance in situations involving multiple bundles of curves for which no "consistent" orientation may be defined. Varifolds directly extend 0-dimensional measures by adding an extra tangent space direction to the position of points, leading to represent curves as measures on the product of 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
   and the Grassmannian of all straight lines in 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  . The matching problem between two curves then consists in replacing the endpoint matching term by 
  
    
      
        E
        (
        
          ϕ
          
            1
          
        
        )
        =
        ‖
        
          
            
              V
            
          
          
            
              ϕ
              
                1
              
            
            ⋅
            m
          
        
        −
        
          
            
              V
            
          
          
            
              m
              
                ′
              
            
          
        
        
          ‖
          
            c
            u
            r
          
          
            2
          
        
        
          /
        
        2
      
    
    {\displaystyle E(\phi _{1})=\|{\mathcal {V}}_{\phi _{1}\cdot m}-{\mathcal {V}}_{m^{\prime }}\|_{cur}^{2}/2}
   with varifold norms of the form:

  
    
      
        ‖
        
          
            
              V
            
          
          
            m
          
        
        
          ‖
          
            v
            a
            r
          
          
            2
          
        
        =
        
          ∫
          
            0
          
          
            1
          
        
        
          ∫
          
            0
          
          
            1
          
        
        
          k
          
            
              
                R
              
              
                3
              
            
          
        
        (
        m
        (
        u
        )
        ,
        m
        (
        v
        )
        )
        
          k
          
            
              G
              r
            
          
        
        
          (
          
            [
            ∂
            m
            (
            u
            )
            ]
            ,
            [
            ∂
            m
            (
            v
            )
            ]
          
          )
        
        ∂
        m
        (
        u
        )
        
          
            |
          
        
        ∂
        m
        (
        v
        )
        
          
            |
          
        
        
        d
        u
        
        d
        v
      
    
    {\displaystyle \|{\mathcal {V}}_{m}\|_{var}^{2}=\int _{0}^{1}\int _{0}^{1}k_{\mathbb {R} ^{3}}(m(u),m(v))k_{\mathbf {Gr} }\left([\partial m(u)],[\partial m(v)]\right)\partial m(u){|}\partial m(v){|}\,du\,dv}
  where 
  
    
      
        [
        ∂
        m
        (
        u
        )
        ]
      
    
    {\displaystyle [\partial m(u)]}
   is the non-oriented line directed by tangent vector 
  
    
      
        ∂
        m
        (
        u
        )
      
    
    {\displaystyle \partial m(u)}
   and 
  
    
      
        
          k
          
            
              
                R
              
              
                3
              
            
          
        
        ,
        
          k
          
            
              G
              r
            
          
        
      
    
    {\displaystyle k_{\mathbb {R} ^{3}},k_{\mathbf {Gr} }}
   two scalar kernels respectively on  
  
    
      
        
          
            R
          
          
            3
          
        
      
    
    {\displaystyle \mathbb {R} ^{3}}
   and the Grassmannian. Due to the inherent non-oriented nature of the Grassmannian representation, such expressions are invariant to positive and negative reparametrizations.

Surface matching
Surface matching share many similarities with the case of curves. Surfaces in 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
   are parametrized in local charts by embeddings 
  
    
      
        m
        :
        u
        ∈
        U
        ⊂
        
          
            
              R
            
          
          
            2
          
        
        →
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle m:u\in U\subset {\mathbb {R} }^{2}\rightarrow {\mathbb {R} }^{3}}
  , with all reparametrizations 
  
    
      
        m
        ∘
        γ
      
    
    {\displaystyle m\circ \gamma }
   with 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
   a diffeomorphism of U being equivalent geometrically. Currents and varifolds can be also used to formalize surface matching.

Surface matching with currentsOriented surfaces can be represented as 2-currents which are dual to differential 2-forms. In 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
  , one can further identify 2-forms with vector fields through the standard wedge product of 3D vectors. In that setting, surface matching writes again:

  
    
      
        
          min
          
            ϕ
            :
            v
            =
            
              
                
                  ϕ
                  ˙
                
              
            
            ∘
            
              ϕ
              
                −
                1
              
            
          
        
        C
        (
        ϕ
        )
        ≐
        
          
            1
            2
          
        
        ∫
        (
        A
        
          v
          
            t
          
        
        ∣
        
          v
          
            t
          
        
        )
        
        d
        t
        +
        
          
            1
            2
          
        
        ‖
        
          
            
              C
            
          
          
            
              ϕ
              
                1
              
            
            ⋅
            m
          
        
        −
        
          
            
              C
            
          
          
            
              m
              
                ′
              
            
          
        
        
          ‖
          
            
              c
              u
              r
            
          
          
            2
          
        
      
    
    {\displaystyle \min _{\phi :v={\dot {\phi }}\circ \phi ^{-1}}C(\phi )\doteq {\frac {1}{2}}\int (Av_{t}\mid v_{t})\,dt+{\frac {1}{2}}\|{\mathcal {C}}_{\phi _{1}\cdot m}-{\mathcal {C}}_{m^{\prime }}\|_{\mathrm {cur} }^{2}}
  with the endpoint term 
  
    
      
        E
        (
        
          ϕ
          
            1
          
        
        )
        =
        ‖
        
          
            
              C
            
          
          
            
              ϕ
              
                1
              
            
            ⋅
            m
          
        
        −
        
          
            
              C
            
          
          
            
              m
              
                ′
              
            
          
        
        
          ‖
          
            
              c
              u
              r
            
          
          
            2
          
        
        
          /
        
        2
      
    
    {\displaystyle E(\phi _{1})=\|{\mathcal {C}}_{\phi _{1}\cdot m}-{\mathcal {C}}_{m^{\prime }}\|_{\mathrm {cur} }^{2}/2}
   given through the norm

  
    
      
        ‖
        
          
            
              C
            
          
          
            m
          
        
        
          ‖
          
            
              c
              u
              r
            
          
          
            2
          
        
        =
        
          ∬
          
            U
            ×
            U
          
        
        
          K
          
            C
          
        
        (
        m
        (
        u
        )
        ,
        m
        (
        v
        )
        )
        
          
            
              n
              →
            
          
        
        (
        u
        )
        ⋅
        
          
            
              n
              →
            
          
        
        (
        v
        )
        
        d
        u
        
        d
        v
      
    
    {\displaystyle \|{\mathcal {C}}_{m}\|_{\mathrm {cur} }^{2}=\iint _{U\times U}K_{C}(m(u),m(v)){\vec {n}}(u)\cdot {\vec {n}}(v)\,du\,dv}
  with 
  
    
      
        
          
            
              n
              →
            
          
        
        =
        
          ∂
          
            
              u
              
                1
              
            
          
        
        m
        ∧
        
          ∂
          
            
              u
              
                2
              
            
          
        
        m
      
    
    {\displaystyle {\vec {n}}=\partial _{u_{1}}m\wedge \partial _{u_{2}}m}
   the normal vector to the surface parametrized by 
  
    
      
        m
      
    
    {\displaystyle m}
  .
This surface mapping algorithm has been validated for brain cortical surfaces against CARET and FreeSurfer. LDDMM mapping for multiscale surfaces is discussed in.
Surface matching with varifoldsFor non-orientable or non-oriented surfaces, the varifold framework is often more adequate. Identifying the parametric surface 
  
    
      
        m
      
    
    {\displaystyle m}
   with a varifold 
  
    
      
        
          
            
              V
            
          
          
            m
          
        
      
    
    {\displaystyle {\mathcal {V}}_{m}}
   in the space of measures on the product of 
  
    
      
        
          
            
              R
            
          
          
            3
          
        
      
    
    {\displaystyle {\mathbb {R} }^{3}}
   and the Grassmannian, one simply replaces the previous current metric 
  
    
      
        ‖
        
          
            
              C
            
          
          
            m
          
        
        
          ‖
          
            
              c
              u
              r
            
          
          
            2
          
        
      
    
    {\displaystyle \|{\mathcal {C}}_{m}\|_{\mathrm {cur} }^{2}}
   by:

  
    
      
        ‖
        
          
            
              V
            
          
          
            m
          
        
        
          ‖
          
            
              v
              a
              r
            
          
          
            2
          
        
        =
        
          ∬
          
            U
            ×
            U
          
        
        
          k
          
            
              
                R
              
              
                3
              
            
          
        
        (
        m
        (
        u
        )
        ,
        m
        (
        v
        )
        )
        
          k
          
            
              G
              r
            
          
        
        
          (
          
            [
            
              
                
                  n
                  →
                
              
            
            (
            u
            )
            ]
            ,
            [
            
              
                
                  n
                  →
                
              
            
            (
            v
            )
            ]
          
          )
        
        
          
            |
          
        
        
          
            
              n
              →
            
          
        
        (
        u
        )
        
          
            |
          
        
        
          
            |
          
        
        
          
            
              n
              →
            
          
        
        (
        v
        )
        
          
            |
          
        
        
        d
        u
        
        d
        v
      
    
    {\displaystyle \|{\mathcal {V}}_{m}\|_{\mathrm {var} }^{2}=\iint _{U\times U}k_{\mathbb {R} ^{3}}(m(u),m(v))k_{\mathbf {Gr} }\left([{\vec {n}}(u)],[{\vec {n}}(v)]\right){|}{\vec {n}}(u){|}{|}{\vec {n}}(v){|}\,du\,dv}
  where 
  
    
      
        [
        
          
            
              n
              →
            
          
        
        (
        u
        )
        ]
      
    
    {\displaystyle [{\vec {n}}(u)]}
   is the (non-oriented) line directed by the normal vector to the surface.

Growth and atrophy from longitudinal time-series
There are many settings in which there are a series of measurements, a time-series to which the underlying
coordinate systems will be matched and flowed onto. This occurs for example
in the dynamic growth and atrophy models and motion tracking such as have been explored in An observed time sequence is given and the goal is to infer the time flow of geometric change of coordinates carrying the exemplars or templars through the period of observations.
The generic time-series matching problem considers the series of times is 
  
    
      
        0
        <
        
          t
          
            1
          
        
        <
        …
        
          t
          
            K
          
        
        =
        1
      
    
    {\displaystyle 0<t_{1}<\dots t_{K}=1}
  . The flow optimizes at the series of costs 
  
    
      
        E
        (
        
          t
          
            k
          
        
        )
        ,
        k
        =
        1
        ,
        …
        ,
        K
      
    
    {\displaystyle E(t_{k}),k=1,\dots ,K}
   giving optimization problems of the form

  
    
      
        
          min
          
            ϕ
            :
            v
            =
            
              
                
                  ϕ
                  ˙
                
              
            
            ∘
            
              ϕ
              
                −
                1
              
            
            ,
            
              ϕ
              
                0
              
            
            =
            i
            d
          
        
        C
        (
        ϕ
        )
        ≐
        
          
            1
            2
          
        
        
          ∫
          
            0
          
          
            1
          
        
        (
        A
        
          v
          
            t
          
        
        ∣
        
          v
          
            t
          
        
        )
        
        d
        t
        +
        
          ∑
          
            k
            =
            1
          
          
            K
          
        
        E
        (
        
          ϕ
          
            
              t
              
                k
              
            
          
        
        )
      
    
    {\displaystyle \min _{\phi :v={\dot {\phi }}\circ \phi ^{-1},\phi _{0}=id}C(\phi )\doteq {\frac {1}{2}}\int _{0}^{1}(Av_{t}\mid v_{t})\,dt+\sum _{k=1}^{K}E(\phi _{t_{k}})}
  .There have been at least three solutions offered thus far, piecewise geodesic, principal geodesic and splines.

The random orbit model of computational anatomy
The random orbit model  of computational anatomy first appeared in modelling the change in coordinates associated to the randomness of the group acting on the templates, which induces the randomness on the source of images in the anatomical orbit of shapes and forms and resulting observations through the medical imaging devices. Such a random orbit model in which randomness on the group induces randomness on the images was examined for the Special Euclidean Group for object recognition in.Depicted in the figure is a depiction of the random orbits around each exemplar, 
  
    
      
        
          m
          
            0
          
        
        ∈
        
          
            M
          
        
      
    
    {\displaystyle m_{0}\in {\mathcal {M}}}
  , generated by randomizing the flow by generating the initial tangent space vector field at the identity 
  
    
      
        
          v
          
            0
          
        
        ∈
        V
      
    
    {\displaystyle v_{0}\in V}
  , and then generating random object 
  
    
      
        n
        ≐
        E
        x
        
          p
          
            i
            d
          
        
        (
        
          v
          
            0
          
        
        )
        ⋅
        
          m
          
            0
          
        
        ∈
        
          
            M
          
        
      
    
    {\displaystyle n\doteq Exp_{id}(v_{0})\cdot m_{0}\in {\mathcal {M}}}
  .
The random orbit model induces the prior on shapes and images 
  
    
      
        I
        ∈
        
          
            I
          
        
      
    
    {\displaystyle I\in {\mathcal {I}}}
   conditioned on a particular atlas 
  
    
      
        
          I
          
            a
          
        
        ∈
        
          
            I
          
        
      
    
    {\displaystyle I_{a}\in {\mathcal {I}}}
  . For this the generative model generates the mean field 
  
    
      
        I
      
    
    {\displaystyle I}
   as a random change in coordinates of the template according to 
  
    
      
        I
        ≐
        ϕ
        ⋅
        
          I
          
            a
          
        
      
    
    {\displaystyle I\doteq \phi \cdot I_{a}}
  , where the diffeomorphic change in coordinates is generated randomly via the geodesic flows. The prior on random transformations 
  
    
      
        
          π
          
            D
            i
            f
            f
          
        
        (
        d
        ϕ
        )
      
    
    {\displaystyle \pi _{Diff}(d\phi )}
   on 
  
    
      
        D
        i
        f
        
          f
          
            V
          
        
      
    
    {\displaystyle Diff_{V}}
   is induced by the flow 
  
    
      
        E
        x
        
          p
          
            i
            d
          
        
        (
        v
        )
      
    
    {\displaystyle Exp_{id}(v)}
  , with 
  
    
      
        v
        ∈
        V
      
    
    {\displaystyle v\in V}
   constructed as a Gaussian random field prior 
  
    
      
        
          π
          
            V
          
        
        (
        d
        v
        )
      
    
    {\displaystyle \pi _{V}(dv)}
  . The density on the random observables at the output of the sensor 
  
    
      
        
          I
          
            D
          
        
        ∈
        
          
            
              I
            
          
          
            D
          
        
      
    
    {\displaystyle I^{D}\in {\mathcal {I}}^{D}}
   are given by

  
    
      
        p
        (
        
          I
          
            D
          
        
        
          |
        
        
          I
          
            a
          
        
        )
        =
        
          ∫
          
            V
          
        
        p
        (
        
          I
          
            D
          
        
        
          |
        
        E
        x
        
          p
          
            i
            d
          
        
        (
        v
        )
        ⋅
        
          I
          
            a
          
        
        )
        
          π
          
            V
          
        
        (
        d
        v
        )
         
        .
      
    
    {\displaystyle p(I^{D}|I_{a})=\int _{V}p(I^{D}|Exp_{id}(v)\cdot I_{a})\pi _{V}(dv)\ .}
  
Shown in the Figure on the right the cartoon orbit, are a random spray of the subcortical manifolds generated by randomizing the vector fields 
  
    
      
        
          v
          
            0
          
        
      
    
    {\displaystyle v_{0}}
   supported over the submanifolds.

The Bayesian model of computational anatomy
The central statistical model of computational anatomy in the context of medical imaging has been the source-channel model of Shannon theory; the source is the deformable template of images 
  
    
      
        I
        ∈
        
          
            I
          
        
      
    
    {\displaystyle I\in {\mathcal {I}}}
  , the channel outputs are the imaging sensors with observables 
  
    
      
        
          I
          
            D
          
        
        ∈
        
          
            
              I
            
          
          
            
              D
            
          
        
      
    
    {\displaystyle I^{D}\in {\mathcal {I}}^{\mathcal {D}}}
   (see Figure).
See The Bayesian model of computational anatomy for discussions (i) MAP estimation with multiple atlases, (ii)
MAP segmentation with multiple atlases, MAP estimation of templates from populations.

Statistical shape theory in computational anatomy
Shape in computational anatomy is a local theory, indexing shapes and structures to templates to which they are bijectively mapped. Statistical shape in computational anatomy is the empirical study of diffeomorphic correspondences between populations and common template coordinate systems.  This is a strong departure from Procrustes Analyses and shape theories pioneered by David G. Kendall in that the central group of Kendall's theories are the finite-dimensional Lie groups, whereas the theories of shape in computational anatomy have focused on the diffeomorphism group, which to first order via the Jacobian can be thought of as a field–thus infinite dimensional–of low-dimensional Lie groups of scale and rotations. 

The random orbit model provides the natural setting to understand empirical shape and shape statistics within computational anatomy since the non-linearity of the induced probability law on anatomical shapes and forms 
  
    
      
        m
        ∈
        
          
            M
          
        
      
    
    {\displaystyle m\in {\mathcal {M}}}
   is induced via the reduction to the vector fields 
  
    
      
        
          v
          
            0
          
        
        ∈
        V
      
    
    {\displaystyle v_{0}\in V}
   at the tangent space at the identity of the diffeomorphism group. The successive flow of the Euler equation induces the random space of shapes and forms 
  
    
      
        E
        x
        
          p
          
            i
            d
          
        
        (
        
          v
          
            0
          
        
        )
        ⋅
        m
        ∈
        
          
            M
          
        
      
    
    {\displaystyle Exp_{id}(v_{0})\cdot m\in {\mathcal {M}}}
  .
Performing empirical statistics on this tangent space at the identity is the natural way for inducing probability laws on the statistics of shape. Since both the vector fields and the Eulerian momentum 
  
    
      
        A
        
          v
          
            0
          
        
      
    
    {\displaystyle Av_{0}}
   are in a Hilbert space the natural model is one of a Gaussian random field, so that given test function 
  
    
      
        w
        ∈
        V
      
    
    {\displaystyle w\in V}
  , then the inner-products with the test functions are Gaussian distributed with mean and covariance.
This is depicted in the accompanying figure where sub-cortical brain structures are depicted in a two-dimensional coordinate system based on inner products of their initial vector fields that generate them from the template is shown in a 2-dimensional span of the Hilbert space.

Template estimation from populations
The study of shape and statistics in populations are local theories, indexing shapes and structures to templates to which they are bijectively mapped. Statistical shape is then the study of diffeomorphic correspondences relative to the template. A core operation is the generation of templates from populations, estimating a shape that is matched to the population. There are several important methods for generating templates including methods based on Frechet averaging, and statistical approaches based on the expectation-maximization algorithm and the Bayes Random orbit models of computational anatomy. Shown in the accompanying figure is a subcortical template reconstruction from the population of MRI subjects.

Software for diffeomorphic mapping
Software suites containing a variety of diffeomorphic mapping algorithms include the following:

ANTS
DARTEL Voxel-based morphometry
DEFORMETRICA
DEMONS
LDDMM Large deformation diffeomorphic metric mapping
LDDMM based on frame-based kernel 
StationaryLDDMM

Cloud software
MRICloud

See also
Bayesian estimation of templates in computational anatomy
Computational neuroanatomy
Geometric data analysis
Large deformation diffeomorphic metric mapping
Procrustes analysis
Riemannian metric and Lie-bracket in computational anatomy
Shape analysis (disambiguation)
Statistical shape analysis

References

{{|}}