The lattice Boltzmann methods (LBM), originated from the lattice gas automata (LGA) method (Hardy-Pomeau-Pazzis and Frisch-Hasslacher-Pomeau models), is a class of computational fluid dynamics (CFD) methods for fluid simulation. Instead of solving the Navier–Stokes equations directly, a fluid density on a lattice is simulated with streaming and collision (relaxation) processes. The method is versatile as the model fluid can straightforwardly be made to mimic common fluid behaviour like vapour/liquid coexistence, and so fluid systems such as liquid droplets can be simulated. Also, fluids in complex environments such as porous media can be straightforwardly simulated, whereas with complex boundaries other CFD methods can be hard to work with.

Algorithm
Unlike CFD methods that solve the conservation equations of macroscopic properties (i.e., mass, momentum, and energy) numerically, LBM models the fluid consisting of fictive particles, and such particles perform consecutive propagation and collision processes over a discrete lattice. Due to its particulate nature and local dynamics, LBM has several advantages over other conventional CFD methods, especially in dealing with complex boundaries, incorporating microscopic interactions, and parallelization of the algorithm. A different interpretation of the lattice Boltzmann equation is that of a discrete-velocity Boltzmann equation. The numerical methods of solution of the system of partial differential equations then give rise to a discrete map, which can be interpreted as the propagation and collision of fictitious particles. In an algorithm, there are collision and streaming steps. These evolve the density of the fluid 
  
    
      
        ρ
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
      
    
    {\displaystyle \rho ({\vec {x}},t)}
  , for 
  
    
      
        
          
            
              x
              →
            
          
        
      
    
    {\displaystyle {\vec {x}}}
   the position and 
  
    
      
        t
      
    
    {\displaystyle t}
   the time. As the fluid is on a lattice, the density has a number of components 
  
    
      
        
          f
          
            i
          
        
        ,
        i
        =
        0
        ,
        …
        ,
        a
      
    
    {\displaystyle f_{i},i=0,\ldots ,a}
   equal to the number of lattice vectors connected to each lattice point. As an example, the lattice vectors for a simple lattice used in simulations in two dimensions is shown here. This lattice is usually denoted D2Q9, for two dimensions and nine vectors: four vectors along north, east, south and west, plus four vectors to the corners of a unit square, plus a vector with both components zero. Then, for example vector 
  
    
      
        
          
            
              
                e
                →
              
            
          
          
            4
          
        
        =
        (
        0
        ,
        −
        1
        )
      
    
    {\displaystyle {\vec {e}}_{4}=(0,-1)}
  , i.e., it points due south and so has no 
  
    
      
        x
      
    
    {\displaystyle x}
   component but a 
  
    
      
        y
      
    
    {\displaystyle y}
   component of 
  
    
      
        −
        1
      
    
    {\displaystyle -1}
  . So one of the nine components of the total density at the central lattice point, 
  
    
      
        
          f
          
            4
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
      
    
    {\displaystyle f_{4}({\vec {x}},t)}
  , is that part of the fluid at point 
  
    
      
        
          
            
              x
              →
            
          
        
      
    
    {\displaystyle {\vec {x}}}
   moving due south, at a speed in lattice units of one. 
Then the steps that evolve the fluid in time are:
The collision step

  
    
      
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        +
        
          δ
          
            t
          
        
        )
        =
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
        +
        
          
            
              
                f
                
                  i
                
                
                  e
                  q
                
              
              (
              
                
                  
                    x
                    →
                  
                
              
              ,
              t
              )
              −
              
                f
                
                  i
                
              
              (
              
                
                  
                    x
                    →
                  
                
              
              ,
              t
              )
            
            
              τ
              
                f
              
            
          
        
        
        
      
    
    {\displaystyle f_{i}({\vec {x}},t+\delta _{t})=f_{i}({\vec {x}},t)+{\frac {f_{i}^{eq}({\vec {x}},t)-f_{i}({\vec {x}},t)}{\tau _{f}}}\,\!}
  
which is the Bhatnagar Gross and Krook (BGK) model for relaxation to equilibrium via collisions between the molecules of a fluid. 
  
    
      
        
          f
          
            i
          
          
            e
            q
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
      
    
    {\displaystyle f_{i}^{eq}({\vec {x}},t)}
   is the equilibrium density along direction i at the current density there. The model assumes that the fluid locally relaxes to equilibrium over a characteristic timescale 
  
    
      
        
          τ
          
            f
          
        
      
    
    {\displaystyle \tau _{f}}
  . This timescale determines the kinematic viscosity, the larger it is, the larger is the kinematic viscosity.
The streaming step

  
    
      
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
        t
        +
        
          δ
          
            t
          
        
        )
        =
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
        
        
      
    
    {\displaystyle f_{i}({\vec {x}}+{\vec {e}}_{i},t+\delta _{t})=f_{i}({\vec {x}},t)\,\!}
  
As 
  
    
      
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
      
    
    {\displaystyle f_{i}({\vec {x}},t)}
   is, by definition, the fluid density at point 
  
    
      
        
          
            
              x
              →
            
          
        
      
    
    {\displaystyle {\vec {x}}}
   at time 
  
    
      
        t
      
    
    {\displaystyle t}
  , that is moving at a velocity of 
  
    
      
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
      
    
    {\displaystyle {\vec {e}}_{i}}
   per time step, then at the next time step 
  
    
      
        t
        +
        
          δ
          
            t
          
        
      
    
    {\displaystyle t+\delta _{t}}
   it will have flowed to point 
  
    
      
        
          
            
              x
              →
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
      
    
    {\displaystyle {\vec {x}}+{\vec {e}}_{i}}
  .

Advantages
The LBM was designed from scratch to run efficiently on massively parallel architectures, ranging from inexpensive embedded FPGAs and DSPs up to GPUs and heterogeneous clusters and supercomputers (even with a slow interconnection network). It enables complex physics and sophisticated algorithms. Efficiency leads to a qualitatively new level of understanding since it allows solving problems that previously could not be approached (or only with insufficient accuracy).
The method originates from a molecular description of a fluid and can directly incorporate physical terms stemming from a knowledge of the interaction between molecules. Hence it is an indispensable instrument in fundamental research, as it keeps the cycle between the elaboration of a theory and the formulation of a corresponding numerical model short.
Automated data pre-processing and lattice generation in a time that accounts for a small fraction of the total simulation.
Parallel data analysis, post-processing and evaluation.
Fully resolved multi-phase flow with small droplets and bubbles.
Fully resolved flow through complex geometries and porous media.
Complex, coupled flow with heat transfer and chemical reactions.

Limitations
Despite the increasing popularity of LBM in simulating complex fluid systems, this novel approach has some limitations. At present, high-Mach number flows in aerodynamics are still difficult for LBM, and a consistent thermo-hydrodynamic scheme is absent. However, as with Navier–Stokes based CFD, LBM methods have been successfully coupled with thermal-specific solutions to enable heat transfer (solids-based conduction, convection and radiation) simulation capability.  For multiphase/multicomponent models, the interface thickness is usually large and the density ratio across the interface is small when compared with real fluids.  Recently this problem has been resolved by Yuan and Schaefer who improved on models by Shan and Chen, Swift, and He, Chen, and Zhang.  They were able to reach density ratios of 1000:1 by simply changing the equation of state. It has been proposed to apply Galilean Transformation to overcome the limitation of modelling high-speed fluid flows.
Nevertheless, the wide applications and fast advancements of this method during the past twenty years have proven its potential in computational physics, including microfluidics:  LBM demonstrates promising results in the area of high Knudsen number flows.

Development from the LGA method
LBM originated from the lattice gas automata (LGA) method, which can be considered as a simplified fictitious molecular dynamics model in which space, time, and particle velocities are all discrete. For example, in the 2-dimensional FHP Model each lattice node is connected to its neighbors by 6 lattice velocities on a triangular lattice; there can be either 0 or 1 particles at a lattice node moving with a given lattice velocity. After a time interval, each particle will move to the neighboring node in its direction; this process is called the propagation or streaming step. When more than one particle arrives at the same node from different directions, they collide and change their velocities according to a set of collision rules. Streaming steps and collision steps alternate.  Suitable collision rules should conserve the particle number (mass), momentum, and energy before and after the collision.  LGA suffer from several innate defects for use in hydrodynamic simulations: lack of Galilean invariance for fast flows, statistical noise and poor Reynolds number scaling with lattice size.  LGA are, however, well suited to simplify and extend the reach of reaction diffusion and molecular dynamics models.
The main motivation for the transition from LGA to LBM was the desire to remove the statistical noise by replacing the Boolean particle number in a lattice direction with its ensemble average, the so-called density distribution function. Accompanying this replacement, the discrete collision rule is also replaced by a continuous function known as the collision operator. In the LBM development, an important simplification is to approximate the collision operator with the Bhatnagar-Gross-Krook (BGK) relaxation term. This lattice BGK (LBGK) model makes simulations more efficient and allows flexibility of the transport coefficients. On the other hand, it has been shown that the LBM scheme can also be considered as a special discretized form of the continuous Boltzmann equation. From Chapman-Enskog theory, one can recover the governing continuity and Navier–Stokes equations from the LBM algorithm.

Lattices and the DnQm classification
Lattice Boltzmann models can be operated on a number of different lattices, both cubic and triangular, and with or without rest particles in the discrete distribution function.
A popular way of classifying the different methods by lattice is the DnQm scheme. Here "Dn" stands for "n dimensions", while "Qm" stands for "m speeds". For example, D3Q15 is a 3-dimensional lattice Boltzmann model on a cubic grid, with rest particles present. Each node has a crystal shape and can deliver particles to 15 nodes: each of the 6 neighboring nodes that share a surface, the 8 neighboring nodes sharing a corner, and itself. (The D3Q15 model does not contain particles moving to the 12 neighboring nodes that share an edge; adding those would create a "D3Q27" model.)
Real quantities as space and time need to be converted to lattice units prior to simulation. Nondimensional quantities, like the Reynolds number, remain the same.

Lattice units conversion
In most Lattice Boltzmann simulations 
  
    
      
        
          δ
          
            x
          
        
        
        
      
    
    {\displaystyle \delta _{x}\,\!}
   is the basic unit for lattice spacing, so if the domain of length 
  
    
      
        L
        
        
      
    
    {\displaystyle L\,\!}
   has 
  
    
      
        N
        
        
      
    
    {\displaystyle N\,\!}
   lattice units along its entire length, the space unit is simply defined as 
  
    
      
        
          δ
          
            x
          
        
        =
        L
        
          /
        
        N
        
        
      
    
    {\displaystyle \delta _{x}=L/N\,\!}
  . Speeds in lattice Boltzmann simulations are typically given in terms of the speed of sound. The discrete time unit can therefore be given as 
  
    
      
        
          δ
          
            t
          
        
        =
        
          
            
              δ
              
                x
              
            
            
              C
              
                s
              
            
          
        
        
        
      
    
    {\displaystyle \delta _{t}={\frac {\delta _{x}}{C_{s}}}\,\!}
  , where the denominator 
  
    
      
        
          C
          
            s
          
        
      
    
    {\displaystyle C_{s}}
   is the physical speed of sound.For small-scale flows (such as those seen in porous media mechanics), operating with the true speed of sound can lead to unacceptably short time steps. It is therefore common to raise the lattice Mach number to something much larger than the real Mach number, and compensating for this by raising the viscosity as well in order to preserve the Reynolds number.

Simulation of mixtures
Simulating multiphase/multicomponent flows has always been a challenge to conventional CFD because of the moving and deformable interfaces. More fundamentally, the interfaces between different phases (liquid and vapor) or components (e.g., oil and water) originate from the specific interactions among fluid molecules. Therefore, it is difficult to implement such microscopic interactions into the macroscopic Navier–Stokes equation. However, in LBM, the particulate kinetics provides a relatively easy and consistent way to incorporate the underlying microscopic interactions by modifying the collision operator. Several LBM multiphase/multicomponent models have been developed. Here phase separations are generated automatically from the particle dynamics and no special treatment is needed to manipulate the interfaces as in traditional CFD methods. Successful applications of multiphase/multicomponent LBM models can be found in various complex fluid systems, including interface instability, bubble/droplet dynamics, wetting on solid surfaces, interfacial slip, and droplet electrohydrodynamic deformations.
A lattice Boltzmann model for simulation of gas mixture combustion capable of accommodating significant density variations at low-Mach number regime has been recently proposed.To this respect, it is worth to notice that, since LBM deals with a larger set of fields (as compared to conventional CFD), the simulation of reactive gas mixtures presents some additional challenges in terms of memory demand as far as large detailed combustion mechanisms are concerned. Those issues may be addressed, though, by resorting to systematic model reduction techniques.

Thermal lattice-Boltzmann method
Currently (2009), a thermal lattice-Boltzmann method (TLBM) falls into one of three categories: the multi-speed approach, the passive scalar approach, and the thermal energy distribution.

Derivation of Navier–Stokes equation from discrete LBE
Starting with the discrete lattice Boltzmann equation (also referred to as LBGK equation due to the collision operator used).  We first do a 2nd-order Taylor series expansion about the left side of the LBE.  This is chosen over a simpler 1st-order Taylor expansion as the discrete LBE cannot be recovered.  When doing the 2nd-order Taylor series expansion, the zero derivative term and the first term on the right will cancel, leaving only the first and second derivative terms of the Taylor expansion and the collision operator:

  
    
      
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
          δ
          
            t
          
        
        ,
        t
        +
        
          δ
          
            t
          
        
        )
        =
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
        +
        
          
            
              δ
              
                t
              
            
            
              τ
              
                f
              
            
          
        
        (
        
          f
          
            i
          
          
            e
            q
          
        
        −
        
          f
          
            i
          
        
        )
        .
      
    
    {\displaystyle f_{i}({\vec {x}}+{\vec {e}}_{i}\delta _{t},t+\delta _{t})=f_{i}({\vec {x}},t)+{\frac {\delta _{t}}{\tau _{f}}}(f_{i}^{eq}-f_{i}).}
  For simplicity, write 
  
    
      
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
      
    
    {\displaystyle f_{i}({\vec {x}},t)}
   as 
  
    
      
        
          f
          
            i
          
        
      
    
    {\displaystyle f_{i}}
  .  The slightly simplified Taylor series expansion is then as follows, where ":" is the colon product between dyads:

  
    
      
        
          
            
              ∂
              
                f
                
                  i
                
              
            
            
              ∂
              t
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ⋅
        ∇
        
          f
          
            i
          
        
        +
        
          (
          
            
              
                1
                2
              
            
            
              
                
                  
                    e
                    →
                  
                
              
              
                i
              
            
            
              
                
                  
                    e
                    →
                  
                
              
              
                i
              
            
            :
            ∇
            ∇
            
              f
              
                i
              
            
            +
            
              
                
                  
                    e
                    →
                  
                
              
              
                i
              
            
            ⋅
            ∇
            
              
                
                  ∂
                  
                    f
                    
                      i
                    
                  
                
                
                  ∂
                  t
                
              
            
            +
            
              
                1
                2
              
            
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  
                    f
                    
                      i
                    
                  
                
                
                  ∂
                  
                    t
                    
                      2
                    
                  
                
              
            
          
          )
        
        =
        
          
            1
            τ
          
        
        (
        
          f
          
            i
          
          
            e
            q
          
        
        −
        
          f
          
            i
          
        
        )
        .
      
    
    {\displaystyle {\frac {\partial f_{i}}{\partial t}}+{\vec {e}}_{i}\cdot \nabla f_{i}+\left({\frac {1}{2}}{\vec {e}}_{i}{\vec {e}}_{i}:\nabla \nabla f_{i}+{\vec {e}}_{i}\cdot \nabla {\frac {\partial f_{i}}{\partial t}}+{\frac {1}{2}}{\frac {\partial ^{2}f_{i}}{\partial t^{2}}}\right)={\frac {1}{\tau }}(f_{i}^{eq}-f_{i}).}
  By expanding the particle distribution function into equilibrium and non-equilibrium components and using the Chapman-Enskog expansion, where 
  
    
      
        K
      
    
    {\displaystyle K}
   is the Knudsen number, the Taylor-expanded LBE can be decomposed into different magnitudes of order for the Knudsen number in order to obtain the proper continuum equations:

  
    
      
        
          f
          
            i
          
        
        =
        
          f
          
            i
          
          
            eq
          
        
        +
        K
        
          f
          
            i
          
          
            neq
          
        
        ,
      
    
    {\displaystyle f_{i}=f_{i}^{\text{eq}}+Kf_{i}^{\text{neq}},}
  

  
    
      
        
          f
          
            i
          
          
            neq
          
        
        =
        
          f
          
            i
          
          
            (
            1
            )
          
        
        +
        K
        
          f
          
            i
          
          
            (
            2
            )
          
        
        +
        O
        (
        
          K
          
            2
          
        
        )
        .
      
    
    {\displaystyle f_{i}^{\text{neq}}=f_{i}^{(1)}+Kf_{i}^{(2)}+O(K^{2}).}
  The equilibrium and non-equilibrium distributions satisfy the following relations to their macroscopic variables (these will be used later, once the particle distributions are in the "correct form" in order to scale from the particle to macroscopic level):

  
    
      
        ρ
        =
        
          ∑
          
            i
          
        
        
          f
          
            i
          
          
            eq
          
        
        ,
      
    
    {\displaystyle \rho =\sum _{i}f_{i}^{\text{eq}},}
  

  
    
      
        ρ
        
          
            
              u
              →
            
          
        
        =
        
          ∑
          
            i
          
        
        
          f
          
            i
          
          
            eq
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
      
    
    {\displaystyle \rho {\vec {u}}=\sum _{i}f_{i}^{\text{eq}}{\vec {e}}_{i},}
  

  
    
      
        0
        =
        
          ∑
          
            i
          
        
        
          f
          
            i
          
          
            (
            k
            )
          
        
        
        
          for 
        
        k
        =
        1
        ,
        2
        ,
      
    
    {\displaystyle 0=\sum _{i}f_{i}^{(k)}\qquad {\text{for }}k=1,2,}
  

  
    
      
        0
        =
        
          ∑
          
            i
          
        
        
          f
          
            i
          
          
            (
            k
            )
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        .
      
    
    {\displaystyle 0=\sum _{i}f_{i}^{(k)}{\vec {e}}_{i}.}
  The Chapman-Enskog expansion is then:

  
    
      
        
          
            ∂
            
              ∂
              t
            
          
        
        =
        K
        
          
            ∂
            
              ∂
              
                t
                
                  1
                
              
            
          
        
        +
        
          K
          
            2
          
        
        
          
            ∂
            
              ∂
              
                t
                
                  2
                
              
            
          
        
        
        
          for 
        
        
          t
          
            2
          
        
        (
        
          diffusive time-scale
        
        )
        ≪
        
          t
          
            1
          
        
        (
        
          convective time-scale
        
        )
        ,
      
    
    {\displaystyle {\frac {\partial }{\partial t}}=K{\frac {\partial }{\partial t_{1}}}+K^{2}{\frac {\partial }{\partial t_{2}}}\qquad {\text{for }}t_{2}({\text{diffusive time-scale}})\ll t_{1}({\text{convective time-scale}}),}
  

  
    
      
        
          
            ∂
            
              ∂
              x
            
          
        
        =
        K
        
          
            ∂
            
              ∂
              
                x
                
                  1
                
              
            
          
        
        .
      
    
    {\displaystyle {\frac {\partial }{\partial x}}=K{\frac {\partial }{\partial x_{1}}}.}
  By substituting the expanded equilibrium and non-equilibrium into the Taylor expansion and separating into different orders of 
  
    
      
        K
      
    
    {\displaystyle K}
  , the continuum equations are nearly derived.
For order 
  
    
      
        
          K
          
            0
          
        
      
    
    {\displaystyle K^{0}}
  :

  
    
      
        
          
            
              ∂
              
                f
                
                  i
                
                
                  eq
                
              
            
            
              ∂
              
                t
                
                  1
                
              
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
          ∇
          
            1
          
        
        
          f
          
            i
          
          
            eq
          
        
        =
        −
        
          
            
              f
              
                i
              
              
                (
                1
                )
              
            
            τ
          
        
        .
      
    
    {\displaystyle {\frac {\partial f_{i}^{\text{eq}}}{\partial t_{1}}}+{\vec {e}}_{i}\nabla _{1}f_{i}^{\text{eq}}=-{\frac {f_{i}^{(1)}}{\tau }}.}
  For order 
  
    
      
        
          K
          
            1
          
        
      
    
    {\displaystyle K^{1}}
  :

  
    
      
        
          
            
              ∂
              
                f
                
                  i
                
                
                  (
                  1
                  )
                
              
            
            
              ∂
              
                t
                
                  1
                
              
            
          
        
        +
        
          
            
              ∂
              
                f
                
                  i
                
                
                  eq
                
              
            
            
              ∂
              
                t
                
                  2
                
              
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ∇
        
          f
          
            i
          
          
            (
            1
            )
          
        
        +
        
          
            1
            2
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        :
        ∇
        ∇
        
          f
          
            i
          
          
            eq
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ⋅
        ∇
        
          
            
              ∂
              
                f
                
                  i
                
                
                  eq
                
              
            
            
              ∂
              
                t
                
                  1
                
              
            
          
        
        +
        
          
            1
            2
          
        
        
          
            
              
                ∂
                
                  2
                
              
              
                f
                
                  i
                
                
                  eq
                
              
            
            
              ∂
              
                t
                
                  1
                
                
                  2
                
              
            
          
        
        =
        −
        
          
            
              f
              
                i
              
              
                (
                2
                )
              
            
            τ
          
        
        .
      
    
    {\displaystyle {\frac {\partial f_{i}^{(1)}}{\partial t_{1}}}+{\frac {\partial f_{i}^{\text{eq}}}{\partial t_{2}}}+{\vec {e}}_{i}\nabla f_{i}^{(1)}+{\frac {1}{2}}{\vec {e}}_{i}{\vec {e}}_{i}:\nabla \nabla f_{i}^{\text{eq}}+{\vec {e}}_{i}\cdot \nabla {\frac {\partial f_{i}^{\text{eq}}}{\partial t_{1}}}+{\frac {1}{2}}{\frac {\partial ^{2}f_{i}^{\text{eq}}}{\partial t_{1}^{2}}}=-{\frac {f_{i}^{(2)}}{\tau }}.}
  Then, the second equation can be simplified with some algebra and the first equation into the following:

  
    
      
        
          
            
              ∂
              
                f
                
                  i
                
                
                  eq
                
              
            
            
              ∂
              
                t
                
                  2
                
              
            
          
        
        +
        
          (
          
            1
            −
            
              
                1
                
                  2
                  τ
                
              
            
          
          )
        
        
          [
          
            
              
                
                  ∂
                  
                    f
                    
                      i
                    
                    
                      (
                      1
                      )
                    
                  
                
                
                  ∂
                  
                    t
                    
                      1
                    
                  
                
              
            
            +
            
              
                
                  
                    e
                    →
                  
                
              
              
                i
              
            
            
              ∇
              
                1
              
            
            
              f
              
                i
              
              
                (
                1
                )
              
            
          
          ]
        
        =
        −
        
          
            
              f
              
                i
              
              
                (
                2
                )
              
            
            τ
          
        
        .
      
    
    {\displaystyle {\frac {\partial f_{i}^{\text{eq}}}{\partial t_{2}}}+\left(1-{\frac {1}{2\tau }}\right)\left[{\frac {\partial f_{i}^{(1)}}{\partial t_{1}}}+{\vec {e}}_{i}\nabla _{1}f_{i}^{(1)}\right]=-{\frac {f_{i}^{(2)}}{\tau }}.}
  Applying the relations between the particle distribution functions and the macroscopic properties from above, the mass and momentum equations are achieved:

  
    
      
        
          
            
              ∂
              ρ
            
            
              ∂
              t
            
          
        
        +
        ∇
        ⋅
        ρ
        
          
            
              u
              →
            
          
        
        =
        0
        ,
      
    
    {\displaystyle {\frac {\partial \rho }{\partial t}}+\nabla \cdot \rho {\vec {u}}=0,}
  
  
    
      
        
          
            
              ∂
              ρ
              
                
                  
                    u
                    →
                  
                
              
            
            
              ∂
              t
            
          
        
        +
        ∇
        ⋅
        Π
        =
        0.
      
    
    {\displaystyle {\frac {\partial \rho {\vec {u}}}{\partial t}}+\nabla \cdot \Pi =0.}
  The momentum flux tensor 
  
    
      
        Π
      
    
    {\displaystyle \Pi }
   has the following form then:

  
    
      
        
          Π
          
            x
            y
          
        
        =
        
          ∑
          
            i
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
            x
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
            y
          
        
        
          [
          
            
              f
              
                i
              
              
                e
                q
              
            
            +
            
              (
              
                1
                −
                
                  
                    1
                    
                      2
                      τ
                    
                  
                
              
              )
            
            
              f
              
                i
              
              
                (
                1
                )
              
            
          
          ]
        
        ,
      
    
    {\displaystyle \Pi _{xy}=\sum _{i}{\vec {e}}_{ix}{\vec {e}}_{iy}\left[f_{i}^{eq}+\left(1-{\frac {1}{2\tau }}\right)f_{i}^{(1)}\right],}
  where 
  
    
      
        
          
            
              
                e
                →
              
            
          
          
            i
            x
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
            y
          
        
      
    
    {\displaystyle {\vec {e}}_{ix}{\vec {e}}_{iy}}
   is shorthand for the square of the sum of all the components of 
  
    
      
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
      
    
    {\displaystyle {\vec {e}}_{i}}
   (i. e. 
  
    
      
        
          
            
              (
              
                
                  ∑
                  
                    x
                  
                
                
                  
                    
                      
                        e
                        →
                      
                    
                  
                  
                    i
                    x
                  
                
              
              )
            
            
              2
            
          
          =
          
            ∑
            
              x
            
          
          
            ∑
            
              y
            
          
          
            
              
                
                  e
                  →
                
              
            
            
              i
              x
            
          
          
            
              
                
                  e
                  →
                
              
            
            
              i
              y
            
          
        
      
    
    {\displaystyle \textstyle \left(\sum _{x}{\vec {e}}_{ix}\right)^{2}=\sum _{x}\sum _{y}{\vec {e}}_{ix}{\vec {e}}_{iy}}
  ), and the equilibrium particle distribution with second order to be comparable to the Navier–Stokes equation is:

  
    
      
        
          f
          
            i
          
          
            eq
          
        
        =
        
          ω
          
            i
          
        
        ρ
        
          (
          
            1
            +
            
              
                
                  
                    
                      
                        
                          e
                          →
                        
                      
                    
                    
                      i
                    
                  
                  
                    
                      
                        u
                        →
                      
                    
                  
                
                
                  c
                  
                    s
                  
                  
                    2
                  
                
              
            
            +
            
              
                
                  (
                  
                    
                      
                        
                          e
                          →
                        
                      
                    
                    
                      i
                    
                  
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  
                    c
                    
                      s
                    
                    
                      4
                    
                  
                
              
            
            −
            
              
                
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    2
                  
                
                
                  2
                  
                    c
                    
                      s
                    
                    
                      2
                    
                  
                
              
            
          
          )
        
        .
      
    
    {\displaystyle f_{i}^{\text{eq}}=\omega _{i}\rho \left(1+{\frac {{\vec {e}}_{i}{\vec {u}}}{c_{s}^{2}}}+{\frac {({\vec {e}}_{i}{\vec {u}})^{2}}{2c_{s}^{4}}}-{\frac {{\vec {u}}^{2}}{2c_{s}^{2}}}\right).}
  The equilibrium distribution is only valid for small velocities or small Mach numbers.  Inserting the equilibrium distribution back into the flux tensor leads to:

  
    
      
        
          Π
          
            x
            y
          
          
            (
            0
            )
          
        
        =
        
          ∑
          
            i
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
            x
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
            y
          
        
        
          f
          
            i
          
          
            e
            q
          
        
        =
        p
        
          δ
          
            x
            y
          
        
        +
        ρ
        
          u
          
            x
          
        
        
          u
          
            y
          
        
        ,
      
    
    {\displaystyle \Pi _{xy}^{(0)}=\sum _{i}{\vec {e}}_{ix}{\vec {e}}_{iy}f_{i}^{eq}=p\delta _{xy}+\rho u_{x}u_{y},}
  

  
    
      
        
          Π
          
            x
            y
          
          
            (
            1
            )
          
        
        =
        
          (
          
            1
            −
            
              
                1
                
                  2
                  τ
                
              
            
          
          )
        
        
          ∑
          
            i
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
            x
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
            y
          
        
        
          f
          
            i
          
          
            (
            1
            )
          
        
        =
        ν
        
          (
          
            
              ∇
              
                x
              
            
            
              (
              
                ρ
                
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    y
                  
                
              
              )
            
            +
            
              ∇
              
                y
              
            
            
              (
              
                ρ
                
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    x
                  
                
              
              )
            
          
          )
        
        .
      
    
    {\displaystyle \Pi _{xy}^{(1)}=\left(1-{\frac {1}{2\tau }}\right)\sum _{i}{\vec {e}}_{ix}{\vec {e}}_{iy}f_{i}^{(1)}=\nu \left(\nabla _{x}\left(\rho {\vec {u}}_{y}\right)+\nabla _{y}\left(\rho {\vec {u}}_{x}\right)\right).}
  Finally, the Navier–Stokes equation is recovered under the assumption that density variation is small:

  
    
      
        ρ
        
          (
          
            
              
                
                  ∂
                  
                    
                      
                        
                          u
                          →
                        
                      
                    
                    
                      x
                    
                  
                
                
                  ∂
                  t
                
              
            
            +
            
              ∇
              
                y
              
            
            ⋅
            
              
                
                  
                    u
                    →
                  
                
              
              
                x
              
            
            
              
                
                  
                    u
                    →
                  
                
              
              
                y
              
            
          
          )
        
        =
        −
        
          ∇
          
            x
          
        
        p
        +
        ν
        
          ∇
          
            y
          
        
        ⋅
        
          (
          
            
              ∇
              
                x
              
            
            
              (
              
                ρ
                
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    y
                  
                
              
              )
            
            +
            
              ∇
              
                y
              
            
            
              (
              
                ρ
                
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    x
                  
                
              
              )
            
          
          )
        
        .
      
    
    {\displaystyle \rho \left({\frac {\partial {\vec {u}}_{x}}{\partial t}}+\nabla _{y}\cdot {\vec {u}}_{x}{\vec {u}}_{y}\right)=-\nabla _{x}p+\nu \nabla _{y}\cdot \left(\nabla _{x}\left(\rho {\vec {u}}_{y}\right)+\nabla _{y}\left(\rho {\vec {u}}_{x}\right)\right).}
  This derivation follows the work of Chen and Doolen.

Mathematical equations for simulations
The continuous Boltzmann equation is an evolution equation for a single particle probability distribution function 
  
    
      
        f
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
        t
        )
      
    
    {\displaystyle f({\vec {x}},{\vec {e}}_{i},t)}
   and the internal energy density distribution function 
  
    
      
        g
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
        t
        )
      
    
    {\displaystyle g({\vec {x}},{\vec {e}}_{i},t)}
   (He et al.) are each respectively:

  
    
      
        
          ∂
          
            t
          
        
        f
        +
        (
        
          
            
              e
              →
            
          
        
        ⋅
        ∇
        )
        f
        +
        F
        
          ∂
          
            v
          
        
        f
        =
        Ω
        (
        f
        )
        ,
      
    
    {\displaystyle \partial _{t}f+({\vec {e}}\cdot \nabla )f+F\partial _{v}f=\Omega (f),}
  

  
    
      
        
          ∂
          
            t
          
        
        g
        +
        (
        
          
            
              e
              →
            
          
        
        ⋅
        ∇
        )
        g
        +
        G
        
          ∂
          
            v
          
        
        f
        =
        Ω
        (
        g
        )
        ,
      
    
    {\displaystyle \partial _{t}g+({\vec {e}}\cdot \nabla )g+G\partial _{v}f=\Omega (g),}
  where 
  
    
      
        g
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
        t
        )
      
    
    {\displaystyle g({\vec {x}},{\vec {e}}_{i},t)}
   is related to 
  
    
      
        f
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
        t
        )
      
    
    {\displaystyle f({\vec {x}},{\vec {e}}_{i},t)}
   by

  
    
      
        g
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
        t
        )
        =
        
          
            
              (
              
                
                  
                    e
                    →
                  
                
              
              −
              
                
                  
                    u
                    →
                  
                
              
              
                )
                
                  2
                
              
            
            2
          
        
        f
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        ,
        t
        )
        ,
      
    
    {\displaystyle g({\vec {x}},{\vec {e}}_{i},t)={\frac {({\vec {e}}-{\vec {u}})^{2}}{2}}f({\vec {x}},{\vec {e}}_{i},t),}
  
  
    
      
        F
      
    
    {\displaystyle F}
   is an external force, 
  
    
      
        Ω
      
    
    {\displaystyle \Omega }
   is a collision integral, and 
  
    
      
        
          
            
              e
              →
            
          
        
      
    
    {\displaystyle {\vec {e}}}
   (also labeled by 
  
    
      
        
          
            
              ξ
              →
            
          
        
      
    
    {\displaystyle {\vec {\xi }}}
   in literature) is the microscopic velocity.  The external force 
  
    
      
        F
      
    
    {\displaystyle F}
   is related to temperature external force 
  
    
      
        G
      
    
    {\displaystyle G}
   by the relation below.  A typical test for one's model is the Rayleigh–Bénard convection for 
  
    
      
        G
      
    
    {\displaystyle G}
  .

  
    
      
        F
        =
        
          
            
              
                
                  
                    G
                    →
                  
                
              
              ⋅
              (
              
                
                  
                    e
                    →
                  
                
              
              −
              
                
                  
                    u
                    →
                  
                
              
              )
            
            
              R
              T
            
          
        
        
          f
          
            eq
          
        
        ,
      
    
    {\displaystyle F={\frac {{\vec {G}}\cdot ({\vec {e}}-{\vec {u}})}{RT}}f^{\text{eq}},}
  

  
    
      
        
          
            
              G
              →
            
          
        
        =
        β
        
          g
          
            0
          
        
        (
        T
        −
        
          T
          
            a
            v
            g
          
        
        )
        
          
            
              k
              →
            
          
        
        .
      
    
    {\displaystyle {\vec {G}}=\beta g_{0}(T-T_{avg}){\vec {k}}.}
  Macroscopic variables such as density 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
  , velocity 
  
    
      
        
          
            
              u
              →
            
          
        
      
    
    {\displaystyle {\vec {u}}}
  , and temperature 
  
    
      
        T
      
    
    {\displaystyle T}
   can be calculated as the moments of the density distribution function:

  
    
      
        ρ
        =
        ∫
        f
        
        d
        
          
            
              e
              →
            
          
        
        ,
      
    
    {\displaystyle \rho =\int f\,d{\vec {e}},}
  

  
    
      
        ρ
        
          
            
              u
              →
            
          
        
        =
        ∫
        
          
            
              e
              →
            
          
        
        f
        
        d
        
          
            
              e
              →
            
          
        
        ,
      
    
    {\displaystyle \rho {\vec {u}}=\int {\vec {e}}f\,d{\vec {e}},}
  

  
    
      
        
          
            
              ρ
              D
              R
              T
            
            2
          
        
        =
        ρ
        ϵ
        =
        ∫
        g
        
        d
        
          
            
              e
              →
            
          
        
        .
      
    
    {\displaystyle {\frac {\rho DRT}{2}}=\rho \epsilon =\int g\,d{\vec {e}}.}
  The lattice Boltzmann method discretizes this equation by limiting space to a lattice and the velocity space to a discrete set of microscopic velocities (i. e. 
  
    
      
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        =
        (
        
          
            
              
                e
                →
              
            
          
          
            i
            x
          
        
        ,
        
          
            
              
                e
                →
              
            
          
          
            i
            y
          
        
        )
      
    
    {\displaystyle {\vec {e}}_{i}=({\vec {e}}_{ix},{\vec {e}}_{iy})}
  ).  The microscopic velocities in D2Q9, D3Q15, and D3Q19 for example are given as:

  
    
      
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        =
        c
        ×
        
          
            {
            
              
                
                  (
                  0
                  ,
                  0
                  )
                
                
                  i
                  =
                  0
                
              
              
                
                  (
                  1
                  ,
                  0
                  )
                  ,
                  (
                  0
                  ,
                  1
                  )
                  ,
                  (
                  −
                  1
                  ,
                  0
                  )
                  ,
                  (
                  0
                  ,
                  −
                  1
                  )
                
                
                  i
                  =
                  1
                  ,
                  2
                  ,
                  3
                  ,
                  4
                
              
              
                
                  (
                  1
                  ,
                  1
                  )
                  ,
                  (
                  −
                  1
                  ,
                  1
                  )
                  ,
                  (
                  −
                  1
                  ,
                  −
                  1
                  )
                  ,
                  (
                  1
                  ,
                  −
                  1
                  )
                
                
                  i
                  =
                  5
                  ,
                  6
                  ,
                  7
                  ,
                  8
                
              
            
            
          
        
      
    
    {\displaystyle {\vec {e}}_{i}=c\times {\begin{cases}(0,0)&i=0\\(1,0),(0,1),(-1,0),(0,-1)&i=1,2,3,4\\(1,1),(-1,1),(-1,-1),(1,-1)&i=5,6,7,8\\\end{cases}}}
  
  
    
      
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        =
        c
        ×
        
          
            {
            
              
                
                  (
                  0
                  ,
                  0
                  ,
                  0
                  )
                
                
                  i
                  =
                  0
                
              
              
                
                  (
                  ±
                  1
                  ,
                  0
                  ,
                  0
                  )
                  ,
                  (
                  0
                  ,
                  ±
                  1
                  ,
                  0
                  )
                  ,
                  (
                  0
                  ,
                  0
                  ,
                  ±
                  1
                  )
                
                
                  i
                  =
                  1
                  ,
                  2
                  ,
                  .
                  .
                  .
                  ,
                  5
                  ,
                  6
                
              
              
                
                  (
                  ±
                  1
                  ,
                  ±
                  1
                  ,
                  ±
                  1
                  )
                
                
                  i
                  =
                  7
                  ,
                  8
                  ,
                  .
                  .
                  .
                  ,
                  13
                  ,
                  14
                
              
            
            
          
        
      
    
    {\displaystyle {\vec {e}}_{i}=c\times {\begin{cases}(0,0,0)&i=0\\(\pm 1,0,0),(0,\pm 1,0),(0,0,\pm 1)&i=1,2,...,5,6\\(\pm 1,\pm 1,\pm 1)&i=7,8,...,13,14\\\end{cases}}}
  
  
    
      
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        =
        c
        ×
        
          
            {
            
              
                
                  (
                  0
                  ,
                  0
                  ,
                  0
                  )
                
                
                  i
                  =
                  0
                
              
              
                
                  (
                  ±
                  1
                  ,
                  0
                  ,
                  0
                  )
                  ,
                  (
                  0
                  ,
                  ±
                  1
                  ,
                  0
                  )
                  ,
                  (
                  0
                  ,
                  0
                  ,
                  ±
                  1
                  )
                
                
                  i
                  =
                  1
                  ,
                  2
                  ,
                  .
                  .
                  .
                  ,
                  5
                  ,
                  6
                
              
              
                
                  (
                  ±
                  1
                  ,
                  ±
                  1
                  ,
                  0
                  )
                  ,
                  (
                  ±
                  1
                  ,
                  0
                  ,
                  ±
                  1
                  )
                  ,
                  (
                  0
                  ,
                  ±
                  1
                  ,
                  ±
                  1
                  )
                
                
                  i
                  =
                  7
                  ,
                  8
                  ,
                  .
                  .
                  .
                  ,
                  17
                  ,
                  18
                
              
            
            
          
        
      
    
    {\displaystyle {\vec {e}}_{i}=c\times {\begin{cases}(0,0,0)&i=0\\(\pm 1,0,0),(0,\pm 1,0),(0,0,\pm 1)&i=1,2,...,5,6\\(\pm 1,\pm 1,0),(\pm 1,0,\pm 1),(0,\pm 1,\pm 1)&i=7,8,...,17,18\\\end{cases}}}
  The single-phase discretized Boltzmann equation for mass density and internal energy density are:

  
    
      
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
          δ
          
            t
          
        
        ,
        t
        +
        
          δ
          
            t
          
        
        )
        −
        
          f
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
        +
        
          F
          
            i
          
        
        =
        Ω
        (
        f
        )
        ,
      
    
    {\displaystyle f_{i}({\vec {x}}+{\vec {e}}_{i}\delta _{t},t+\delta _{t})-f_{i}({\vec {x}},t)+F_{i}=\Omega (f),}
  
  
    
      
        
          g
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
          δ
          
            t
          
        
        ,
        t
        +
        
          δ
          
            t
          
        
        )
        −
        
          g
          
            i
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
        +
        
          G
          
            i
          
        
        =
        Ω
        (
        g
        )
        .
      
    
    {\displaystyle g_{i}({\vec {x}}+{\vec {e}}_{i}\delta _{t},t+\delta _{t})-g_{i}({\vec {x}},t)+G_{i}=\Omega (g).}
  The collision operator is often approximated by a BGK collision operator under the condition it also satisfies the conservation laws:

  
    
      
        Ω
        (
        f
        )
        =
        
          
            1
            
              τ
              
                f
              
            
          
        
        (
        
          f
          
            i
          
          
            eq
          
        
        −
        
          f
          
            i
          
        
        )
        ,
      
    
    {\displaystyle \Omega (f)={\frac {1}{\tau _{f}}}(f_{i}^{\text{eq}}-f_{i}),}
  
  
    
      
        Ω
        (
        g
        )
        =
        
          
            1
            
              τ
              
                g
              
            
          
        
        (
        
          g
          
            i
          
          
            eq
          
        
        −
        
          g
          
            i
          
        
        )
        .
      
    
    {\displaystyle \Omega (g)={\frac {1}{\tau _{g}}}(g_{i}^{\text{eq}}-g_{i}).}
  In the collision operator 
  
    
      
        
          f
          
            i
          
          
            eq
          
        
      
    
    {\displaystyle f_{i}^{\text{eq}}}
   is the discrete, equilibrium particle probability distribution function.  In D2Q9 and D3Q19, it is shown below for an incompressible flow in continuous and discrete form where D, R, and T are the dimension, universal gas constant, and absolute temperature respectively.  The partial derivation for the continuous to discrete form is provided through a simple derivation to second order accuracy.

  
    
      
        
          f
          
            eq
          
        
        =
        
          
            ρ
            
              (
              2
              π
              R
              T
              
                )
                
                  D
                  
                    /
                  
                  2
                
              
            
          
        
        
          e
          
            −
            
              
                
                  (
                  
                    
                      
                        e
                        →
                      
                    
                  
                  −
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  R
                  T
                
              
            
          
        
      
    
    {\displaystyle f^{\text{eq}}={\frac {\rho }{(2\pi RT)^{D/2}}}e^{-{\frac {({\vec {e}}-{\vec {u}})^{2}}{2RT}}}}
  

  
    
      
        =
        
          
            ρ
            
              (
              2
              π
              R
              T
              
                )
                
                  D
                  
                    /
                  
                  2
                
              
            
          
        
        
          e
          
            −
            
              
                
                  (
                  
                    
                      
                        e
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  R
                  T
                
              
            
          
        
        
          e
          
            
              
                
                  
                    
                      
                        e
                        →
                      
                    
                  
                  
                    
                      
                        u
                        →
                      
                    
                  
                
                
                  R
                  T
                
              
            
            −
            
              
                
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    2
                  
                
                
                  2
                  R
                  T
                
              
            
          
        
      
    
    {\displaystyle ={\frac {\rho }{(2\pi RT)^{D/2}}}e^{-{\frac {({\vec {e}})^{2}}{2RT}}}e^{{\frac {{\vec {e}}{\vec {u}}}{RT}}-{\frac {{\vec {u}}^{2}}{2RT}}}}
  

  
    
      
        =
        
          
            ρ
            
              (
              2
              π
              R
              T
              
                )
                
                  D
                  
                    /
                  
                  2
                
              
            
          
        
        
          e
          
            −
            
              
                
                  (
                  
                    
                      
                        e
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  R
                  T
                
              
            
          
        
        
          (
          
            1
            +
            
              
                
                  
                    
                      
                        e
                        →
                      
                    
                  
                  
                    
                      
                        u
                        →
                      
                    
                  
                
                
                  R
                  T
                
              
            
            +
            
              
                
                  (
                  
                    
                      
                        e
                        →
                      
                    
                  
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  (
                  R
                  T
                  
                    )
                    
                      2
                    
                  
                
              
            
            −
            
              
                
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    2
                  
                
                
                  2
                  R
                  T
                
              
            
            +
            .
            .
            .
          
          )
        
      
    
    {\displaystyle ={\frac {\rho }{(2\pi RT)^{D/2}}}e^{-{\frac {({\vec {e}})^{2}}{2RT}}}\left(1+{\frac {{\vec {e}}{\vec {u}}}{RT}}+{\frac {({\vec {e}}{\vec {u}})^{2}}{2(RT)^{2}}}-{\frac {{\vec {u}}^{2}}{2RT}}+...\right)}
  Letting 
  
    
      
        c
        =
        
          
            3
            R
            T
          
        
      
    
    {\displaystyle c={\sqrt {3RT}}}
   yields the final result:

  
    
      
        
          f
          
            i
          
          
            e
            q
          
        
        =
        
          ω
          
            i
          
        
        ρ
        
          (
          
            1
            +
            
              
                
                  3
                  
                    
                      
                        
                          e
                          →
                        
                      
                    
                    
                      i
                    
                  
                  
                    
                      
                        u
                        →
                      
                    
                  
                
                
                  c
                  
                    2
                  
                
              
            
            +
            
              
                
                  9
                  (
                  
                    
                      
                        
                          e
                          →
                        
                      
                    
                    
                      i
                    
                  
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  
                    c
                    
                      4
                    
                  
                
              
            
            −
            
              
                
                  3
                  (
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  
                    c
                    
                      2
                    
                  
                
              
            
          
          )
        
      
    
    {\displaystyle f_{i}^{eq}=\omega _{i}\rho \left(1+{\frac {3{\vec {e}}_{i}{\vec {u}}}{c^{2}}}+{\frac {9({\vec {e}}_{i}{\vec {u}})^{2}}{2c^{4}}}-{\frac {3({\vec {u}})^{2}}{2c^{2}}}\right)}
  
  
    
      
        
          g
          
            e
            q
          
        
        =
        
          
            
              ρ
              (
              
                
                  
                    e
                    →
                  
                
              
              −
              
                
                  
                    u
                    →
                  
                
              
              
                )
                
                  2
                
              
            
            
              2
              (
              2
              π
              R
              T
              
                )
                
                  D
                  
                    /
                  
                  2
                
              
            
          
        
        
          e
          
            −
            
              
                
                  (
                  
                    
                      
                        e
                        →
                      
                    
                  
                  −
                  
                    
                      
                        u
                        →
                      
                    
                  
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  R
                  T
                
              
            
          
        
      
    
    {\displaystyle g^{eq}={\frac {\rho ({\vec {e}}-{\vec {u}})^{2}}{2(2\pi RT)^{D/2}}}e^{-{\frac {({\vec {e}}-{\vec {u}})^{2}}{2RT}}}}
  
  
    
      
        
          ω
          
            i
          
        
        =
        
          
            {
            
              
                
                  4
                  
                    /
                  
                  9
                
                
                  i
                  =
                  0
                
              
              
                
                  1
                  
                    /
                  
                  9
                
                
                  i
                  =
                  1
                  ,
                  2
                  ,
                  3
                  ,
                  4
                
              
              
                
                  1
                  
                    /
                  
                  36
                
                
                  i
                  =
                  5
                  ,
                  6
                  ,
                  7
                  ,
                  8
                
              
            
            
          
        
      
    
    {\displaystyle \omega _{i}={\begin{cases}4/9&i=0\\1/9&i=1,2,3,4\\1/36&i=5,6,7,8\\\end{cases}}}
  
  
    
      
        
          ω
          
            i
          
        
        =
        
          
            {
            
              
                
                  1
                  
                    /
                  
                  3
                
                
                  i
                  =
                  0
                
              
              
                
                  1
                  
                    /
                  
                  18
                
                
                  i
                  =
                  1
                  ,
                  2
                  ,
                  .
                  .
                  .
                  ,
                  5
                  ,
                  6
                
              
              
                
                  1
                  
                    /
                  
                  36
                
                
                  i
                  =
                  7
                  ,
                  8
                  ,
                  .
                  .
                  .
                  ,
                  17
                  ,
                  18
                
              
            
            
          
        
      
    
    {\displaystyle \omega _{i}={\begin{cases}1/3&i=0\\1/18&i=1,2,...,5,6\\1/36&i=7,8,...,17,18\\\end{cases}}}
  As much work has already been done on a single-component flow, the following TLBM will be discussed.  The multicomponent/multiphase TLBM is also more intriguing and useful than simply one component.  To be in line with current research, define the set of all components of the system (i. e. walls of porous media, multiple fluids/gases, etc.) 
  
    
      
        Ψ
      
    
    {\displaystyle \Psi }
   with elements 
  
    
      
        
          σ
          
            j
          
        
      
    
    {\displaystyle \sigma _{j}}
  .

  
    
      
        
          f
          
            i
          
          
            σ
          
        
        (
        
          
            
              x
              →
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
          δ
          
            t
          
        
        ,
        t
        +
        
          δ
          
            t
          
        
        )
        −
        
          f
          
            i
          
          
            σ
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        t
        )
        +
        
          F
          
            i
          
        
        =
        
          
            1
            
              τ
              
                f
              
              
                σ
              
            
          
        
        (
        
          f
          
            i
          
          
            σ
            ,
            e
            q
          
        
        (
        
          ρ
          
            σ
          
        
        ,
        
          v
          
            σ
          
        
        )
        −
        
          f
          
            i
          
          
            σ
          
        
        )
      
    
    {\displaystyle f_{i}^{\sigma }({\vec {x}}+{\vec {e}}_{i}\delta _{t},t+\delta _{t})-f_{i}^{\sigma }({\vec {x}},t)+F_{i}={\frac {1}{\tau _{f}^{\sigma }}}(f_{i}^{\sigma ,eq}(\rho ^{\sigma },v^{\sigma })-f_{i}^{\sigma })}
  The relaxation parameter,
  
    
      
        
          τ
          
            f
          
          
            
              σ
              
                j
              
            
          
        
        
        
      
    
    {\displaystyle \tau _{f}^{\sigma _{j}}\,\!}
  , is related to the kinematic viscosity,
  
    
      
        
          ν
          
            f
          
          
            
              σ
              
                j
              
            
          
        
        
        
      
    
    {\displaystyle \nu _{f}^{\sigma _{j}}\,\!}
  , by the following relationship:

  
    
      
        
          ν
          
            f
          
          
            
              σ
              
                j
              
            
          
        
        =
        (
        
          τ
          
            f
          
          
            
              σ
              
                j
              
            
          
        
        −
        0.5
        )
        
          c
          
            s
          
          
            2
          
        
        
          δ
          
            t
          
        
        .
      
    
    {\displaystyle \nu _{f}^{\sigma _{j}}=(\tau _{f}^{\sigma _{j}}-0.5)c_{s}^{2}\delta _{t}.}
  The moments of the 
  
    
      
        
          f
          
            i
          
        
        
        
      
    
    {\displaystyle f_{i}\,\!}
   give the local conserved quantities. The density is given by

  
    
      
        ρ
        =
        
          ∑
          
            σ
          
        
        
          ∑
          
            i
          
        
        
          f
          
            i
          
        
        
        
      
    
    {\displaystyle \rho =\sum _{\sigma }\sum _{i}f_{i}\,\!}
  
  
    
      
        ρ
        ϵ
        =
        
          ∑
          
            i
          
        
        
          g
          
            i
          
        
        
        
      
    
    {\displaystyle \rho \epsilon =\sum _{i}g_{i}\,\!}
  
  
    
      
        
          ρ
          
            σ
          
        
        =
        
          ∑
          
            i
          
        
        
          f
          
            i
          
          
            σ
          
        
        
        
      
    
    {\displaystyle \rho ^{\sigma }=\sum _{i}f_{i}^{\sigma }\,\!}
  and the weighted average velocity, 
  
    
      
        
          
            
              
                u
                ′
              
              →
            
          
        
        
        
      
    
    {\displaystyle {\vec {u'}}\,\!}
  , and the local momentum are given by

  
    
      
        
          
            
              
                u
                ′
              
              →
            
          
        
        =
        
          (
          
            
              ∑
              
                σ
              
            
            
              
                
                  
                    ρ
                    
                      σ
                    
                  
                  
                    
                      
                        
                          u
                          
                            σ
                          
                        
                        →
                      
                    
                  
                
                
                  τ
                  
                    f
                  
                  
                    σ
                  
                
              
            
          
          )
        
        
          /
        
        
          (
          
            
              ∑
              
                σ
              
            
            
              
                
                  ρ
                  
                    σ
                  
                
                
                  τ
                  
                    f
                  
                  
                    σ
                  
                
              
            
          
          )
        
      
    
    {\displaystyle {\vec {u'}}=\left(\sum _{\sigma }{\frac {\rho ^{\sigma }{\vec {u^{\sigma }}}}{\tau _{f}^{\sigma }}}\right)/\left(\sum _{\sigma }{\frac {\rho ^{\sigma }}{\tau _{f}^{\sigma }}}\right)}
  
  
    
      
        
          ρ
          
            σ
          
        
        
          
            
              
                u
                
                  σ
                
              
              →
            
          
        
        =
        
          ∑
          
            i
          
        
        
          f
          
            i
          
          
            σ
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        .
      
    
    {\displaystyle \rho ^{\sigma }{\vec {u^{\sigma }}}=\sum _{i}f_{i}^{\sigma }{\vec {e}}_{i}.}
  
  
    
      
        
          v
          
            σ
          
        
        =
        
          
            
              
                u
                ′
              
              →
            
          
        
        +
        
          
            
              τ
              
                f
              
              
                σ
              
            
            
              ρ
              
                σ
              
            
          
        
        
          
            
              
                F
                →
              
            
          
          
            σ
          
        
      
    
    {\displaystyle v^{\sigma }={\vec {u'}}+{\frac {\tau _{f}^{\sigma }}{\rho ^{\sigma }}}{\vec {F}}^{\sigma }}
  In the above equation for the equilibrium velocity 
  
    
      
        
          v
          
            σ
          
        
        
        
      
    
    {\displaystyle v^{\sigma }\,\!}
  , the 
  
    
      
        
          
            
              
                F
                →
              
            
          
          
            σ
          
        
        
        
      
    
    {\displaystyle {\vec {F}}^{\sigma }\,\!}
   term is the interaction force between a component and the other components.  It is still the subject of much discussion as it is typically a tuning parameter that determines how fluid-fluid, fluid-gas, etc. interact.  Frank et al. list current models for this force term.  The commonly used derivations are Gunstensen chromodynamic model, Swift's free energy-based approach for both liquid/vapor systems and binary fluids, He's intermolecular interaction-based model, the Inamuro approach, and the Lee and Lin approach.The following is the general description for 
  
    
      
        
          
            
              
                F
                →
              
            
          
          
            σ
          
        
        
        
      
    
    {\displaystyle {\vec {F}}^{\sigma }\,\!}
   as given by several authors.
  
    
      
        
          
            
              
                F
                →
              
            
          
          
            σ
          
        
        =
        −
        
          ψ
          
            σ
          
        
        (
        
          
            
              x
              →
            
          
        
        )
        
          ∑
          
            
              σ
              
                j
              
            
          
        
        
          H
          
            σ
            
              σ
              
                j
              
            
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                x
                →
              
            
          
          ′
        
        )
        
          ∑
          
            i
          
        
        
          ψ
          
            
              σ
              
                j
              
            
          
        
        (
        
          
            
              x
              →
            
          
        
        +
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        )
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
        
      
    
    {\displaystyle {\vec {F}}^{\sigma }=-\psi ^{\sigma }({\vec {x}})\sum _{\sigma _{j}}H^{\sigma \sigma _{j}}({\vec {x}},{\vec {x}}')\sum _{i}\psi ^{\sigma _{j}}({\vec {x}}+{\vec {e}}_{i}){\vec {e}}_{i}\,\!}
  

  
    
      
        ψ
        (
        
          
            
              x
              →
            
          
        
        )
        
        
      
    
    {\displaystyle \psi ({\vec {x}})\,\!}
   is the effective mass and 
  
    
      
        H
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                x
                →
              
            
          
          ′
        
        )
        
        
      
    
    {\displaystyle H({\vec {x}},{\vec {x}}')\,\!}
   is Green's function representing the interparticle interaction with 
  
    
      
        
          
            
              
                x
                →
              
            
          
          ′
        
        
        
      
    
    {\displaystyle {\vec {x}}'\,\!}
   as the neighboring site.  Satisfying 
  
    
      
        H
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                x
                →
              
            
          
          ′
        
        )
        =
        H
        (
        
          
            
              
                x
                →
              
            
          
          ′
        
        ,
        
          
            
              x
              →
            
          
        
        )
        
        
      
    
    {\displaystyle H({\vec {x}},{\vec {x}}')=H({\vec {x}}',{\vec {x}})\,\!}
   and where 
  
    
      
        H
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                x
                →
              
            
          
          ′
        
        )
        >
        0
        
        
      
    
    {\displaystyle H({\vec {x}},{\vec {x}}')>0\,\!}
   represents repulsive forces.  For D2Q9 and D3Q19, this leads to

  
    
      
        
          H
          
            σ
            
              σ
              
                j
              
            
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                x
                →
              
            
          
          ′
        
        )
        =
        
          
            {
            
              
                
                  
                    h
                    
                      σ
                      
                        σ
                        
                          j
                        
                      
                    
                  
                
                
                  
                    |
                    
                      
                        
                          
                            x
                            →
                          
                        
                      
                      −
                      
                        
                          
                            
                              x
                              →
                            
                          
                        
                        ′
                      
                    
                    |
                  
                  ≤
                  c
                
              
              
                
                  0
                
                
                  
                    |
                    
                      
                        
                          
                            x
                            →
                          
                        
                      
                      −
                      
                        
                          
                            
                              x
                              →
                            
                          
                        
                        ′
                      
                    
                    |
                  
                  >
                  c
                
              
            
            
          
        
      
    
    {\displaystyle H^{\sigma \sigma _{j}}({\vec {x}},{\vec {x}}')={\begin{cases}h^{\sigma \sigma _{j}}&\left|{\vec {x}}-{\vec {x}}'\right|\leq c\\0&\left|{\vec {x}}-{\vec {x}}'\right|>c\\\end{cases}}}
  

  
    
      
        
          H
          
            σ
            
              σ
              
                j
              
            
          
        
        (
        
          
            
              x
              →
            
          
        
        ,
        
          
            
              
                x
                →
              
            
          
          ′
        
        )
        =
        
          
            {
            
              
                
                  
                    h
                    
                      σ
                      
                        σ
                        
                          j
                        
                      
                    
                  
                
                
                  
                    |
                    
                      
                        
                          
                            x
                            →
                          
                        
                      
                      −
                      
                        
                          
                            
                              x
                              →
                            
                          
                        
                        ′
                      
                    
                    |
                  
                  =
                  c
                
              
              
                
                  
                    h
                    
                      σ
                      
                        σ
                        
                          j
                        
                      
                    
                  
                  
                    /
                  
                  2
                
                
                  
                    |
                    
                      
                        
                          
                            x
                            →
                          
                        
                      
                      −
                      
                        
                          
                            
                              x
                              →
                            
                          
                        
                        ′
                      
                    
                    |
                  
                  =
                  
                    
                      2
                      c
                    
                  
                
              
              
                
                  0
                
                
                  
                    otherwise
                  
                
              
            
            
          
        
      
    
    {\displaystyle H^{\sigma \sigma _{j}}({\vec {x}},{\vec {x}}')={\begin{cases}h^{\sigma \sigma _{j}}&\left|{\vec {x}}-{\vec {x}}'\right|=c\\h^{\sigma \sigma _{j}}/2&\left|{\vec {x}}-{\vec {x}}'\right|={\sqrt {2c}}\\0&{\text{otherwise}}\\\end{cases}}}
  
The effective mass as proposed by Shan and Chen uses the following effective mass for a single-component, multiphase system.  The equation of state is also given under the condition of a single component and multiphase.

  
    
      
        ψ
        (
        
          
            
              x
              →
            
          
        
        )
        =
        ψ
        (
        
          ρ
          
            σ
          
        
        )
        =
        
          ρ
          
            0
          
          
            σ
          
        
        
          [
          
            1
            −
            
              e
              
                (
                −
                
                  ρ
                  
                    σ
                  
                
                
                  /
                
                
                  ρ
                  
                    0
                  
                  
                    σ
                  
                
                )
              
            
          
          ]
        
        
        
      
    
    {\displaystyle \psi ({\vec {x}})=\psi (\rho ^{\sigma })=\rho _{0}^{\sigma }\left[1-e^{(-\rho ^{\sigma }/\rho _{0}^{\sigma })}\right]\,\!}
  
  
    
      
        p
        =
        
          c
          
            s
          
          
            2
          
        
        ρ
        +
        
          c
          
            0
          
        
        h
        [
        ψ
        (
        
          
            
              x
              →
            
          
        
        )
        
          ]
          
            2
          
        
        
        
      
    
    {\displaystyle p=c_{s}^{2}\rho +c_{0}h[\psi ({\vec {x}})]^{2}\,\!}
  So far, it appears that 
  
    
      
        
          ρ
          
            0
          
          
            σ
          
        
        
        
      
    
    {\displaystyle \rho _{0}^{\sigma }\,\!}
   and 
  
    
      
        
          h
          
            σ
            
              σ
              
                j
              
            
          
        
        
        
      
    
    {\displaystyle h^{\sigma \sigma _{j}}\,\!}
   are free constants to tune but once plugged into the system's equation of state(EOS), they must satisfy the thermodynamic relationships at the critical point such that 
  
    
      
        (
        ∂
        P
        
          /
        
        ∂
        
          ρ
        
        
          )
          
            T
          
        
        =
        (
        
          ∂
          
            2
          
        
        P
        
          /
        
        ∂
        
          
            ρ
            
              2
            
          
        
        
          )
          
            T
          
        
        =
        0
        
        
      
    
    {\displaystyle (\partial P/\partial {\rho })_{T}=(\partial ^{2}P/\partial {\rho ^{2}})_{T}=0\,\!}
   and 
  
    
      
        p
        =
        
          p
          
            c
          
        
        
        
      
    
    {\displaystyle p=p_{c}\,\!}
  .  For the EOS, 
  
    
      
        
          c
          
            0
          
        
        
        
      
    
    {\displaystyle c_{0}\,\!}
   is 3.0 for D2Q9 and D3Q19 while it equals 10.0 for D3Q15.It was later shown by Yuan and Schaefer that the effective mass density needs to be changed to simulate multiphase flow more accurately.  They compared the Shan and Chen (SC), Carnahan-Starling (C–S), van der Waals (vdW), Redlich–Kwong (R–K), Redlich–Kwong Soave (RKS), and Peng–Robinson (P–R) EOS.  Their results revealed that the SC EOS was insufficient and that C–S, P–R, R–K, and RKS EOS are all more accurate in modeling multiphase flow of a single component.
For the popular isothermal Lattice Boltzmann methods these are the only conserved quantities. Thermal models also conserve energy and therefore have an additional conserved quantity:

  
    
      
        ρ
        θ
        +
        ρ
        u
        u
        =
        
          ∑
          
            i
          
        
        
          f
          
            i
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        
          
            
              
                e
                →
              
            
          
          
            i
          
        
        .
      
    
    {\displaystyle \rho \theta +\rho uu=\sum _{i}f_{i}{\vec {e}}_{i}{\vec {e}}_{i}.}

Applications
During the last years, the LBM has proven to be a powerful tool for solving problems at different length and time scales. 
Some of the applications of LBM include:

Porous Media flows 
Biomedical Flows
Earth sciences (Soil filtration).
Energy Sciences (Fuel Cells).

External links
LBM Method
Entropic Lattice Boltzmann Method (ELBM)
dsfd.org: Website of the annual DSFD conference series (1986 -- now) where advances in theory and application of the lattice Boltzmann method are discussed
Website of the annual ICMMES conference on lattice Boltzmann methods and their applications

Further reading
Deutsch, Andreas; Sabine Dormann (2004). Cellular Automaton Modeling of Biological Pattern Formation. Birkhäuser Verlag. ISBN 978-0-8176-4281-5.
Succi, Sauro (2001). The Lattice Boltzmann Equation for Fluid Dynamics and Beyond. Oxford University Press. ISBN 978-0-19-850398-9.
Wolf-Gladrow, Dieter (2000). Lattice-Gas Cellular Automata and Lattice Boltzmann Models. Springer Verlag. ISBN 978-3-540-66973-9.
Sukop, Michael C.; Daniel T. Thorne, Jr. (2007). Lattice Boltzmann Modeling: An Introduction for Geoscientists and Engineers. Springer. ISBN 978-3-540-27981-5.
Jian Guo Zhou (2004). Lattice Boltzmann Methods for Shallow Water Flows. Springer. ISBN 978-3-540-40746-1.
He,X., Chen, S., Doolen, G. (1998). A Novel Thermal Model for the Lattice Boltzmann Method in Incompressible Limit. Academic Press.{{cite book}}:  CS1 maint: multiple names: authors list (link)
Guo, Z. L.; Shu, C (2013). Lattice Boltzmann Method and Its Applications in Engineering. World Scientific Publishing.
Huang, H.; M.C. Sukop; X-Y. Lu (2015). Multiphase Lattice Boltzmann Methods: Theory and Application. Wiley-Blackwell. ISBN 978-1-118-97133-8.
Krüger, T.; Kusumaatmaja, H.; Kuzmin, A.; Shardt, O.; Silva, G.; Viggen, E. M. (2017). The Lattice Boltzmann Method: Principles and Practice. Springer Verlag. ISBN 978-3-319-44647-9.


== Notes ==