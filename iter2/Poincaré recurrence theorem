In mathematics and physics, the Poincaré recurrence theorem states that certain dynamical systems will, after a sufficiently long but finite time, return to a state arbitrarily close to (for continuous state systems), or exactly the same as (for discrete state systems), their initial state.
The Poincaré recurrence time is the length of time elapsed until the recurrence. This time may vary greatly depending on the exact initial state and required degree of closeness. The result applies to isolated mechanical systems subject to some constraints, e.g., all particles must be bound to a finite volume. The theorem is commonly discussed in the context of ergodic theory, dynamical systems and statistical mechanics. Systems to which the Poincaré recurrence theorem applies are called conservative systems.
The theorem is named after Henri Poincaré, who discussed it in 1890 and proved by Constantin Carathéodory using measure theory in 1919.

Precise formulation
Any dynamical system defined by an ordinary differential equation determines a flow map f t mapping phase space on itself. The system is said to be volume-preserving if the volume of a set in phase space is invariant under the flow. For instance, all Hamiltonian systems are volume-preserving because of Liouville's theorem. The theorem is then: If a flow preserves volume and has only bounded orbits, then, for each open set, any orbit that intersects this open set intersects it infinitely often.

Discussion of proof
The proof, speaking qualitatively, hinges on two premises:
A finite upper bound can be set on the total potentially accessible phase space volume. For a mechanical system, this bound can be provided by requiring that the system is contained in a bounded physical region of space (so that it cannot, for example, eject particles that never return) – combined with the conservation of energy, this locks the system into a finite region in phase space.
The phase volume of a finite element under dynamics is conserved (for a mechanical system, this is ensured by Liouville's theorem).Imagine any finite starting volume 
  
    
      
        
          D
          
            1
          
        
      
    
    {\displaystyle D_{1}}
   of the phase space and to follow its path under the dynamics of the system. The volume evolves through a "phase tube" in the phase space, keeping its size constant. Assuming a finite phase space, after some number of steps 
  
    
      
        
          k
          
            1
          
        
      
    
    {\displaystyle k_{1}}
   the phase tube must intersect itself. This means that at least a finite fraction 
  
    
      
        
          R
          
            1
          
        
      
    
    {\displaystyle R_{1}}
   of the starting volume is recurring.
Now, consider the size of the non-returning portion 
  
    
      
        
          D
          
            2
          
        
      
    
    {\displaystyle D_{2}}
   of the starting phase volume – that portion that never returns to the starting volume. Using the principle just discussed in the last paragraph, we know that if the non-returning portion is finite, then a finite part 
  
    
      
        
          R
          
            2
          
        
      
    
    {\displaystyle R_{2}}
   of it must return after 
  
    
      
        
          k
          
            2
          
        
      
    
    {\displaystyle k_{2}}
   steps. But that would be a contradiction, since in a number 
  
    
      
        
          k
          
            3
          
        
        =
      
    
    {\displaystyle k_{3}=}
  lcm
  
    
      
        (
        
          k
          
            1
          
        
        ,
        
          k
          
            2
          
        
        )
      
    
    {\displaystyle (k_{1},k_{2})}
   of step, both 
  
    
      
        
          R
          
            1
          
        
      
    
    {\displaystyle R_{1}}
   and 
  
    
      
        
          R
          
            2
          
        
      
    
    {\displaystyle R_{2}}
   would be returning, against the hypothesis that only 
  
    
      
        
          R
          
            1
          
        
      
    
    {\displaystyle R_{1}}
   was. Thus, the non-returning portion of the starting volume cannot be the empty set, i.e. all 
  
    
      
        
          D
          
            1
          
        
      
    
    {\displaystyle D_{1}}
   is recurring after some number of steps.
The theorem does not comment on certain aspects of recurrence which this proof cannot guarantee:

There may be some special phases that never return to the starting phase volume, or that only return to the starting volume a finite number of times then never return again. These however are extremely "rare", making up an infinitesimal part of any starting volume.
Not all parts of the phase volume need to return at the same time. Some will "miss" the starting volume on the first pass, only to make their return at a later time.
Nothing prevents the phase tube from returning completely to its starting volume before all the possible phase volume is exhausted. A trivial example of this is the harmonic oscillator. Systems that do cover all accessible phase volume are called ergodic (this of course depends on the definition of "accessible volume").
What can be said is that for "almost any" starting phase, a system will eventually return arbitrarily close to that starting phase. The recurrence time depends on the required degree of closeness (the size of the phase volume). To achieve greater accuracy of recurrence, we need to take smaller initial volume, which means longer recurrence time.
For a given phase in a volume, the recurrence is not necessarily a periodic recurrence. The second recurrence time does not need to be double the first recurrence time.

Formal statement
Let 

  
    
      
        (
        X
        ,
        Σ
        ,
        μ
        )
      
    
    {\displaystyle (X,\Sigma ,\mu )}
  be a finite measure space and let 

  
    
      
        f
        :
        X
        →
        X
      
    
    {\displaystyle f\colon X\to X}
  be a measure-preserving transformation. Below are two alternative statements of the theorem.

Theorem 1
For any 
  
    
      
        E
        ∈
        Σ
      
    
    {\displaystyle E\in \Sigma }
  , the set of those points 
  
    
      
        x
      
    
    {\displaystyle x}
   of 
  
    
      
        E
      
    
    {\displaystyle E}
   for which there exists 
  
    
      
        N
        ∈
        
          N
        
      
    
    {\displaystyle N\in \mathbb {N} }
   such that 
  
    
      
        
          f
          
            n
          
        
        (
        x
        )
        ∉
        E
      
    
    {\displaystyle f^{n}(x)\notin E}
   for all 
  
    
      
        n
        >
        N
      
    
    {\displaystyle n>N}
   has zero measure. 
In other words, almost every point of 
  
    
      
        E
      
    
    {\displaystyle E}
   returns to 
  
    
      
        E
      
    
    {\displaystyle E}
  . In fact, almost every point returns infinitely often; i.e.

  
    
      
        μ
        
          (
          
            {
            x
            ∈
            E
            :
            
               there exists 
            
            N
            
               such that 
            
            
              f
              
                n
              
            
            (
            x
            )
            ∉
            E
            
               for all 
            
            n
            >
            N
            }
          
          )
        
        =
        0.
      
    
    {\displaystyle \mu \left(\{x\in E:{\text{ there exists }}N{\text{ such that }}f^{n}(x)\notin E{\text{ for all }}n>N\}\right)=0.}

Theorem 2
The following is a topological version of this theorem:
If 
  
    
      
        X
      
    
    {\displaystyle X}
   is a second-countable Hausdorff space and 
  
    
      
        Σ
      
    
    {\displaystyle \Sigma }
   contains the Borel sigma-algebra, then the set of recurrent points of 
  
    
      
        f
      
    
    {\displaystyle f}
   has full measure. That is, almost every point is recurrent.
More generally, the theorem applies to conservative systems, and not just to measure-preserving dynamical systems.  Roughly speaking, one can say that conservative systems are precisely those to which the recurrence theorem applies.

Quantum mechanical version
For time-independent quantum mechanical systems with discrete energy eigenstates, a similar theorem holds. For every 
  
    
      
        ε
        >
        0
      
    
    {\displaystyle \varepsilon >0}
   and 
  
    
      
        
          T
          
            0
          
        
        >
        0
      
    
    {\displaystyle T_{0}>0}
   there exists a time T larger than 
  
    
      
        
          T
          
            0
          
        
      
    
    {\displaystyle T_{0}}
  , such that 
  
    
      
        
          |
        
        
          |
        
        ψ
        (
        T
        )
        ⟩
        −
        
          |
        
        ψ
        (
        0
        )
        ⟩
        
          |
        
        <
        ε
      
    
    {\displaystyle ||\psi (T)\rangle -|\psi (0)\rangle |<\varepsilon }
  , where 
  
    
      
        
          |
        
        ψ
        (
        t
        )
        ⟩
      
    
    {\displaystyle |\psi (t)\rangle }
   denotes the state vector of the system at time t.The essential elements of the proof are as follows. The system evolves in time according to:

  
    
      
        
          |
        
        ψ
        (
        t
        )
        ⟩
        =
        
          ∑
          
            n
            =
            0
          
          
            ∞
          
        
        
          c
          
            n
          
        
        exp
        ⁡
        (
        −
        i
        
          E
          
            n
          
        
        t
        )
        
          |
        
        
          ϕ
          
            n
          
        
        ⟩
      
    
    {\displaystyle |\psi (t)\rangle =\sum _{n=0}^{\infty }c_{n}\exp(-iE_{n}t)|\phi _{n}\rangle }
  where the 
  
    
      
        
          E
          
            n
          
        
      
    
    {\displaystyle E_{n}}
   are the energy eigenvalues (we use natural units, so 
  
    
      
        ℏ
        =
        1
      
    
    {\displaystyle \hbar =1}
   ), and the 
  
    
      
        
          |
        
        
          ϕ
          
            n
          
        
        ⟩
      
    
    {\displaystyle |\phi _{n}\rangle }
   are the energy eigenstates. The squared norm of the difference of the state vector at time 
  
    
      
        T
      
    
    {\displaystyle T}
   and time zero, can be written as:

  
    
      
        
          |
        
        
          |
        
        ψ
        (
        T
        )
        ⟩
        −
        
          |
        
        ψ
        (
        0
        )
        ⟩
        
          
            |
          
          
            2
          
        
        =
        2
        
          ∑
          
            n
            =
            0
          
          
            ∞
          
        
        
          |
        
        
          c
          
            n
          
        
        
          
            |
          
          
            2
          
        
        [
        1
        −
        cos
        ⁡
        (
        
          E
          
            n
          
        
        T
        )
        ]
      
    
    {\displaystyle ||\psi (T)\rangle -|\psi (0)\rangle |^{2}=2\sum _{n=0}^{\infty }|c_{n}|^{2}[1-\cos(E_{n}T)]}
  We can truncate the summation at some n = N independent of T, because

  
    
      
        
          ∑
          
            n
            =
            N
            +
            1
          
          
            ∞
          
        
        
          |
        
        
          c
          
            n
          
        
        
          
            |
          
          
            2
          
        
        [
        1
        −
        cos
        ⁡
        (
        
          E
          
            n
          
        
        T
        )
        ]
        ≤
        2
        
          ∑
          
            n
            =
            N
            +
            1
          
          
            ∞
          
        
        
          |
        
        
          c
          
            n
          
        
        
          
            |
          
          
            2
          
        
      
    
    {\displaystyle \sum _{n=N+1}^{\infty }|c_{n}|^{2}[1-\cos(E_{n}T)]\leq 2\sum _{n=N+1}^{\infty }|c_{n}|^{2}}
  
which can be made arbitrarily small by increasing N, as the summation 
  
    
      
        
          ∑
          
            n
            =
            0
          
          
            ∞
          
        
        
          |
        
        
          c
          
            n
          
        
        
          
            |
          
          
            2
          
        
      
    
    {\displaystyle \sum _{n=0}^{\infty }|c_{n}|^{2}}
  , being the squared norm of the initial state, converges to 1.
The finite sum

  
    
      
        
          ∑
          
            n
            =
            0
          
          
            N
          
        
        
          |
        
        
          c
          
            n
          
        
        
          
            |
          
          
            2
          
        
        [
        1
        −
        cos
        ⁡
        (
        
          E
          
            n
          
        
        T
        )
        ]
      
    
    {\displaystyle \sum _{n=0}^{N}|c_{n}|^{2}[1-\cos(E_{n}T)]}
  can be made arbitrarily small for specific choices of the time T, according to the following construction. Choose an arbitrary 
  
    
      
        δ
        >
        0
      
    
    {\displaystyle \delta >0}
  , and then choose T such that there are integers  
  
    
      
        
          k
          
            n
          
        
      
    
    {\displaystyle k_{n}}
   that satisfies 

  
    
      
        
          |
        
        
          E
          
            n
          
        
        T
        −
        2
        π
        
          k
          
            n
          
        
        
          |
        
        <
        δ
      
    
    {\displaystyle |E_{n}T-2\pi k_{n}|<\delta }
  ,for all numbers 
  
    
      
        0
        ≤
        n
        ≤
        N
      
    
    {\displaystyle 0\leq n\leq N}
  . For this specific choice of T, 

  
    
      
        1
        −
        cos
        ⁡
        (
        
          E
          
            n
          
        
        T
        )
        <
        
          
            
              δ
              
                2
              
            
            2
          
        
        .
      
    
    {\displaystyle 1-\cos(E_{n}T)<{\frac {\delta ^{2}}{2}}.}
  As such, we have:

  
    
      
        2
        
          ∑
          
            n
            =
            0
          
          
            N
          
        
        
          |
        
        
          c
          
            n
          
        
        
          
            |
          
          
            2
          
        
        [
        1
        −
        cos
        ⁡
        (
        
          E
          
            n
          
        
        T
        )
        ]
        <
        
          δ
          
            2
          
        
        
          ∑
          
            n
            =
            0
          
          
            N
          
        
        
          |
        
        
          c
          
            n
          
        
        
          
            |
          
          
            2
          
        
        <
        
          δ
          
            2
          
        
      
    
    {\displaystyle 2\sum _{n=0}^{N}|c_{n}|^{2}[1-\cos(E_{n}T)]<\delta ^{2}\sum _{n=0}^{N}|c_{n}|^{2}<\delta ^{2}}
  .The state vector 
  
    
      
        
          |
        
        ψ
        (
        T
        )
        ⟩
      
    
    {\displaystyle |\psi (T)\rangle }
   thus returns arbitrarily close to the initial state 
  
    
      
        
          |
        
        ψ
        (
        0
        )
        ⟩
      
    
    {\displaystyle |\psi (0)\rangle }
  .

See also
Arnold's cat map
Ergodic hypothesis
Recurrence period density entropy
Recurrence plot
Wandering set
Quantum revival

References
Further reading
Page, Don N. (25 November 1994). "Information loss in black holes and/or conscious beings?". arXiv:hep-th/9411193.

External links
Padilla, Tony. "The Longest Time". Numberphile. Brady Haran. Archived from the original on 2013-11-27. Retrieved 2013-04-08.
"Arnold's Cat Map: An interactive graphical illustration of the recurrence theorem of Poincaré".This article incorporates material from Poincaré recurrence theorem on PlanetMath, which is licensed under the Creative Commons Attribution/Share-Alike License.