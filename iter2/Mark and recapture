Mark and recapture is a method commonly used in ecology to estimate an animal population's size where it is impractical to count every individual. A portion of the population is captured, marked, and released. Later, another portion will be captured and the number of marked individuals within the sample is counted. Since the number of marked individuals within the second sample should be proportional to the number of marked individuals in the whole population, an estimate of the total population size can be obtained by dividing the number of marked individuals by the proportion of marked individuals in the second sample. Other names for this method, or closely related methods, include capture-recapture, capture-mark-recapture, mark-recapture, sight-resight, mark-release-recapture, multiple systems estimation, band recovery, the Petersen method, and the Lincoln method.
Another major application for these methods is in epidemiology, where they are used to estimate the completeness of ascertainment of disease registers. Typical applications include estimating the number of people needing particular services (i.e. services for children with learning disabilities, services for medically frail elderly living in the community), or with particular conditions (i.e. illegal drug addicts, people infected with HIV, etc.).

Field work related to mark-recapture
Typically a researcher visits a study area and uses traps to capture a group of individuals alive. Each of these individuals is marked with a unique identifier (e.g., a numbered tag or band), and then is released unharmed back into the environment.  A mark-recapture method was first used for ecological study in 1896 by C.G. Johannes Petersen to estimate plaice, Pleuronectes platessa, populations.Sufficient time is allowed to pass for the marked individuals to redistribute themselves among the unmarked population.Next, the researcher returns and captures another sample of individuals. Some individuals in this second sample will have been marked during the initial visit and are now known as recaptures. Other organisms captured during the second visit, will not have been captured during the first visit to the study area. These unmarked animals are usually given a tag or band during the second visit and then are released.Population size can be estimated from as few as two visits to the study area. Commonly, more than two visits are made, particularly if estimates of survival or movement are desired.  Regardless of the total number of visits, the researcher simply records the date of each capture of each individual.  The "capture histories" generated are analyzed mathematically to estimate population size, survival, or movement.When capturing and marking organisms, ecologists need to consider the welfare of the organisms. If the chosen identifier harms the organism, then its behavior might become irregular.

Notation
Let

N = Number of animals in the population
n = Number of animals marked on the first visit
K = Number of animals captured on the second visit
k = Number of recaptured animals that were markedA biologist wants to estimate the size of a population of turtles in a lake.  She captures 10 turtles on her first visit to the lake, and marks their backs with paint. A week later she returns to the lake and captures 15 turtles.  Five of these 15 turtles have paint on their backs, indicating that they are recaptured animals. This example is (n, K, k) = (10, 15, 5). The problem is to estimate N.

Lincoln–Petersen estimator
The Lincoln–Petersen method (also known as the Petersen–Lincoln index or Lincoln index) can be used to estimate population size if only two visits are made to the study area.  This method assumes that the study population is "closed". In other words, the two visits to the study area are close enough in time so that no individuals die, are born, or move into or out of the study area between visits.  The model also assumes that no marks fall off animals between visits to the field site by the researcher, and that the researcher correctly records all marks.
Given those conditions, estimated population size is:

  
    
      
        
          
            
              N
              ^
            
          
        
        =
        
          
            
              n
              K
            
            k
          
        
        ,
      
    
    {\displaystyle {\hat {N}}={\frac {nK}{k}},}

Derivation
It is assumed that all individuals have the same probability of being captured in the second sample, regardless of whether they were previously captured in the first sample (with only two samples, this assumption cannot be tested directly).
This implies that, in the second sample, the proportion of marked individuals that are caught (
  
    
      
        k
        
          /
        
        K
      
    
    {\displaystyle k/K}
  ) should equal the proportion of the total population that is marked (
  
    
      
        n
        
          /
        
        N
      
    
    {\displaystyle n/N}
  ). For example, if half of the marked individuals were recaptured, it would be assumed that half of the total population was included in the second sample.
In symbols,

  
    
      
        
          
            k
            K
          
        
        =
        
          
            n
            N
          
        
        .
      
    
    {\displaystyle {\frac {k}{K}}={\frac {n}{N}}.}
  A rearrangement of this gives

  
    
      
        
          
            
              N
              ^
            
          
        
        =
        
          
            
              n
              K
            
            k
          
        
        ,
      
    
    {\displaystyle {\hat {N}}={\frac {nK}{k}},}
  the formula used for the Lincoln–Petersen method.

Sample calculation
In the example (n, K, k) = (10, 15, 5) the Lincoln–Petersen method estimates that there are 30 turtles in the lake.

  
    
      
        
          
            
              N
              ^
            
          
        
        =
        
          
            
              n
              K
            
            k
          
        
        =
        
          
            
              10
              ×
              15
            
            5
          
        
        =
        30
      
    
    {\displaystyle {\hat {N}}={\frac {nK}{k}}={\frac {10\times 15}{5}}=30}

Chapman estimator
The Lincoln–Petersen estimator is asymptotically unbiased as sample size approaches infinity, but is biased at small sample sizes. An alternative less biased estimator of population size is given by the Chapman estimator:

  
    
      
        
          
            
              
                N
                ^
              
            
          
          
            C
          
        
        =
        
          
            
              (
              n
              +
              1
              )
              (
              K
              +
              1
              )
            
            
              k
              +
              1
            
          
        
        −
        1
      
    
    {\displaystyle {\hat {N}}_{C}={\frac {(n+1)(K+1)}{k+1}}-1}

Sample calculation
The example (n, K, k) = (10, 15, 5) gives

  
    
      
        
          
            
              
                N
                ^
              
            
          
          
            C
          
        
        =
        
          
            
              (
              n
              +
              1
              )
              (
              K
              +
              1
              )
            
            
              k
              +
              1
            
          
        
        −
        1
        =
        
          
            
              11
              ×
              16
            
            6
          
        
        −
        1
        =
        28.3
      
    
    {\displaystyle {\hat {N}}_{C}={\frac {(n+1)(K+1)}{k+1}}-1={\frac {11\times 16}{6}}-1=28.3}
  Note that the answer provided by this equation must be truncated not rounded. Thus, the Chapman method estimates 28 turtles in the lake.
Surprisingly, Chapman's estimate was one conjecture from a range of possible estimators: "In practice, the whole number immediately less than (K+1)(n+1)/(k+1) or even Kn/(k+1) will be the estimate. The above form is more convenient for mathematical purposes."(see footnote, page 144). Chapman also found the estimator could have considerable negative bias for small Kn/N (page 146), but was unconcerned because the estimated standard deviations were large for these cases.

Confidence interval
An approximate 
  
    
      
        100
        (
        1
        −
        α
        )
        %
      
    
    {\displaystyle 100(1-\alpha )\%}
   confidence interval for the population size N can be obtained as:

  
    
      
        K
        +
        n
        −
        k
        −
        0.5
        +
        
          
            
              (
              K
              −
              k
              +
              0.5
              )
              (
              n
              −
              k
              +
              0.5
              )
            
            
              (
              k
              +
              0.5
              )
            
          
        
        exp
        ⁡
        (
        ±
        
          z
          
            α
            
              /
            
            2
          
        
        
          
            
              
                σ
                ^
              
            
          
          
            0.5
          
        
        )
        ,
      
    
    {\displaystyle K+n-k-0.5+{\frac {(K-k+0.5)(n-k+0.5)}{(k+0.5)}}\exp(\pm z_{\alpha /2}{\hat {\sigma }}_{0.5}),}
  
where 
  
    
      
        
          z
          
            α
            
              /
            
            2
          
        
      
    
    {\textstyle z_{\alpha /2}}
   corresponds to the 
  
    
      
        1
        −
        α
        
          /
        
        2
      
    
    {\displaystyle 1-\alpha /2}
   quantile of a standard normal random variable, and

  
    
      
        
          
            
              
                σ
                ^
              
            
          
          
            0.5
          
        
        =
        
          
            
              
                1
                
                  k
                  +
                  0.5
                
              
            
            +
            
              
                1
                
                  K
                  −
                  k
                  +
                  0.5
                
              
            
            +
            
              
                1
                
                  n
                  −
                  k
                  +
                  0.5
                
              
            
            +
            
              
                
                  k
                  +
                  0.5
                
                
                  (
                  n
                  −
                  k
                  +
                  0.5
                  )
                  (
                  K
                  −
                  k
                  +
                  0.5
                  )
                
              
            
          
        
        .
      
    
    {\displaystyle {\hat {\sigma }}_{0.5}={\sqrt {{\frac {1}{k+0.5}}+{\frac {1}{K-k+0.5}}+{\frac {1}{n-k+0.5}}+{\frac {k+0.5}{(n-k+0.5)(K-k+0.5)}}}}.}
  
The example (n, K, k) = (10, 15, 5) gives the estimate  N ≈ 30 with a 95% confidence interval of 22 to 65.
It has been shown that this confidence interval has actual coverage probabilities that are close to the nominal 
  
    
      
        100
        (
        1
        −
        α
        )
        %
      
    
    {\displaystyle 100(1-\alpha )\%}
   level even for small populations and extreme capture probabilities (near to 0 or 1), in which cases other confidence intervals fail to achieve the nominal coverage levels.

Bayesian estimate
The mean value ± standard deviation is

  
    
      
        N
        ≈
        μ
        ±
        
          
            μ
            ϵ
          
        
      
    
    {\displaystyle N\approx \mu \pm {\sqrt {\mu \epsilon }}}
  where

  
    
      
        μ
        =
        
          
            
              (
              n
              −
              1
              )
              (
              K
              −
              1
              )
            
            
              k
              −
              2
            
          
        
      
    
    {\displaystyle \mu ={\frac {(n-1)(K-1)}{k-2}}}
   for 
  
    
      
        k
        >
        2
      
    
    {\displaystyle k>2}
  

  
    
      
        ϵ
        =
        
          
            
              (
              n
              −
              k
              +
              1
              )
              (
              K
              −
              k
              +
              1
              )
            
            
              (
              k
              −
              2
              )
              (
              k
              −
              3
              )
            
          
        
      
    
    {\displaystyle \epsilon ={\frac {(n-k+1)(K-k+1)}{(k-2)(k-3)}}}
   for 
  
    
      
        k
        >
        3
      
    
    {\displaystyle k>3}
  A derivation is found here: Talk:Mark and recapture#Statistical treatment.
The example (n, K, k) = (10, 15, 5) gives the estimate  N ≈ 42 ± 21.5

Capture probability
The capture probability refers to the probability of a detecting an individual animal or person of interest, and has been used in both ecology and epidemiology for detecting animal or human diseases, respectively.
The capture probability is often defined as a two-variable model, in which f is defined as the fraction of a finite resource devoted to detecting the animal or person of interest from a high risk sector of an animal or human population, and q is the frequency of time that the problem (e.g., an animal disease) occurs in the high-risk versus the low-risk sector. For example, an application of the model in the 1920s was to detect typhoid carriers in London, who were either arriving from zones with high rates of tuberculosis (probability q that a passenger with the disease came from such an area, where q>0.5), or low rates (probability 1−q). It was posited that only 5 out of every 100 of the travelers could be detected, and 10 out of every 100 were from the high risk area. Then the capture probability P was defined as:

  
    
      
        P
        =
        
          
            5
            10
          
        
        f
        q
        +
        
          
            5
            90
          
        
        (
        1
        −
        f
        )
        (
        1
        −
        q
        )
        ,
      
    
    {\displaystyle P={\frac {5}{10}}fq+{\frac {5}{90}}(1-f)(1-q),}
  where the first term refers to the probability of detection (capture probability) in a high risk zone, and the latter term refers to the probability of detection in a low risk zone. Importantly, the formula can be re-written as a linear equation in terms of f:

  
    
      
        P
        =
        
          (
          
            
              
                5
                10
              
            
            q
            −
            
              
                5
                90
              
            
            (
            1
            −
            q
            )
          
          )
        
        f
        +
        
          
            5
            90
          
        
        (
        1
        −
        q
        )
        .
      
    
    {\displaystyle P=\left({\frac {5}{10}}q-{\frac {5}{90}}(1-q)\right)f+{\frac {5}{90}}(1-q).}
  Because this is a linear function, it follows that for certain versions of q for which the slope of this line (the first term multiplied by f) is positive, all of the detection resource should be devoted to the high-risk population (f should be set to 1 to maximize the capture probability), whereas for other value of q, for which the slope of the line is negative, all of the detection should be devoted to the low-risk population (f should be set to 0. We can solve the above equation for the values of q for which the slope will be positive to determine the values for which f should be set to 1 to maximize the capture probability:

  
    
      
        
          (
          
            
              
                5
                10
              
            
            q
            −
            
              
                5
                90
              
            
            (
            1
            −
            q
            )
          
          )
        
        >
        0
        ,
      
    
    {\displaystyle \left({\frac {5}{10}}q-{\frac {5}{90}}(1-q)\right)>0,}
  which simplifies to:

  
    
      
        q
        >
        
          
            1
            10
          
        
        .
      
    
    {\displaystyle q>{\frac {1}{10}}.}
  This is an example of linear optimization. In more complex cases, where more than one resource f is devoted to more than two areas, multivariate optimization is often used, through the simplex algorithm or its derivatives.

More than two visits
The literature on the analysis of capture-recapture studies has blossomed since the early 1990s. There are very elaborate statistical models available for the analysis of these experiments. A simple model which easily accommodates the three source, or the three visit study, is to fit a Poisson regression model. Sophisticated mark-recapture models can be fit with several packages for the Open Source R programming language.  These include "Spatially Explicit Capture-Recapture (secr)", "Loglinear Models for Capture-Recapture Experiments (Rcapture)", and "Mark-Recapture Distance Sampling (mrds)".  Such models can also be fit with specialized programs such as MARK or E-SURGE.Other related methods which are often used include the Jolly–Seber model (used in open populations and for multiple census estimates) and Schnabel estimators (an expansion to the Lincoln–Petersen method for closed populations). These are described in detail by Sutherland.

Integrated approaches
Modelling mark-recapture data is trending towards a more integrative approach, which combines mark-recapture data with population dynamics models and other types of data. The integrated approach is more computationally demanding, but extracts more information from the data improving parameter and uncertainty estimates.

See also
German tank problem, for estimation of population size when the elements are numbered.
Tag and release
Abundance estimation
GPS wildlife tracking
Shadow Effect (Genetics)

References
Besbeas, P; Freeman, S. N.; Morgan, B. J. T.; Catchpole, E. A. (2002). "Integrating mark-recapture-recovery and census data to estimate animal abundance and demographic parameters". Biometrics. 58 (3): 540–547. doi:10.1111/j.0006-341X.2002.00540.x. PMID 12229988. S2CID 30426391.
Martin-Löf, P. (1961). "Mortality rate calculations on ringed birds with special reference to the Dunlin Calidris alpina". Arkiv för Zoologi (Zoology Files), Kungliga Svenska Vetenskapsakademien (The Royal Swedish Academy of Sciences) Serie 2. Band 13 (21).
Maunder, M. N. (2004). "Population viability analysis, based on combining integrated, Bayesian, and hierarchical analyses". Acta Oecologica. 26 (2): 85–94. Bibcode:2004AcO....26...85M. doi:10.1016/j.actao.2003.11.008.
Phillips, C. A.; M. J. Dreslik; J. R. Johnson; J. E. Petzing (2001). "Application of population estimation to pond breeding salamanders". Transactions of the Illinois Academy of Science. 94 (2): 111–118.
Royle, J. A.; R. M. Dorazio (2008). Hierarchical Modeling and Inference in Ecology. Elsevier. ISBN 978-1-930665-55-2.
Seber, G.A.F. (2002). The Estimation of Animal Abundance and Related Parameters. Caldwel, New Jersey: Blackburn Press. ISBN 1-930665-55-5.
Schaub, M; Gimenez, O.; Sierro, A.; Arlettaz, R (2007). "Use of Integrated Modeling to Enhance Estimates of Population Dynamics Obtained from Limited Data" (PDF). Conservation Biology. 21 (4): 945–955. doi:10.1111/j.1523-1739.2007.00743.x. PMID 17650245. S2CID 43172823.
Williams, B. K.; J. D. Nichols; M. J. Conroy (2002). Analysis and Management of Animal Populations. San Diego, California: Academic Press. ISBN 0-12-754406-2.
Chao, A; Tsay, P. K.; Lin, S. H.; Shau, W. Y.; Chao, D. Y. (2001). "The applications of capture-recapture models to epidemiological data". Statistics in Medicine. 20 (20): 3123–3157. doi:10.1002/sim.996. PMID 11590637. S2CID 78437.

Further reading
Bonett, D.G.; Woodward, J.A.; Bentler, P.M. (1986). "A Linear Model for Estimating the Size of a Closed Population". British Journal of Mathematical and Statistical Psychology. 39: 28–40. doi:10.1111/j.2044-8317.1986.tb00843.x. PMID 3768264.
Evans, M.A.; Bonett, D.G.; McDonald, L. (1994). "A General Theory for Analyzing Capture-recapture Data in Closed Populations". Biometrics. 50 (2): 396–405. doi:10.2307/2533383. JSTOR 2533383.
Lincoln, F. C. (1930). "Calculating Waterfowl Abundance on the Basis of Banding Returns". United States Department of Agriculture Circular. 118: 1–4.
Petersen, C. G. J. (1896). "The Yearly Immigration of Young Plaice Into the Limfjord From the German Sea", Report of the Danish Biological Station (1895), 6, 5–84.
Schofield, J. R. (2007). "Beyond Defect Removal: Latent Defect Estimation With Capture-Recapture Method", Crosstalk, August 2007; 27–29.

External links
A historical introduction to capture-recapture methods
Analysis of capture-recapture data