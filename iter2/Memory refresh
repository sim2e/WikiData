Memory refresh is the process, for the purpose of preserving the information, of periodically reading information from an area of computer memory and immediately rewriting the read information to the same area without modification.  Memory refresh is a background maintenance process required during the operation of semiconductor dynamic random-access memory (DRAM), the most widely used type of computer memory, and in fact is the defining characteristic of this class of memory.In a DRAM chip, each bit of memory data is stored as the presence or absence of an electric charge on a small capacitor on the chip.  As time passes, the charges in the memory cells leak away, so without being refreshed the stored data would eventually be lost. To prevent this, external circuitry periodically reads each cell and rewrites it, restoring the charge on the capacitor to its original level.  Each memory refresh cycle refreshes a succeeding area of memory cells, thus repeatedly refreshing all the cells in a consecutive cycle. This process is typically conducted automatically in the background by the memory circuitry and is transparent to the user. While a refresh cycle is occurring the memory is not available for normal read and write operations, but in modern memory this overhead is not large enough to significantly slow down memory operation.
Electronic memory that does not require refreshing is available, called static random-access memory (SRAM). SRAM circuits require more area on a chip, because an SRAM memory cell requires four to six transistors, compared to a single transistor and a capacitor for DRAM. As a result, data density is much lower in SRAM chips than in DRAM, and SRAM has higher price per bit. Therefore, DRAM is used for the main memory in computers, video game consoles, graphics cards and applications requiring large capacities and low cost. The need for memory refresh makes DRAM timing and circuits significantly more complicated than SRAM circuits, but the density and cost advantages of DRAM justify this complexity.

How DRAM refresh works
While the memory is operating, each memory cell must be refreshed repetitively, within the maximum interval between refreshes specified by the manufacturer, which is usually in the millisecond region. Refreshing does not employ the normal memory operations (read and write cycles) used to access data, but specialized cycles called refresh cycles which are generated by separate counter circuits in the memory circuitry and interspersed between normal memory accesses.The storage cells on a memory chip are laid out in a rectangular array of rows and columns. The read process in DRAM is destructive and removes the charge on the memory cells in an entire row, so there is a row of specialized latches on the chip called sense amplifiers, one for each column of memory cells, to temporarily hold the data. During a normal read operation, the sense amplifiers after reading and latching the data, rewrite the data in the accessed row before sending the bit from a single column to output. This means the normal read electronics on the chip can refresh an entire row of memory in parallel, significantly speeding up the refresh process. A normal read or write cycle refreshes a row of memory, but normal memory accesses cannot be relied on to hit all the rows within the necessary time, necessitating a separate refresh process. Rather than use the normal read cycle in the refresh process, to save time an abbreviated cycle called a refresh cycle is used. The refresh cycle is similar to the read cycle, but executes faster for two reasons:

For a refresh, only the row address is needed, so a column address doesn't have to be applied to the chip address circuits.
Data read from the cells does not need to be fed into the output buffers or the data bus to send to the CPU.The refresh circuitry must perform a refresh cycle on each of the rows on the chip within the refresh time interval, to make sure that each cell gets refreshed.

Types of refresh circuits
Although in some early systems the microprocessor controlled refresh, with a timer triggering a periodic interrupt that ran a subroutine that performed the refresh, this meant the microprocessor could not be paused, single-stepped, or put into energy-saving hibernation without stopping the refresh process and losing the data in memory. So in modern systems refresh is handled by circuits in the memory controller, which may be embedded in the chip itself. Some DRAM chips, such as pseudostatic RAM (PSRAM), have all the refresh circuitry on the chip, and function like static RAM as far as the rest of the computer is concerned.Usually the refresh circuitry consists of a refresh counter which contains the address of the row to be refreshed which is applied to the chip's row address lines, and a timer that increments the counter to step through the rows.  This counter may be part of the memory controller circuitry, or on the memory chip itself.  Two scheduling strategies have been used:
Burst refresh – a series of refresh cycles are performed one after another until all the rows have been refreshed, after which normal memory accesses occur until the next refresh is required
Distributed refresh – refresh cycles are performed at regular intervals, interspersed with memory accesses.Burst refresh results in long periods when the memory is unavailable, so distributed refresh has been used in most modern systems, particularly in real time systems. In distributed refresh, the interval between refresh cycles is

  
    
      
        
          refresh cycle interval
        
        =
        
          refresh time
        
        
        
          /
        
        
        
          number of rows
        
        
      
    
    {\displaystyle {\text{refresh cycle interval}}={\text{refresh time}}\,/\,{\text{number of rows}}\,}
  For example, DDR SDRAM has a refresh time of 64 ms and 8,192 rows, so the refresh cycle interval is 7.8 μs.Recent generations of DRAM chips contain an integral refresh counter, and the memory control circuitry can either use this counter or provide a row address from an external counter. These chips have three standard ways to provide refresh, selected by different patterns of signals on the "column select" (CAS) and "row select" (RAS) lines:
"RAS only refresh" – In this mode the address of the row to refresh is provided by the address bus lines, so it is used with external counters in the memory controller.
"CAS before RAS refresh" (CBR) – In this mode the on-chip counter keeps track of the row to be refreshed and the external circuit merely initiates the refresh cycles. This mode uses less power because the memory address bus buffers don't have to be powered up. It is used in most modern computers.
"Hidden refresh" – This is an alternate version of the CBR refresh cycle which can be combined with a preceding read or write cycle. The refresh is done in parallel during the data transfer, saving time.Since the 2012 generation of DRAM chips, the "RAS only" mode has been eliminated, and the internal counter is used to generate refresh. The chip has an additional sleep mode, for use when the computer is in sleep mode, in which an on-chip oscillator generates internal refresh cycles so that the external clock can be shut down.

Refresh overhead
The fraction of time the memory spends on refresh, the refresh overhead, can be calculated from the system timing:

  
    
      
        
          refresh overhead
        
        =
        
          
            time required for refresh, ms
            refresh interval, ms
          
        
        
      
    
    {\displaystyle {\text{refresh overhead}}={\frac {\text{time required for refresh, ms}}{\text{refresh interval, ms}}}\,}
  For example, an SDRAM chip has 213 = 8,192 rows, a refresh interval of 64 ms, the memory bus runs at 133 MHz, and the refresh cycle takes 4 clock cycles.  The time for a refresh cycle is

  
    
      
        
          length of refresh cycle
        
        =
        4
        
          /
        
        f
        =
        
          
            4
            
              1.33
              (
              
                10
                
                  8
                
              
              )
              
              
                Hz
              
            
          
        
        =
        30
        
        
          ns
        
        
      
    
    {\displaystyle {\text{length of refresh cycle}}=4/f={\frac {4}{1.33(10^{8})\,{\text{Hz}}}}=30\,{\text{ns}}\,}
  

  
    
      
        
          time required for refresh
        
        =
        (
        
          length of refresh cycle
        
        )
        (
        
          rows
        
        )
        =
        (
        30
        
        
          ns
        
        )
        (
        8192
        )
        =
        0.246
        
        
          ms
        
        
      
    
    {\displaystyle {\text{time required for refresh}}=({\text{length of refresh cycle}})({\text{rows}})=(30\,{\text{ns}})(8192)=0.246\,{\text{ms}}\,}
  

  
    
      
        
          refresh overhead
        
        =
        
          
            
              0.246
              
              
                ms
              
            
            
              64
              
              
                ms
              
            
          
        
        =
        .0038
        
      
    
    {\displaystyle {\text{refresh overhead}}={\frac {0.246\,{\text{ms}}}{64\,{\text{ms}}}}=.0038\,}
  So less than 0.4% of the memory chip's time will be taken by refresh cycles.  
In SDRAM chips, the memory in each chip is divided into banks which are refreshed in parallel, saving further time.  So the number of refresh cycles needed is the number of rows in a single bank, given in the specifications, which in the 2012 generation of chips has been frozen at 8,192.

Refresh interval
The maximum time interval between refresh operations is standardized by JEDEC for each DRAM technology, and is specified in the manufacturer's chip specifications. It is usually in the range of milliseconds for DRAM and microseconds for eDRAM. For DDR2 SDRAM chips it is 64 ms.: 20  It depends on the ratio of charge stored in the memory cell capacitors to leakage currents. Despite the fact that the geometry of the capacitors has been shrinking with each new generation of memory chips, so later generation capacitors store less charge, refresh times for DRAM have been improving; from 8 ms for 1M chips, 32 ms for 16M chips, to 64 ms for 256M chips. This improvement is achieved mainly by developing transistors that cause significantly less leakage. Longer refresh time means a smaller fraction of the device's time is occupied with refresh, leaving more time for memory accesses. Although refresh overhead occupied up to 10% of chip time in earlier DRAMs, in modern chips this fraction is less than 1%.Because the leakage currents in semiconductors increase with temperature, refresh times must be decreased at high temperature. DDR2 SDRAM chips have a temperature-compensated refresh structure; refresh cycle time must be halved when chip case temperature exceeds 85 °C (185 °F).: 49 The actual persistence of readable charge values and thus data in most DRAM memory cells is much longer than the refresh time, up to 1–10 seconds.  However transistor leakage currents vary widely between different memory cells on the same chip due to process variation. In order to make sure that all the memory cells are refreshed before a single bit is lost, manufacturers must set their refresh times conservatively short.This frequent DRAM refresh consumes a third of the total power drawn by low-power electronics devices in standby mode.
Researchers have proposed several approaches for extending battery run-time between charges by reducing the refresh rate, including temperature-compensated refresh (TCR) and retention-aware placement in DRAM (RAPID).
Experiments show that in a typical off-the-shelf DRAM chip, only a few weak cells really require the worst-case 64 ms refresh interval, and even then only at the high end of its specified temperature range.
At room temperature (e.g. 24 °C (75 °F)), those same weak cells need to be refreshed once every 500 ms for correct operation. If the system can avoid using the weakest 1% of pages, a typical DRAM only needs to be refreshed once a second, even at 70 °C (158 °F), for correct operation of the remaining 99% of the pages.
Some experiments combine these two complementary techniques, giving correct operation at room temperature at refresh intervals of 10 seconds.For error-tolerant applications (e.g. graphics applications), refreshing non-critical data stored in DRAM or eDRAM at a rate lower than their retention period saves energy with minor quality loss, which is an example of approximate computing.

SRAM and DRAM memory technologies
SRAM
In static random-access memory (SRAM), another type of semiconductor memory, the data is not stored as charge on a capacitor, but in a pair of a cross-coupled inverters, so SRAM does not need to be refreshed. The two basic types of memory have advantages and disadvantages. Static memory can be considered permanent while powered on, i.e. once written the memory stays until specifically changed and thus, its use tends to be simple in terms of system design. However, the internal construction of each SRAM cell requires six transistors, compared to the single transistor required for a DRAM cell, so the density of SRAM is much lower and price-per-bit much higher than DRAM.

CPU-based refresh
Some early microprocessors (e.g. the Zilog Z80) provided special internal registers that could provide the Row-Address Strobe (RAS) to refresh dynamic memory cells, the register being incremented on each refresh cycle. This could also be accomplished by other integrated circuits already being used in the system, if these already generated cycling accesses across RAM (e.g. the Motorola 6845). In CPUs such as the Z80, the availability of a RAS refresh was a big selling-point due to its simplifying hardware design. Here, RAS refresh is signalled by a unique combination of address and control wires during operationally redundant clock cycles (T-States), i.e. during instruction decode/execution when the buses may not be required. Instead of the bus being inactive during such T-states, the refresh register would be presented on the address bus along with a combination of control wires to indicate to the refresh circuitry.
In early versions of the Z80, the ubiquity of 16 kB RAM chips (i.e. having 128 rows) and something of a lack of foresight resulted in the R register only incrementing over a 7 bit-wide range (0–127, i.e. 128 rows); the 8th bit could be set by the user, but would be left unchanged by the internal cycling. With the rapid advent of 64 kbit+ DRAM chips (with an 8 bit RAS), extra circuitry or logic had to be built around the refresh signal to synthesize the missing 8th bit and prevent blocks of memory being lost after a few milliseconds. In some contexts, it was possible to utilise interrupts to flip the 8th bit at the appropriate time and thus cover the entire range of the R register (256 rows). Another method, perhaps more universal but also more complex in terms of hardware, was to use an 8-bit counter chip, whose output would provide the refresh RAS address instead of the R register: the refresh signal from the CPU was used as the clock for this counter, resulting in the memory row to be refreshed being incremented with each refresh cycle. Later versions and licensed "work-alikes" of the Z80 core remedied the non-inclusion of the 8th bit in automatic cycling, and modern CPUs have greatly expanded on such basic provisioning to provide rich all-in-one solutions for DRAM refresh.

Pseudostatic DRAM
Pseudostatic RAM (PSRAM or PSDRAM) is dynamic RAM with built-in refresh and address-control circuitry to make it behave similarly to static RAM (SRAM). It combines the high density of DRAM with the ease of use of true SRAM. PSRAM (made by Numonyx) is used in the Apple iPhone and other embedded systems.Some DRAM components have a "self-refresh mode", which involves much of the same logic that is needed for pseudo-static operation, but this mode is often equivalent to a standby mode. It is provided primarily to allow a system to suspend operation of its DRAM controller to save power without losing data stored in DRAM, rather not to allow operation without a separate DRAM controller as is the case with PSRAM. An embedded variant of PSRAM is sold by MoSys under the name 1T-SRAM. It is technically DRAM, but behaves much like SRAM, and is used in the GameCube and Wii consoles.

Other memory technologies using refresh
Several early computer memory technologies also required periodical processes similar in purpose to the memory refreshing. The Williams tube has the closest similarity, since, as with DRAM, it is essentially a capacitive memory in which the values stored for each bit would gradually decay unless refreshed.
In magnetic-core memory, each memory cell can retain data indefinitely even with the power turned off, but reading the data from any memory cell erases its contents. As a consequence, the memory controller typically added a refresh cycle after each read cycle in order to create the illusion of a non-destructive read operation.
Delay-line memory requires constant refreshing because the data is actually stored as a signal in a transmission line. In this case, the refresh rate is comparable to the memory access time.

See also
Memory scrubbing
Row hammer


== References ==