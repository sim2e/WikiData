In numerical analysis and linear algebra, lower–upper (LU) decomposition or factorization factors a matrix as the product of a lower triangular matrix and an upper triangular matrix (see matrix decomposition). The product sometimes includes a permutation matrix as well. LU decomposition can be viewed as the matrix form of Gaussian elimination. Computers usually solve square systems of linear equations using LU decomposition, and it is also a key step when inverting a matrix or computing the determinant of a matrix. The LU decomposition was introduced by the Polish astronomer Tadeusz Banachiewicz in 1938. To quote: "It appears that Gauss and Doolittle applied the method
[of elimination] only to symmetric equations. More recent authors, for example, Aitken, Banachiewicz, Dwyer, and Crout … have emphasized the use of the method, or variations of it, in connection with non-symmetric problems … Banachiewicz … saw the point … that the basic problem is really one of matrix factorization, or “decomposition” as he called it."
It's also referred to as LR decomposition (factors into left and right triangular matrices).

Definitions
Let A be a square matrix. An LU factorization refers to the factorization of A, with proper row and/or column orderings or permutations, into two factors – a lower triangular matrix L and an upper triangular matrix U:

  
    
      
        A
        =
        L
        U
        .
      
    
    {\displaystyle A=LU.}
  In the lower triangular matrix all elements above the diagonal are zero, in the upper triangular matrix, all the elements below the diagonal are zero. For example, for a 3 × 3 matrix A, its LU decomposition looks like this:

  
    
      
        
          
            [
            
              
                
                  
                    a
                    
                      11
                    
                  
                
                
                  
                    a
                    
                      12
                    
                  
                
                
                  
                    a
                    
                      13
                    
                  
                
              
              
                
                  
                    a
                    
                      21
                    
                  
                
                
                  
                    a
                    
                      22
                    
                  
                
                
                  
                    a
                    
                      23
                    
                  
                
              
              
                
                  
                    a
                    
                      31
                    
                  
                
                
                  
                    a
                    
                      32
                    
                  
                
                
                  
                    a
                    
                      33
                    
                  
                
              
            
            ]
          
        
        =
        
          
            [
            
              
                
                  
                    ℓ
                    
                      11
                    
                  
                
                
                  0
                
                
                  0
                
              
              
                
                  
                    ℓ
                    
                      21
                    
                  
                
                
                  
                    ℓ
                    
                      22
                    
                  
                
                
                  0
                
              
              
                
                  
                    ℓ
                    
                      31
                    
                  
                
                
                  
                    ℓ
                    
                      32
                    
                  
                
                
                  
                    ℓ
                    
                      33
                    
                  
                
              
            
            ]
          
        
        
          
            [
            
              
                
                  
                    u
                    
                      11
                    
                  
                
                
                  
                    u
                    
                      12
                    
                  
                
                
                  
                    u
                    
                      13
                    
                  
                
              
              
                
                  0
                
                
                  
                    u
                    
                      22
                    
                  
                
                
                  
                    u
                    
                      23
                    
                  
                
              
              
                
                  0
                
                
                  0
                
                
                  
                    u
                    
                      33
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\begin{bmatrix}a_{11}&a_{12}&a_{13}\\a_{21}&a_{22}&a_{23}\\a_{31}&a_{32}&a_{33}\end{bmatrix}}={\begin{bmatrix}\ell _{11}&0&0\\\ell _{21}&\ell _{22}&0\\\ell _{31}&\ell _{32}&\ell _{33}\end{bmatrix}}{\begin{bmatrix}u_{11}&u_{12}&u_{13}\\0&u_{22}&u_{23}\\0&0&u_{33}\end{bmatrix}}.}
  Without a proper ordering or permutations in the matrix, the factorization may fail to materialize. For example, it is easy to verify (by expanding the matrix multiplication) that 
  
    
      
        
          a
          
            11
          
        
        =
        
          ℓ
          
            11
          
        
        
          u
          
            11
          
        
      
    
    {\textstyle a_{11}=\ell _{11}u_{11}}
  . If 
  
    
      
        
          a
          
            11
          
        
        =
        0
      
    
    {\textstyle a_{11}=0}
  , then at least one of 
  
    
      
        
          ℓ
          
            11
          
        
      
    
    {\textstyle \ell _{11}}
   and 
  
    
      
        
          u
          
            11
          
        
      
    
    {\textstyle u_{11}}
   has to be zero, which implies that either L or U is singular. This is impossible if A is nonsingular (invertible). This is a procedural problem. It can be removed by simply reordering the rows of A so that the first element of the permuted matrix is nonzero. The same problem in subsequent factorization steps can be removed the same way; see the basic procedure below.

LU factorization with partial pivoting
It turns out that a proper permutation in rows (or columns) is sufficient for LU factorization. LU factorization with partial pivoting (LUP) refers often to LU factorization with row permutations only:

  
    
      
        P
        A
        =
        L
        U
        ,
      
    
    {\displaystyle PA=LU,}
  where L and U are again lower and upper triangular matrices, and P is a permutation matrix, which, when left-multiplied to A, reorders the rows of A. It turns out that all square matrices can be factorized in this form, and the factorization is numerically stable in practice. This makes LUP decomposition a useful technique in practice.

LU factorization with full pivoting
An LU factorization with full pivoting involves both row and column permutations:

  
    
      
        P
        A
        Q
        =
        L
        U
        ,
      
    
    {\displaystyle PAQ=LU,}
  where L, U and P are defined as before, and Q is a permutation matrix that reorders the columns of A.

Lower-diagonal-upper (LDU) decomposition
A Lower-diagonal-upper (LDU) decomposition is a decomposition of the form

  
    
      
        A
        =
        L
        D
        U
        ,
      
    
    {\displaystyle A=LDU,}
  where D is a diagonal matrix, and L and U are unitriangular matrices, meaning that all the entries on the diagonals of L and U are one.

Rectangular matrices
Above we required that A be a square matrix, but these decompositions can all be generalized to rectangular matrices as well. In that case, L and D are square matrices both of which have the same number of rows as A, and U has exactly the same dimensions as A. Upper triangular should be interpreted as having only zero entries below the main diagonal, which starts at the upper left corner. Similarly, the more precise term for U is that it is the "row echelon form" of the matrix A.

Example
We factor the following 2-by-2 matrix:

  
    
      
        
          
            [
            
              
                
                  4
                
                
                  3
                
              
              
                
                  6
                
                
                  3
                
              
            
            ]
          
        
        =
        
          
            [
            
              
                
                  
                    ℓ
                    
                      11
                    
                  
                
                
                  0
                
              
              
                
                  
                    ℓ
                    
                      21
                    
                  
                
                
                  
                    ℓ
                    
                      22
                    
                  
                
              
            
            ]
          
        
        
          
            [
            
              
                
                  
                    u
                    
                      11
                    
                  
                
                
                  
                    u
                    
                      12
                    
                  
                
              
              
                
                  0
                
                
                  
                    u
                    
                      22
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\begin{bmatrix}4&3\\6&3\end{bmatrix}}={\begin{bmatrix}\ell _{11}&0\\\ell _{21}&\ell _{22}\end{bmatrix}}{\begin{bmatrix}u_{11}&u_{12}\\0&u_{22}\end{bmatrix}}.}
  One way to find the LU decomposition of this simple matrix would be to simply solve the linear equations by inspection. Expanding the matrix multiplication gives

  
    
      
        
          
            
              
                
                  ℓ
                  
                    11
                  
                
                ⋅
                
                  u
                  
                    11
                  
                
                +
                0
                ⋅
                0
              
              
                
                =
                4
              
            
            
              
                
                  ℓ
                  
                    11
                  
                
                ⋅
                
                  u
                  
                    12
                  
                
                +
                0
                ⋅
                
                  u
                  
                    22
                  
                
              
              
                
                =
                3
              
            
            
              
                
                  ℓ
                  
                    21
                  
                
                ⋅
                
                  u
                  
                    11
                  
                
                +
                
                  ℓ
                  
                    22
                  
                
                ⋅
                0
              
              
                
                =
                6
              
            
            
              
                
                  ℓ
                  
                    21
                  
                
                ⋅
                
                  u
                  
                    12
                  
                
                +
                
                  ℓ
                  
                    22
                  
                
                ⋅
                
                  u
                  
                    22
                  
                
              
              
                
                =
                3.
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\ell _{11}\cdot u_{11}+0\cdot 0&=4\\\ell _{11}\cdot u_{12}+0\cdot u_{22}&=3\\\ell _{21}\cdot u_{11}+\ell _{22}\cdot 0&=6\\\ell _{21}\cdot u_{12}+\ell _{22}\cdot u_{22}&=3.\end{aligned}}}
  This system of equations is underdetermined. In this case any two non-zero elements of L and U matrices are parameters of the solution and can be set arbitrarily to any non-zero value. Therefore, to find the unique LU decomposition, it is necessary to put some restriction on L and U matrices. For example, we can conveniently require the lower triangular matrix L to be a unit triangular matrix (i.e. set all the entries of its main diagonal to ones). Then the system of equations has the following solution:

  
    
      
        
          
            
              
                
                  ℓ
                  
                    11
                  
                
                =
                
                  ℓ
                  
                    22
                  
                
              
              
                
                =
                1
              
            
            
              
                
                  ℓ
                  
                    21
                  
                
              
              
                
                =
                1.5
              
            
            
              
                
                  u
                  
                    11
                  
                
              
              
                
                =
                4
              
            
            
              
                
                  u
                  
                    12
                  
                
              
              
                
                =
                3
              
            
            
              
                
                  u
                  
                    22
                  
                
              
              
                
                =
                −
                1.5
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\ell _{11}=\ell _{22}&=1\\\ell _{21}&=1.5\\u_{11}&=4\\u_{12}&=3\\u_{22}&=-1.5\end{aligned}}}
  Substituting these values into the LU decomposition above yields

  
    
      
        
          
            [
            
              
                
                  4
                
                
                  3
                
              
              
                
                  6
                
                
                  3
                
              
            
            ]
          
        
        =
        
          
            [
            
              
                
                  1
                
                
                  0
                
              
              
                
                  1.5
                
                
                  1
                
              
            
            ]
          
        
        
          
            [
            
              
                
                  4
                
                
                  3
                
              
              
                
                  0
                
                
                  −
                  1.5
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\begin{bmatrix}4&3\\6&3\end{bmatrix}}={\begin{bmatrix}1&0\\1.5&1\end{bmatrix}}{\begin{bmatrix}4&3\\0&-1.5\end{bmatrix}}.}

Existence and uniqueness
Square matrices
Any square matrix 
  
    
      
        A
      
    
    {\textstyle A}
   admits LUP and PLU factorizations. If 
  
    
      
        A
      
    
    {\textstyle A}
   is invertible, then it admits an LU (or LDU) factorization if and only if all its leading principal minors are nonzero (for example 
  
    
      
        
          
            [
            
              
                
                  0
                
                
                  1
                
              
              
                
                  1
                
                
                  0
                
              
            
            ]
          
        
      
    
    {\displaystyle {\begin{bmatrix}0&1\\1&0\end{bmatrix}}}
  
does not admit an LU or LDU factorization). If 
  
    
      
        A
      
    
    {\textstyle A}
   is a singular matrix of rank 
  
    
      
        k
      
    
    {\textstyle k}
  , then it admits an LU factorization if the first 
  
    
      
        k
      
    
    {\textstyle k}
   leading principal minors are nonzero, although the converse is not true.If a square, invertible matrix has an LDU (factorization with all diagonal entries of L and U equal to 1), then the factorization is unique. In that case, the LU factorization is also unique if we require that the diagonal of 
  
    
      
        L
      
    
    {\textstyle L}
   (or 
  
    
      
        U
      
    
    {\textstyle U}
  ) consists of ones.
In general, any square matrix 
  
    
      
        
          A
          
            n
            ×
            n
          
        
      
    
    {\displaystyle A_{n\times n}}
   could have one of the following:

a unique LU factorization (as mentioned above);
infinitely many LU factorizations if two or more of any first (n−1) columns are linearly dependent or any of the first (n−1) columns are 0;
no LU factorization if the first (n−1) columns are non-zero and linearly independent and at least one leading principal minor is zero.In Case 3, one can approximate an LU factorization by changing a diagonal entry 
  
    
      
        
          a
          
            j
            j
          
        
      
    
    {\displaystyle a_{jj}}
    to 
  
    
      
        
          a
          
            j
            j
          
        
        ±
        ε
      
    
    {\displaystyle a_{jj}\pm \varepsilon }
    to avoid a zero leading principal minor.

Symmetric positive-definite matrices
If A is a symmetric (or Hermitian, if A is complex) positive-definite matrix, we can arrange matters so that U is the conjugate transpose of L. That is, we can write A as

  
    
      
        A
        =
        L
        
          L
          
            ∗
          
        
        .
        
      
    
    {\displaystyle A=LL^{*}.\,}
  This decomposition is called the Cholesky decomposition. The Cholesky decomposition always exists and is unique — provided the matrix is positive definite. Furthermore, computing the Cholesky decomposition is more efficient and numerically more stable than computing some other LU decompositions.

General matrices
For a (not necessarily invertible) matrix over any field, the exact necessary and sufficient conditions under which it has an LU factorization are known. The conditions are expressed in terms of the ranks of certain submatrices. The Gaussian elimination algorithm for obtaining LU decomposition has also been extended to this most general case.

Algorithms
Closed formula
When an LDU factorization exists and is unique, there is a closed (explicit) formula for the elements of L, D, and U in terms of ratios of determinants of certain submatrices of the original matrix A. In particular, 
  
    
      
        
          D
          
            1
          
        
        =
        
          A
          
            1
            ,
            1
          
        
      
    
    {\textstyle D_{1}=A_{1,1}}
  , and for 
  
    
      
        i
        =
        2
        ,
        …
        ,
        n
      
    
    {\textstyle i=2,\ldots ,n}
  , 
  
    
      
        
          D
          
            i
          
        
      
    
    {\textstyle D_{i}}
   is the ratio of the 
  
    
      
        i
      
    
    {\textstyle i}
  -th principal submatrix to the 
  
    
      
        (
        i
        −
        1
        )
      
    
    {\textstyle (i-1)}
  -th principal submatrix. Computation of the determinants is computationally expensive, so this explicit formula is not used in practice.

Using Gaussian elimination
The following algorithm is essentially a modified form of Gaussian elimination. Computing an LU decomposition using this algorithm requires 
  
    
      
        
          
            
              2
              3
            
          
        
        
          n
          
            3
          
        
      
    
    {\displaystyle {\tfrac {2}{3}}n^{3}}
   floating-point operations, ignoring lower-order terms. Partial pivoting adds only a quadratic term; this is not the case for full pivoting.

Generalized explanation
Notation
Given an N × N matrix 
  
    
      
        A
        =
        (
        
          a
          
            i
            ,
            j
          
        
        
          )
          
            1
            ≤
            i
            ,
            j
            ≤
            N
          
        
      
    
    {\displaystyle A=(a_{i,j})_{1\leq i,j\leq N}}
  , define 
  
    
      
        
          A
          
            (
            0
            )
          
        
      
    
    {\displaystyle A^{(0)}}
   as the original, unmodified version of the matrix 
  
    
      
        A
      
    
    {\displaystyle A}
  .  The parenthetical superscript (e.g., 
  
    
      
        (
        0
        )
      
    
    {\displaystyle (0)}
  ) of the matrix 
  
    
      
        A
      
    
    {\displaystyle A}
   is the version of the matrix. The matrix 
  
    
      
        
          A
          
            (
            n
            )
          
        
      
    
    {\displaystyle A^{(n)}}
   is the 
  
    
      
        A
      
    
    {\displaystyle A}
   matrix in which the elements below the main diagonal have already been eliminated to 0 through Gaussian elimination for the first 
  
    
      
        n
      
    
    {\displaystyle n}
   columns.
Below is a matrix to observe to help us remember the notation (where each 
  
    
      
        ∗
      
    
    {\displaystyle *}
   represents any real number in the matrix):

  
    
      
        
          A
          
            (
            n
            −
            1
            )
          
        
        =
        
          
            (
            
              
                
                  ∗
                
                
                
                
                  ⋯
                
                
                
                
                  ∗
                
              
              
                
                  0
                
                
                  ⋱
                
                
                
                
                
              
              
                
                
                  ⋱
                
                
                  ∗
                
                
                
                
              
              
                
                  ⋮
                
                
                
                  0
                
                
                  
                    a
                    
                      n
                      ,
                      n
                    
                    
                      (
                      n
                      −
                      1
                      )
                    
                  
                
                
                
                
                  ⋮
                
              
              
                
                
                
                  ⋮
                
                
                  
                    a
                    
                      i
                      ,
                      n
                    
                    
                      (
                      n
                      −
                      1
                      )
                    
                  
                
                
                  ∗
                
              
              
                
                
                
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
              
              
                
                  0
                
                
                  ⋯
                
                
                  0
                
                
                  
                    a
                    
                      i
                      ,
                      n
                    
                    
                      (
                      n
                      −
                      1
                      )
                    
                  
                
                
                  ∗
                
                
                  ⋯
                
                
                  ∗
                
              
            
            )
          
        
      
    
    {\displaystyle A^{(n-1)}={\begin{pmatrix}*&&&\cdots &&&*\\0&\ddots &&&&\\&\ddots &*&&&\\\vdots &&0&a_{n,n}^{(n-1)}&&&\vdots \\&&\vdots &a_{i,n}^{(n-1)}&*\\&&&\vdots &\vdots &\ddots \\0&\cdots &0&a_{i,n}^{(n-1)}&*&\cdots &*\end{pmatrix}}}

Procedure
During this process, we gradually modify the matrix 
  
    
      
        A
      
    
    {\displaystyle A}
   using row operations until it becomes the matrix 
  
    
      
        U
      
    
    {\displaystyle U}
   in which all the elements below the main diagonal are equal to zero. During this, we will simultaneously create two separate matrices 
  
    
      
        P
      
    
    {\displaystyle P}
   and 
  
    
      
        L
      
    
    {\displaystyle L}
  , such that 
  
    
      
        P
        A
        =
        L
        U
      
    
    {\displaystyle PA=LU}
  .
We define the final permutation matrix 
  
    
      
        P
      
    
    {\displaystyle P}
   as the identity matrix which has all the same rows swapped in the same order as the 
  
    
      
        A
      
    
    {\displaystyle A}
   matrix while it transforms into the matrix 
  
    
      
        U
      
    
    {\displaystyle U}
  . For our matrix 
  
    
      
        
          A
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle A^{(n-1)}}
  , we may start by swapping rows to provide the desired conditions for the n-th column. For example, we might swap rows to perform partial pivoting, or we might do it to set the pivot element 
  
    
      
        
          a
          
            n
            ,
            n
          
        
      
    
    {\displaystyle a_{n,n}}
   on the main diagonal to a non-zero number so that we can complete the Gaussian elimination.
For our matrix 
  
    
      
        
          A
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle A^{(n-1)}}
  , we want to set every element below 
  
    
      
        
          a
          
            n
            ,
            n
          
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle a_{n,n}^{(n-1)}}
   to zero (where 
  
    
      
        
          a
          
            n
            ,
            n
          
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle a_{n,n}^{(n-1)}}
   is the element in the n-th column of the main diagonal). We will denote each element below 
  
    
      
        
          a
          
            n
            ,
            n
          
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle a_{n,n}^{(n-1)}}
   as 
  
    
      
        
          a
          
            i
            ,
            n
          
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle a_{i,n}^{(n-1)}}
   (where 
  
    
      
        i
        =
        n
        +
        1
        ,
        …
        ,
        N
      
    
    {\displaystyle i=n+1,\dotsc ,N}
  ). To set 
  
    
      
        
          a
          
            i
            ,
            n
          
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle a_{i,n}^{(n-1)}}
   to zero, we set 
  
    
      
        r
        o
        
          w
          
            i
          
        
        =
        r
        o
        
          w
          
            i
          
        
        −
        (
        
          ℓ
          
            i
            ,
            n
          
        
        )
        ⋅
        r
        o
        
          w
          
            n
          
        
      
    
    {\displaystyle row_{i}=row_{i}-(\ell _{i,n})\cdot row_{n}}
   for each row 
  
    
      
        i
      
    
    {\displaystyle i}
  . For this operation, 
  
    
      
        
          ℓ
          
            i
            ,
            n
          
        
        :=
        
          
            a
            
              i
              ,
              n
            
            
              (
              n
              −
              1
              )
            
          
        
        
          /
        
        
          
            a
            
              n
              ,
              n
            
            
              (
              n
              −
              1
              )
            
          
        
      
    
    {\textstyle \ell _{i,n}:={a_{i,n}^{(n-1)}}/{a_{n,n}^{(n-1)}}}
  . Once we have performed the row operations for the first 
  
    
      
        N
        −
        1
      
    
    {\displaystyle N-1}
   columns, we have obtained an upper triangular matrix 
  
    
      
        
          A
          
            (
            N
            −
            1
            )
          
        
      
    
    {\displaystyle A^{(N-1)}}
   which is denoted by 
  
    
      
        U
      
    
    {\displaystyle U}
  . 
We can also create the lower triangular matrix denoted as 
  
    
      
        L
      
    
    {\textstyle L}
  , by directly inputting the previously calculated values of 
  
    
      
        
          ℓ
          
            i
            ,
            n
          
        
      
    
    {\displaystyle \ell _{i,n}}
   via the formula below.

  
    
      
        L
        =
        
          
            (
            
              
                
                  1
                
                
                  0
                
                
                  ⋯
                
                
                  0
                
              
              
                
                  
                    ℓ
                    
                      2
                      ,
                      1
                    
                  
                
                
                  ⋱
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋱
                
                
                  0
                
              
              
                
                  
                    ℓ
                    
                      N
                      ,
                      1
                    
                  
                
                
                  ⋯
                
                
                  
                    ℓ
                    
                      N
                      ,
                      N
                      −
                      1
                    
                  
                
                
                  1
                
              
            
            )
          
        
      
    
    {\displaystyle L={\begin{pmatrix}1&0&\cdots &0\\\ell _{2,1}&\ddots &\ddots &\vdots \\\vdots &\ddots &\ddots &0\\\ell _{N,1}&\cdots &\ell _{N,N-1}&1\end{pmatrix}}}

Example
If we are given the matrixwe will choose to implement partial pivoting and thus swap the first and second row so that our matrix 
  
    
      
        A
      
    
    {\displaystyle A}
   and the first iteration of our 
  
    
      
        P
      
    
    {\displaystyle P}
   matrix respectively becomeOnce we have swapped the rows, we can eliminate the elements below the main diagonal on the first column by performing such that,Once these rows have been subtracted, we have derived from 
  
    
      
        
          A
          
            (
            1
            )
          
        
      
    
    {\displaystyle A^{(1)}}
   the matrix Because we are implementing partial pivoting, we swap the second and third rows of our derived matrix and the current version of our 
  
    
      
        P
      
    
    {\displaystyle P}
   matrix respectively to obtainNow, we eliminate the elements below the main diagonal on the second column by performing 
  
    
      
        r
        o
        
          w
          
            3
          
        
        =
        r
        o
        
          w
          
            3
          
        
        −
        (
        
          ℓ
          
            3
            ,
            2
          
        
        )
        ⋅
        r
        o
        
          w
          
            2
          
        
      
    
    {\displaystyle row_{3}=row_{3}-(\ell _{3,2})\cdot row_{2}}
   such that 
  
    
      
        
          ℓ
          
            3
            ,
            2
          
        
        =
        
          
            5
            6
          
        
      
    
    {\textstyle \ell _{3,2}={\frac {5}{6}}}
  . Because no non-zero elements exist below the main diagonal in our current iteration of 
  
    
      
        A
      
    
    {\displaystyle A}
   after this row subtraction, this row subtraction derives our final 
  
    
      
        A
      
    
    {\displaystyle A}
   matrix (denoted as 
  
    
      
        U
      
    
    {\displaystyle U}
  ) and final 
  
    
      
        P
      
    
    {\displaystyle P}
   matrix:Now we can obtain our final 
  
    
      
        L
      
    
    {\displaystyle L}
   matrix:Now these matrices have a relation such that 
  
    
      
        P
        A
        =
        L
        U
      
    
    {\displaystyle PA=LU}
  .

Relations when no rows are swapped
If we did not swap rows at all during this process, we can perform the row operations simultaneously for each column 
  
    
      
        n
      
    
    {\displaystyle n}
   by setting 
  
    
      
        
          A
          
            (
            n
            )
          
        
        :=
        
          L
          
            n
          
          
            −
            1
          
        
        
          A
          
            (
            n
            −
            1
            )
          
        
        ,
      
    
    {\displaystyle A^{(n)}:=L_{n}^{-1}A^{(n-1)},}
   where 
  
    
      
        
          L
          
            n
          
          
            −
            1
          
        
      
    
    {\displaystyle L_{n}^{-1}}
   is the N × N identity matrix with its n-th column replaced by the transposed vector 
  
    
      
        
          
            
              (
              
                
                  
                    0
                  
                  
                    ⋯
                  
                  
                    0
                  
                  
                    1
                  
                  
                    −
                    
                      ℓ
                      
                        n
                        +
                        1
                        ,
                        n
                      
                    
                  
                  
                    ⋯
                  
                  
                    −
                    
                      ℓ
                      
                        N
                        ,
                        n
                      
                    
                  
                
              
              )
            
          
          
            
              T
            
          
        
        .
      
    
    {\displaystyle {\begin{pmatrix}0&\dotsm &0&1&-\ell _{n+1,n}&\dotsm &-\ell _{N,n}\end{pmatrix}}^{\textsf {T}}.}
   In other words, the lower triangular matrix

  
    
      
        
          L
          
            n
          
          
            −
            1
          
        
        =
        
          
            (
            
              
                
                  1
                
                
                
                
                
                
              
              
                
                
                  ⋱
                
                
                
                
                
              
              
                
                
                
                  1
                
                
                
                
              
              
                
                
                
                  −
                  
                    ℓ
                    
                      n
                      +
                      1
                      ,
                      n
                    
                  
                
                
                
                
              
              
                
                
                
                  ⋮
                
                
                
                  ⋱
                
                
              
              
                
                
                
                  −
                  
                    ℓ
                    
                      N
                      ,
                      n
                    
                  
                
                
                
                
                  1
                
              
            
            )
          
        
        .
      
    
    {\displaystyle L_{n}^{-1}={\begin{pmatrix}1&&&&&\\&\ddots &&&&\\&&1&&&\\&&-\ell _{n+1,n}&&&\\&&\vdots &&\ddots &\\&&-\ell _{N,n}&&&1\end{pmatrix}}.}
  Performing all the row operations for the first 
  
    
      
        N
        −
        1
      
    
    {\displaystyle N-1}
   columns using the 
  
    
      
        
          A
          
            (
            n
            )
          
        
        :=
        
          L
          
            n
          
          
            −
            1
          
        
        
          A
          
            (
            n
            −
            1
            )
          
        
      
    
    {\displaystyle A^{(n)}:=L_{n}^{-1}A^{(n-1)}}
   formula is equivalent to finding the decomposition

Denote 
  
    
      
        L
        =
        
          L
          
            1
          
        
        ⋯
        
          L
          
            N
            −
            1
          
        
      
    
    {\textstyle L=L_{1}\dotsm L_{N-1}}
   so that 
  
    
      
        A
        =
        L
        
          A
          
            (
            N
            −
            1
            )
          
        
        =
        L
        U
      
    
    {\displaystyle A=LA^{(N-1)}=LU}
  .
Now let's compute the sequence of 
  
    
      
        
          L
          
            1
          
        
        ⋯
        
          L
          
            N
            −
            1
          
        
      
    
    {\displaystyle L_{1}\dotsm L_{N-1}}
  . We know that 
  
    
      
        
          L
          
            i
          
        
      
    
    {\displaystyle L_{i}}
   has the following formula.

  
    
      
        
          L
          
            n
          
        
        =
        
          
            (
            
              
                
                  1
                
                
                
                
                
                
              
              
                
                
                  ⋱
                
                
                
                
                
              
              
                
                
                
                  1
                
                
                
                
              
              
                
                
                
                  
                    ℓ
                    
                      n
                      +
                      1
                      ,
                      n
                    
                  
                
                
                
                
              
              
                
                
                
                  ⋮
                
                
                
                  ⋱
                
                
              
              
                
                
                
                  
                    ℓ
                    
                      N
                      ,
                      n
                    
                  
                
                
                
                
                  1
                
              
            
            )
          
        
      
    
    {\displaystyle L_{n}={\begin{pmatrix}1&&&&&\\&\ddots &&&&\\&&1&&&\\&&\ell _{n+1,n}&&&\\&&\vdots &&\ddots &\\&&\ell _{N,n}&&&1\end{pmatrix}}}
  If there are two lower triangular matrices with 1s in the main diagonal, and neither have a non-zero item below the main diagonal in the same column as the other, then we can include all non-zero items at their same location in the product of the two matrices. For example:

  
    
      
        
          (
          
            
              
                
                  1
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  77
                
                
                  1
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  12
                
                
                  0
                
                
                  1
                
                
                  0
                
                
                  0
                
              
              
                
                  63
                
                
                  0
                
                
                  0
                
                
                  1
                
                
                  0
                
              
              
                
                  7
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  1
                
              
            
          
          )
        
        
          (
          
            
              
                
                  1
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  1
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  22
                
                
                  1
                
                
                  0
                
                
                  0
                
              
              
                
                  0
                
                
                  33
                
                
                  0
                
                
                  1
                
                
                  0
                
              
              
                
                  0
                
                
                  44
                
                
                  0
                
                
                  0
                
                
                  1
                
              
            
          
          )
        
        =
        
          (
          
            
              
                
                  1
                
                
                  0
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  77
                
                
                  1
                
                
                  0
                
                
                  0
                
                
                  0
                
              
              
                
                  12
                
                
                  22
                
                
                  1
                
                
                  0
                
                
                  0
                
              
              
                
                  63
                
                
                  33
                
                
                  0
                
                
                  1
                
                
                  0
                
              
              
                
                  7
                
                
                  44
                
                
                  0
                
                
                  0
                
                
                  1
                
              
            
          
          )
        
      
    
    {\displaystyle \left({\begin{array}{ccccc}1&0&0&0&0\\77&1&0&0&0\\12&0&1&0&0\\63&0&0&1&0\\7&0&0&0&1\end{array}}\right)\left({\begin{array}{ccccc}1&0&0&0&0\\0&1&0&0&0\\0&22&1&0&0\\0&33&0&1&0\\0&44&0&0&1\end{array}}\right)=\left({\begin{array}{ccccc}1&0&0&0&0\\77&1&0&0&0\\12&22&1&0&0\\63&33&0&1&0\\7&44&0&0&1\end{array}}\right)}
  
Finally, multiply 
  
    
      
        
          L
          
            i
          
        
      
    
    {\displaystyle L_{i}}
   together and generate the fused matrix denoted as 
  
    
      
        L
      
    
    {\textstyle L}
   (as previously mentioned). Using the matrix 
  
    
      
        L
      
    
    {\textstyle L}
  , we obtain 
  
    
      
        A
        =
        L
        U
        .
      
    
    {\displaystyle A=LU.}
  
It is clear that in order for this algorithm to work, one needs to have 
  
    
      
        
          a
          
            n
            ,
            n
          
          
            (
            n
            −
            1
            )
          
        
        ≠
        0
      
    
    {\displaystyle a_{n,n}^{(n-1)}\neq 0}
   at each step (see the definition of 
  
    
      
        
          ℓ
          
            i
            ,
            n
          
        
      
    
    {\displaystyle \ell _{i,n}}
  ). If this assumption fails at some point, one needs to interchange n-th row with another row below it before continuing. This is why an LU decomposition in general looks like 
  
    
      
        
          P
          
            −
            1
          
        
        A
        =
        L
        U
      
    
    {\displaystyle P^{-1}A=LU}
  .

LU Crout decomposition
Note that the decomposition obtained through this procedure is a Doolittle decomposition: the main diagonal of L is composed solely of 1s. If one would proceed by removing elements above the main diagonal by adding multiples of the columns (instead of removing elements below the diagonal by adding multiples of the rows), we would obtain a Crout decomposition, where the main diagonal of U is of 1s.
Another (equivalent) way of producing a Crout decomposition of a given matrix A is to obtain a Doolittle decomposition of the transpose of A. Indeed, if 
  
    
      
        
          A
          
            
              T
            
          
        
        =
        
          L
          
            0
          
        
        
          U
          
            0
          
        
      
    
    {\textstyle A^{\textsf {T}}=L_{0}U_{0}}
   is the LU-decomposition obtained through the algorithm presented in this section, then by taking 
  
    
      
        L
        =
        
          U
          
            0
          
          
            
              T
            
          
        
      
    
    {\textstyle L=U_{0}^{\textsf {T}}}
   and 
  
    
      
        U
        =
        
          L
          
            0
          
          
            
              T
            
          
        
      
    
    {\textstyle U=L_{0}^{\textsf {T}}}
  , we have that 
  
    
      
        A
        =
        L
        U
      
    
    {\displaystyle A=LU}
   is a Crout decomposition.

Through recursion
Cormen et al. describe a recursive algorithm for LUP decomposition.
Given a matrix A, let P1 be a permutation matrix such that

  
    
      
        
          P
          
            1
          
        
        A
        =
        
          (
          
            
              
                
                  a
                
                
                
                  
                    w
                    
                      
                        T
                      
                    
                  
                
                
              
              
                
                
                
                
              
              
                
                  v
                
                
                
                  
                    A
                    ′
                  
                
                
              
              
                
                
                
                
              
            
          
          )
        
      
    
    {\displaystyle P_{1}A=\left({\begin{array}{c|ccc}a&&w^{\textsf {T}}&\\\hline &&&\\v&&A'&\\&&&\end{array}}\right)}
  ,where 
  
    
      
        a
        ≠
        0
      
    
    {\textstyle a\neq 0}
  , if there is a nonzero entry in the first column of A; or take P1 as the identity matrix otherwise. Now let 
  
    
      
        c
        =
        1
        
          /
        
        a
      
    
    {\textstyle c=1/a}
  , if 
  
    
      
        a
        ≠
        0
      
    
    {\textstyle a\neq 0}
  ; or 
  
    
      
        c
        =
        0
      
    
    {\textstyle c=0}
   otherwise. We have

  
    
      
        
          P
          
            1
          
        
        A
        =
        
          (
          
            
              
                
                  1
                
                
                
                  0
                
                
              
              
                
                
                
                
              
              
                
                  c
                  v
                
                
                
                  
                    I
                    
                      n
                      −
                      1
                    
                  
                
                
              
              
                
                
                
                
              
            
          
          )
        
        
          (
          
            
              
                
                  a
                
                
                  
                    w
                    
                      
                        T
                      
                    
                  
                
              
              
                
                
              
              
                
                  0
                
                
                  
                    A
                    ′
                  
                  −
                  c
                  v
                  
                    w
                    
                      
                        T
                      
                    
                  
                
              
              
                
                
              
            
          
          )
        
        .
      
    
    {\displaystyle P_{1}A=\left({\begin{array}{c|ccc}1&&0&\\\hline &&&\\cv&&I_{n-1}&\\&&&\end{array}}\right)\left({\begin{array}{c|c}a&w^{\textsf {T}}\\\hline &\\0&A'-cvw^{\textsf {T}}\\&\end{array}}\right).}
  Now we can recursively find an LUP decomposition 
  
    
      
        
          P
          ′
        
        
          (
          
            
              A
              ′
            
            −
            c
            v
            
              w
              
                
                  T
                
              
            
          
          )
        
        =
        
          L
          ′
        
        
          U
          ′
        
      
    
    {\textstyle P'\left(A'-cvw^{\textsf {T}}\right)=L'U'}
  . Let 
  
    
      
        
          v
          ′
        
        =
        
          P
          ′
        
        v
      
    
    {\textstyle v'=P'v}
  . Therefore

  
    
      
        
          (
          
            
              
                
                  1
                
                
                
                  0
                
                
              
              
                
                
                
                
              
              
                
                  0
                
                
                
                  
                    P
                    ′
                  
                
                
              
              
                
                
                
                
              
            
          
          )
        
        
          P
          
            1
          
        
        A
        =
        
          (
          
            
              
                
                  1
                
                
                
                  0
                
                
              
              
                
                
                
                
              
              
                
                  c
                  
                    v
                    ′
                  
                
                
                
                  
                    L
                    ′
                  
                
                
              
              
                
                
                
                
              
            
          
          )
        
        
          (
          
            
              
                
                  a
                
                
                
                  
                    w
                    
                      
                        T
                      
                    
                  
                
                
              
              
                
                
                
                
              
              
                
                  0
                
                
                
                  
                    U
                    ′
                  
                
                
              
              
                
                
                
                
              
            
          
          )
        
        ,
      
    
    {\displaystyle \left({\begin{array}{c|ccc}1&&0&\\\hline &&&\\0&&P'&\\&&&\end{array}}\right)P_{1}A=\left({\begin{array}{c|ccc}1&&0&\\\hline &&&\\cv'&&L'&\\&&&\end{array}}\right)\left({\begin{array}{c|ccc}a&&w^{\textsf {T}}&\\\hline &&&\\0&&U'&\\&&&\end{array}}\right),}
  which is an LUP decomposition of A.

Randomized algorithm
It is possible to find a low rank approximation to an LU decomposition using a randomized algorithm. Given an input matrix 
  
    
      
        A
      
    
    {\textstyle A}
   and a desired low rank 
  
    
      
        k
      
    
    {\textstyle k}
  , the randomized LU returns permutation matrices 
  
    
      
        P
        ,
        Q
      
    
    {\textstyle P,Q}
   and lower/upper trapezoidal matrices 
  
    
      
        L
        ,
        U
      
    
    {\textstyle L,U}
   of size 
  
    
      
        m
        ×
        k
      
    
    {\textstyle m\times k}
   and 
  
    
      
        k
        ×
        n
      
    
    {\textstyle k\times n}
   respectively, such that with high probability 
  
    
      
        
          
            ‖
            
              P
              A
              Q
              −
              L
              U
            
            ‖
          
          
            2
          
        
        ≤
        C
        
          σ
          
            k
            +
            1
          
        
      
    
    {\textstyle \left\|PAQ-LU\right\|_{2}\leq C\sigma _{k+1}}
  , where 
  
    
      
        C
      
    
    {\textstyle C}
   is a constant that depends on the parameters of the algorithm and 
  
    
      
        
          σ
          
            k
            +
            1
          
        
      
    
    {\textstyle \sigma _{k+1}}
   is the 
  
    
      
        (
        k
        +
        1
        )
      
    
    {\textstyle (k+1)}
  -th singular value of the input matrix 
  
    
      
        A
      
    
    {\textstyle A}
  .

Theoretical complexity
If two matrices of order n can be multiplied in time M(n), where M(n) ≥ na for some a > 2, then an LU decomposition can be computed in time O(M(n)). This means, for example, that an O(n2.376) algorithm exists based on the Coppersmith–Winograd algorithm.

Sparse-matrix decomposition
Special algorithms have been developed for factorizing large sparse matrices. These algorithms attempt to find sparse factors L and U. Ideally, the cost of computation is determined by the number of nonzero entries, rather than by the size of the matrix.
These algorithms use the freedom to exchange rows and columns to minimize fill-in (entries that change from an initial zero to a non-zero value during the execution of an algorithm).
General treatment of orderings that minimize fill-in can be addressed using graph theory.

Applications
Solving linear equations
Given a system of linear equations in matrix form

  
    
      
        A
        
          x
        
        =
        
          b
        
        ,
      
    
    {\displaystyle A\mathbf {x} =\mathbf {b} ,}
  we want to solve the equation for x, given A and b. Suppose we have already obtained the LUP decomposition of A such that 
  
    
      
        P
        A
        =
        L
        U
      
    
    {\textstyle PA=LU}
  , so 
  
    
      
        L
        U
        
          x
        
        =
        P
        
          b
        
      
    
    {\textstyle LU\mathbf {x} =P\mathbf {b} }
  .
In this case the solution is done in two logical steps:

First, we solve the equation 
  
    
      
        L
        
          y
        
        =
        P
        
          b
        
      
    
    {\textstyle L\mathbf {y} =P\mathbf {b} }
   for y.
Second, we solve the equation 
  
    
      
        U
        
          x
        
        =
        
          y
        
      
    
    {\textstyle U\mathbf {x} =\mathbf {y} }
   for x.In both cases we are dealing with triangular matrices (L and U), which can be solved directly by forward and backward substitution without using the Gaussian elimination process (however we do need this process or equivalent to compute the LU decomposition itself).
The above procedure can be repeatedly applied to solve the equation multiple times for different b. In this case it is faster (and more convenient) to do an LU decomposition of the matrix A once and then solve the triangular matrices for the different b, rather than using Gaussian elimination each time. The matrices L and U could be thought to have "encoded" the Gaussian elimination process.
The cost of solving a system of linear equations is approximately 
  
    
      
        
          
            2
            3
          
        
        
          n
          
            3
          
        
      
    
    {\textstyle {\frac {2}{3}}n^{3}}
   floating-point operations if the matrix 
  
    
      
        A
      
    
    {\textstyle A}
   has size 
  
    
      
        n
      
    
    {\textstyle n}
  . This makes it twice as fast as algorithms based on QR decomposition, which costs about 
  
    
      
        
          
            4
            3
          
        
        
          n
          
            3
          
        
      
    
    {\textstyle {\frac {4}{3}}n^{3}}
   floating-point operations when Householder reflections are used. For this reason, LU decomposition is usually preferred.

Inverting a matrix
When solving systems of equations, b is usually treated as a vector with a length equal to the height of matrix A. In matrix inversion however, instead of vector b, we have matrix B, where B is an n-by-p matrix, so that we are trying to find a matrix X (also a n-by-p matrix):

  
    
      
        A
        X
        =
        L
        U
        X
        =
        B
        .
      
    
    {\displaystyle AX=LUX=B.}
  We can use the same algorithm presented earlier to solve for each column of matrix X. Now suppose that B is the identity matrix of size n. It would follow that the result X must be the inverse of A.

Computing the determinant
Given the LUP decomposition 
  
    
      
        A
        =
        
          P
          
            −
            1
          
        
        L
        U
      
    
    {\textstyle A=P^{-1}LU}
   of a square matrix A, the determinant of A can be computed straightforwardly as

  
    
      
        det
        (
        A
        )
        =
        det
        
          (
          
            P
            
              −
              1
            
          
          )
        
        det
        (
        L
        )
        det
        (
        U
        )
        =
        (
        −
        1
        
          )
          
            S
          
        
        
          (
          
            
              ∏
              
                i
                =
                1
              
              
                n
              
            
            
              l
              
                i
                i
              
            
          
          )
        
        
          (
          
            
              ∏
              
                i
                =
                1
              
              
                n
              
            
            
              u
              
                i
                i
              
            
          
          )
        
        .
      
    
    {\displaystyle \det(A)=\det \left(P^{-1}\right)\det(L)\det(U)=(-1)^{S}\left(\prod _{i=1}^{n}l_{ii}\right)\left(\prod _{i=1}^{n}u_{ii}\right).}
  The second equation follows from the fact that the determinant of a triangular matrix is simply the product of its diagonal entries, and that the determinant of a permutation matrix is equal to (−1)S where S is the number of row exchanges in the decomposition.
In the case of LU decomposition with full pivoting, 
  
    
      
        det
        (
        A
        )
      
    
    {\textstyle \det(A)}
   also equals the right-hand side of the above equation, if we let S be the total number of row and column exchanges.
The same method readily applies to LU decomposition by setting P equal to the identity matrix.

Code examples
C code example
C# code example
MATLAB code example
See also
Block LU decomposition
Bruhat decomposition
Cholesky decomposition
Crout matrix decomposition
Incomplete LU factorization
LU Reduction
Matrix decomposition
QR decomposition

Notes
References
Bunch, James R.; Hopcroft, John (1974), "Triangular factorization and inversion by fast matrix multiplication", Mathematics of Computation, 28 (125): 231–236, doi:10.2307/2005828, ISSN 0025-5718, JSTOR 2005828.
Cormen, Thomas H.; Leiserson, Charles E.; Rivest, Ronald L.; Stein, Clifford (2001), Introduction to Algorithms, MIT Press and McGraw-Hill, ISBN 978-0-262-03293-3.
Golub, Gene H.; Van Loan, Charles F. (1996), Matrix Computations (3rd ed.), Baltimore: Johns Hopkins, ISBN 978-0-8018-5414-9.
Horn, Roger A.; Johnson, Charles R. (1985), Matrix Analysis, Cambridge University Press, ISBN 978-0-521-38632-6. See Section 3.5. N − 1
Householder, Alston S. (1975), The Theory of Matrices in Numerical Analysis, New York: Dover Publications, MR 0378371.
Okunev, Pavel; Johnson, Charles R. (1997), Necessary And Sufficient Conditions For Existence of the LU Factorization of an Arbitrary Matrix, arXiv:math.NA/0506382.
Poole, David (2006), Linear Algebra: A Modern Introduction (2nd ed.), Canada: Thomson Brooks/Cole, ISBN 978-0-534-99845-5.
Press, WH; Teukolsky, SA; Vetterling, WT; Flannery, BP (2007), "Section 2.3", Numerical Recipes: The Art of Scientific Computing (3rd ed.), New York: Cambridge University Press, ISBN 978-0-521-88068-8.
Trefethen, Lloyd N.; Bau, David (1997), Numerical linear algebra, Philadelphia: Society for Industrial and Applied Mathematics, ISBN 978-0-89871-361-9.
Rigotti, Luca (2001), ECON 2001 - Introduction to Mathematical Methods, Lecture 8

External links
References

LU decomposition on MathWorld.
LU decomposition on Math-Linux.
LU decomposition at Holistic Numerical Methods Institute
LU matrix factorization. MATLAB reference.Computer code

LAPACK is a collection of FORTRAN subroutines for solving dense linear algebra problems
ALGLIB includes a partial port of the LAPACK to C++, C#, Delphi, etc.
C++ code, Prof. J. Loomis, University of Dayton
C code, Mathematics Source Library
Rust code
LU in X10Online resources

WebApp descriptively solving systems of linear equations with LU Decomposition
Matrix Calculator with steps, including LU decomposition,
LU Decomposition Tool, uni-bonn.de
LU Decomposition by Ed Pegg, Jr., The Wolfram Demonstrations Project, 2007.